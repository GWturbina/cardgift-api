<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title id="pageTitle">CardGift - Admin Dashboard</title>
   
   <!-- PWA Meta tags -->
   <meta name="description" content="CardGift Admin Dashboard - Manage your network">
   <meta name="theme-color" content="#FFD700">
   
   <!-- Favicon fix -->
   <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÅ</text></svg>">
   
   <!-- ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: Web3 Integration - SafePal Priority (—É–±—Ä–∞–ª –±–∏—Ç—ã–π —Å–∫—Ä–∏–ø—Ç) -->
   <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
   
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: 'Arial', sans-serif;
           background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
           color: #FFFFFF;
           overflow-x: hidden;
           min-height: 100vh;
       }

       /* –ó–æ–ª–æ—Ç—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ */
       body::before {
           content: '';
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                       radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
           pointer-events: none;
           z-index: -1;
       }

       /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
       .language-switcher {
           position: fixed;
           top: 15px;
           right: 15px;
           z-index: 1000;
           display: flex;
           background: rgba(0, 0, 0, 0.9);
           border-radius: 15px;
           padding: 4px;
           backdrop-filter: blur(10px);
           border: 1px solid rgba(255, 215, 0, 0.3);
       }

       .lang-btn {
           background: transparent;
           border: none;
           color: #FFD700;
           padding: 6px 12px;
           border-radius: 10px;
           cursor: pointer;
           font-size: 12px;
           font-weight: bold;
           transition: all 0.3s ease;
           min-width: 35px;
       }

       .lang-btn.active {
           background: rgba(255, 215, 0, 0.3);
           color: #FFF;
       }

       /* SIDEBAR */
       .sidebar {
           position: fixed;
           left: 0;
           top: 0;
           width: 280px;
           height: 100vh;
           background: rgba(0, 0, 0, 0.95);
           backdrop-filter: blur(20px);
           border-right: 2px solid #FFD700;
           z-index: 100;
           overflow-y: auto;
           transition: transform 0.3s ease;
       }

       .sidebar.mobile-hidden {
           transform: translateX(-100%);
       }

       .sidebar-header {
           padding: 25px 20px;
           text-align: center;
           border-bottom: 1px solid rgba(255, 215, 0, 0.3);
       }

       .logo {
           font-size: 28px;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           font-weight: bold;
           margin-bottom: 8px;
       }

       .user-info {
           background: rgba(255, 215, 0, 0.1);
           border-radius: 10px;
           padding: 15px;
           margin-top: 15px;
       }

       .user-level {
           background: #FFD700;
           color: #000;
           padding: 4px 10px;
           border-radius: 15px;
           font-size: 11px;
           font-weight: bold;
           display: inline-block;
           margin-bottom: 8px;
       }

       .user-id {
           color: #CCC;
           font-size: 12px;
       }

       /* NOTIFICATION BADGE */
       .notification-badge {
           position: absolute;
           top: -8px;
           right: -8px;
           background: #FF4444;
           color: white;
           border-radius: 50%;
           width: 20px;
           height: 20px;
           font-size: 10px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           animation: pulse 2s infinite;
       }

       .notification-badge.read {
           background: #4CAF50;
           animation: none;
       }

       .notification-badge.hidden {
           display: none;
       }

       @keyframes pulse {
           0% { transform: scale(1); }
           50% { transform: scale(1.1); }
           100% { transform: scale(1); }
       }

       /* MENU */
       .sidebar-menu {
           padding: 20px 0;
       }

       .menu-item {
           display: flex;
           align-items: center;
           padding: 15px 25px;
           color: #CCC;
           text-decoration: none;
           transition: all 0.3s ease;
           border-left: 3px solid transparent;
           cursor: pointer;
           position: relative;
       }

       .menu-item:hover {
           background: rgba(255, 215, 0, 0.1);
           color: #FFF;
       }

       .menu-item.active {
           background: rgba(255, 215, 0, 0.2);
           border-left-color: #FFD700;
           color: #FFD700;
       }

       .menu-item.locked {
           opacity: 0.4;
           cursor: not-allowed;
           position: relative;
       }

       .menu-item.locked::after {
           content: "üîí";
           position: absolute;
           right: 25px;
           font-size: 16px;
       }

       .menu-icon {
           width: 24px;
           margin-right: 15px;
           text-align: center;
           font-size: 18px;
       }

       /* MAIN CONTENT */
       .main-content {
           margin-left: 280px;
           padding: 30px;
           min-height: 100vh;
           transition: margin-left 0.3s ease;
       }

       .main-content.full-width {
           margin-left: 0;
       }

       /* MOBILE TOGGLE */
       .mobile-toggle {
           display: none;
           position: fixed;
           top: 15px;
           left: 15px;
           z-index: 1001;
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 10px;
           padding: 10px;
           cursor: pointer;
           color: #FFD700;
       }

       /* SECTION */
       .content-section {
           display: none;
           animation: fadeInUp 0.5s ease;
       }

       .content-section.active {
           display: block;
       }

       .section-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 30px;
           flex-wrap: wrap;
       }

       .section-title {
           font-size: 28px;
           color: #FFD700;
           font-weight: bold;
       }

       /* STATS CARDS */
       .stats-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin-bottom: 30px;
       }

       .stat-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 15px;
           padding: 20px;
           text-align: center;
           transition: transform 0.3s ease;
       }

       .stat-card:hover {
           transform: translateY(-5px);
       }

       .stat-icon {
           font-size: 32px;
           margin-bottom: 10px;
       }

       .stat-number {
           font-size: 24px;
           font-weight: bold;
           color: #FFD700;
           margin-bottom: 5px;
       }

       .stat-label {
           color: #CCC;
           font-size: 14px;
       }

       /* CONTACT CATEGORIES */
       .contact-categories {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 15px;
           margin-bottom: 30px;
       }
	   
	   /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ –º–µ–Ω—é */
       select {
           background: rgba(255, 255, 255, 0.1) !important;
           border: 1px solid #FFD700 !important;
           border-radius: 8px !important;
           padding: 8px 12px !important;
           color: #FFF !important;
           font-family: 'Arial', sans-serif !important;
       }
       
       select option {
           background: rgba(0, 0, 0, 0.95) !important;
           color: #FFF !important;
           padding: 8px !important;
           border: none !important;
       }
       
       select:focus {
           outline: none !important;
           border-color: #FFA500 !important;
           box-shadow: 0 0 10px rgba(255, 215, 0, 0.3) !important;
       }
       
       #categoryFilter {
           background: rgba(0, 0, 0, 0.9) !important;
           border: 1px solid #FFD700 !important;
           color: #FFD700 !important;
           min-width: 150px !important;
       }

       .category-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           text-align: center;
           transition: all 0.3s ease;
           cursor: pointer;
       }

       .category-card:hover {
           border-color: #FFD700;
           background: rgba(255, 215, 0, 0.05);
       }

       .category-icon {
           font-size: 24px;
           margin-bottom: 8px;
       }

       .category-name {
           font-weight: bold;
           margin-bottom: 5px;
       }

       .category-count {
           color: #FFD700;
           font-size: 18px;
           font-weight: bold;
       }

       /* REFERRAL SYSTEM */
       .referral-section {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï LEVEL BUTTONS - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .level-buttons {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: none; /* Firefox */
           -ms-overflow-style: none; /* IE/Edge */
           padding: 5px;
           justify-content: flex-start;
       }

       .level-buttons::-webkit-scrollbar {
           display: none; /* Chrome/Safari */
       }

       .level-btn {
           background: rgba(255, 215, 0, 0.1);
           border: 2px solid #FFD700;
           color: #FFD700;
           border-radius: 50%;
           width: 50px;
           height: 50px;
           min-width: 50px; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
           flex-shrink: 0; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
       }

       .level-btn:hover {
           background: rgba(255, 215, 0, 0.2);
           transform: scale(1.1);
       }

       .level-btn.active {
           background: #FFD700;
           color: #000;
       }

       .level-btn.locked {
           opacity: 0.3;
           cursor: not-allowed;
       }

       .level-btn.locked::after {
           content: "üîí";
           position: absolute;
           top: -5px;
           right: -5px;
           font-size: 12px;
       }

       /* LEVEL CONTENT */
       .level-content {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 10px;
           padding: 20px;
           margin-top: 20px;
           display: none;
       }

       .level-content.active {
           display: block;
       }

       .level-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 15px;
           flex-wrap: wrap;
       }

       .level-title {
           color: #FFD700;
           font-weight: bold;
           font-size: 18px;
       }

       .level-count {
           background: rgba(255, 215, 0, 0.2);
           color: #FFD700;
           padding: 4px 12px;
           border-radius: 15px;
           font-size: 12px;
           font-weight: bold;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø TEAM TABLE - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .team-table {
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: none; /* Firefox */
           -ms-overflow-style: none; /* IE/Edge */
           border-radius: 10px;
           border: 1px solid rgba(255, 215, 0, 0.2);
       }

       .team-table::-webkit-scrollbar {
           display: none; /* Chrome/Safari */
       }

       .team-table table {
           width: 100%;
           border-collapse: collapse;
           min-width: 600px; /* ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
       }

       .team-table th {
           background: rgba(255, 215, 0, 0.1);
           color: #FFD700;
           padding: 12px 8px;
           text-align: left;
           border-bottom: 2px solid #FFD700;
           font-size: 14px;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
       }

       .team-table td {
           padding: 10px 8px;
           border-bottom: 1px solid rgba(255, 215, 0, 0.2);
           color: #FFF;
           font-size: 13px;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
       }

       .team-table tr:hover {
           background: rgba(255, 215, 0, 0.05);
       }

       .user-id-cell {
           color: #4CAF50;
           font-weight: bold;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .user-id-cell:hover {
           color: #FFD700;
       }

       .wallet-status {
           padding: 2px 6px;
           border-radius: 10px;
           font-size: 10px;
           font-weight: bold;
       }

       .wallet-active {
           background: rgba(76, 175, 80, 0.3);
           color: #4CAF50;
       }

       .wallet-inactive {
           background: rgba(128, 128, 128, 0.3);
           color: #888;
       }

       .status-badge {
           padding: 3px 8px;
           border-radius: 12px;
           font-size: 10px;
           font-weight: bold;
       }

       .status-coauthor {
           background: rgba(139, 69, 19, 0.3);
           color: #D2691E;
       }

       .status-super {
           background: rgba(255, 215, 0, 0.3);
           color: #FFD700;
       }

       .status-mini {
           background: rgba(255, 193, 7, 0.3);
           color: #FFC107;
       }

       .status-basic {
           background: rgba(128, 128, 128, 0.3);
           color: #CCC;
       }

       /* CRM MODAL */
       .crm-modal {
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.9);
           z-index: 2000;
           display: none;
           align-items: center;
           justify-content: center;
           padding: 20px;
       }

       .crm-modal.show {
           display: flex;
       }

       .crm-modal-content {
           background: rgba(0, 0, 0, 0.95);
           border: 2px solid #FFD700;
           border-radius: 15px;
           padding: 30px;
           max-width: 600px;
           width: 100%;
           max-height: 80vh;
           overflow-y: auto;
       }

       .crm-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 20px;
       }

       .crm-title {
           color: #FFD700;
           font-size: 20px;
           font-weight: bold;
       }

       .close-btn {
           background: none;
           border: none;
           color: #CCC;
           font-size: 24px;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .close-btn:hover {
           color: #FFD700;
       }

       .crm-tabs {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           overflow-x: auto; /* ‚úÖ –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª –¥–ª—è —Ç–∞–±–æ–≤ */
           scrollbar-width: none;
           -ms-overflow-style: none;
       }

       .crm-tabs::-webkit-scrollbar {
           display: none;
       }

       .crm-tab {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           padding: 8px 16px;
           border-radius: 8px;
           cursor: pointer;
           transition: all 0.3s ease;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
           flex-shrink: 0; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
       }

       .crm-tab.active {
           background: #FFD700;
           color: #000;
       }

       .crm-content {
           display: none;
       }

       .crm-content.active {
           display: block;
       }

       .notes-textarea {
           width: 100%;
           min-height: 150px;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 15px;
           color: #FFF;
           resize: vertical;
       }

       .notes-textarea:focus {
           outline: none;
           border-color: #FFA500;
       }

       .save-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
           border: none;
           border-radius: 8px;
           padding: 10px 20px;
           cursor: pointer;
           margin-top: 10px;
           transition: all 0.3s ease;
       }

       .save-btn:hover {
           transform: translateY(-2px);
       }

       /* CHAT SECTION */
       .chat-container {
           border: 1px solid #FFD700;
           border-radius: 8px;
           height: 300px;
           display: flex;
           flex-direction: column;
       }

       .chat-messages {
           flex: 1;
           padding: 15px;
           overflow-y: auto;
           background: rgba(255, 255, 255, 0.05);
       }

       .chat-input-area {
           padding: 10px;
           border-top: 1px solid #FFD700;
           display: flex;
           gap: 10px;
       }

       .chat-input {
           flex: 1;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 8px 12px;
           color: #FFF;
       }

       .send-btn {
           background: #FFD700;
           color: #000;
           border: none;
           border-radius: 8px;
           padding: 8px 16px;
           cursor: pointer;
           font-weight: bold;
       }

       /* CO-AUTHORS MANAGEMENT */
       .coauthors-section {
           background: rgba(139, 69, 19, 0.1);
           border: 2px solid #D2691E;
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       .add-coauthor-btn {
           background: linear-gradient(45deg, #D2691E, #A0522D);
           color: white;
           border: none;
           border-radius: 10px;
           padding: 12px 25px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
       }

       .add-coauthor-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 4px 8px rgba(210, 105, 30, 0.3);
       }

       .coauthor-item {
           display: flex;
           justify-content: space-between;
           align-items: center;
           padding: 15px;
           background: rgba(139, 69, 19, 0.1);
           border-radius: 10px;
           margin-bottom: 10px;
       }

       .coauthor-info {
           color: #D2691E;
           font-weight: bold;
       }

       .coauthor-actions {
           display: flex;
           gap: 10px;
       }

       .action-btn {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           border-radius: 5px;
           padding: 5px 10px;
           cursor: pointer;
           transition: all 0.3s ease;
       }

       .action-btn:hover {
           background: rgba(255, 215, 0, 0.2);
       }

       .action-btn.danger {
           border-color: #FF4444;
           color: #FF4444;
       }

       .action-btn.danger:hover {
           background: rgba(255, 68, 68, 0.2);
       }

       /* DEVELOPMENT PLACEHOLDER */
       .development-placeholder {
           background: rgba(255, 165, 0, 0.1);
           border: 2px dashed #FFA500;
           border-radius: 15px;
           padding: 50px;
           text-align: center;
           margin: 30px 0;
       }

       .development-icon {
           font-size: 64px;
           margin-bottom: 20px;
       }

       .development-title {
           color: #FFA500;
           font-size: 24px;
           font-weight: bold;
           margin-bottom: 15px;
       }

       .development-text {
           color: #CCC;
           line-height: 1.6;
       }

       /* ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
       @media (max-width: 768px) {
           .sidebar {
               transform: translateX(-100%);
           }

           .sidebar.mobile-visible {
               transform: translateX(0);
           }

           .main-content {
               margin-left: 0;
               padding: 20px;
               padding-top: 70px;
           }

           .mobile-toggle {
               display: block;
           }

           .stats-grid {
               grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
               gap: 15px;
           }

           .contact-categories {
               grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
           }

           .section-header {
               flex-direction: column;
               align-items: flex-start;
               gap: 15px;
           }

           .language-switcher {
               top: 75px;
               right: 10px;
           }

           /* ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è level-buttons */
           .level-buttons {
               gap: 8px;
               padding: 10px 5px;
               justify-content: flex-start;
           }

           .level-btn {
               width: 45px;
               height: 45px;
               min-width: 45px;
               font-size: 14px;
           }

           .crm-modal-content {
               padding: 20px;
               margin: 10px;
           }

           /* ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü */
           .team-table {
               font-size: 12px;
           }

           .team-table th,
           .team-table td {
               padding: 8px 4px;
               font-size: 11px;
           }

           /* ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ç–∞–±—ã CRM */
           .crm-tabs {
               gap: 5px;
           }

           .crm-tab {
               padding: 6px 12px;
               font-size: 12px;
           }
       }

       /* ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
       @media (max-width: 480px) {
           .level-btn {
               width: 40px;
               height: 40px;
               min-width: 40px;
               font-size: 12px;
           }

           .level-buttons {
               gap: 5px;
           }

           .team-table table {
               min-width: 500px; /* –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
           }
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateY(30px);
           }
           to {
               opacity: 1;
               transform: translateY(0);
           }
       }
   </style>
</head>
<body>
   <!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
   <div class="language-switcher">
       <button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
       <button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
       <button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
   </div>

   <!-- MOBILE TOGGLE -->
   <div class="mobile-toggle" onclick="toggleSidebar()">
       <span style="font-size: 20px;">‚ò∞</span>
   </div>

   <!-- SIDEBAR -->
   <div class="sidebar" id="sidebar">
       <div class="sidebar-header">
           <div class="logo">üéÅ CardGift</div>
           <div class="user-info">
               <div class="user-level" id="userLevel">NOT CONNECTED</div>
               <div class="user-id" id="userIdDisplay">ID: <span id="currentUserId">Connect Wallet</span></div>
           </div>
       </div>
       
       <nav class="sidebar-menu">
           <div class="menu-item active" onclick="showSection('dashboard')" data-section="dashboard">
               <div class="menu-icon">üìä</div>
               <span id="menuDashboard">Dashboard</span>
           </div>
           <div class="menu-item locked" onclick="showSection('contacts')" data-section="contacts">
               <div class="menu-icon">üë•</div>
               <span id="menuContacts">Contacts</span>
           </div>
           <div class="menu-item locked" onclick="showSection('referrals')" data-section="referrals">
               <div class="menu-icon">üîó</div>
               <span id="menuReferrals">Referral System</span>
               <div class="notification-badge hidden" id="referralNotifications">0</div>
           </div>
           <div class="menu-item locked" onclick="showSection('crm')" data-section="crm">
               <div class="menu-icon">üí¨</div>
               <span id="menuCRM">CRM & Chat</span>
               <div class="notification-badge hidden" id="crmNotifications">0</div>
           </div>
           <div class="menu-item locked" onclick="showSection('coauthors')" data-section="coauthors" id="coauthorsMenuItem">
               <div class="menu-icon">üëë</div>
               <span id="menuCoauthors">Co-Authors</span>
           </div>
           <div class="menu-item locked" onclick="showSection('mailings')" data-section="mailings">
               <div class="menu-icon">üì¢</div>
               <span id="menuMailings">Mass Mailings</span>
           </div>
           <div class="menu-item locked" onclick="showSection('analytics')" data-section="analytics">
               <div class="menu-icon">üìà</div>
               <span id="menuAnalytics">Advanced Analytics</span>
           </div>
           <div class="menu-item" onclick="showSection('wallet')" data-section="wallet">
               <div class="menu-icon">üíé</div>
               <span id="menuWallet">Web3 Wallet</span>
           </div>
          <div class="menu-item locked" onclick="showSection('settings')" data-section="settings">
              <div class="menu-icon">‚öôÔ∏è</div>
              <span id="menuSettings">Settings</span>
          </div>
      </nav>
  </div>

  <!-- CRM MODAL -->
  <div class="crm-modal" id="crmModal">
      <div class="crm-modal-content">
          <div class="crm-header">
              <div class="crm-title" id="crmModalTitle">User CRM</div>
              <button class="close-btn" onclick="closeCRMModal()">√ó</button>
          </div>
          
          <div class="crm-tabs">
              <button class="crm-tab active" onclick="switchCRMTab('notes')" id="notesTab">üìù Notes</button>
              <button class="crm-tab" onclick="switchCRMTab('chat')" id="chatTab">üí¨ Chat</button>
              <button class="crm-tab" onclick="switchCRMTab('social')" id="socialTab">üì± Social</button>
          </div>
          
          <div class="crm-content active" id="notesContent">
              <textarea class="notes-textarea" id="userNotes" placeholder="Write your notes about this user..."></textarea>
              <button class="save-btn" onclick="saveUserNotes()">üíæ Save Notes</button>
          </div>
          
          <div class="crm-content" id="chatContent">
              <div class="chat-container">
                  <div class="chat-messages" id="chatMessages">
                      <div style="text-align: center; color: #CCC; padding: 20px;">
                          No messages yet. Start a conversation!
                      </div>
                  </div>
                  <div class="chat-input-area">
                      <input type="text" class="chat-input" id="chatInput" placeholder="Type your message...">
                      <button class="send-btn" onclick="sendMessage()">Send</button>
                  </div>
              </div>
          </div>
          
          <div class="crm-content" id="socialContent">
              <div style="color: #CCC; line-height: 1.6;">
                  <h4 style="color: #FFD700; margin-bottom: 10px;">Contact Information:</h4>
                  <div id="userSocialInfo">
                      <p><strong>Platform:</strong> <span id="userPlatform">-</span></p>
                      <p><strong>Contact:</strong> <span id="userContact">-</span></p>
                      <p><strong>Registration Date:</strong> <span id="userRegDate">-</span></p>
                  </div>
                  <button style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin-top: 15px;" onclick="openSocialContact()">
                      üì± Open in Social Media
                  </button>
              </div>
          </div>
      </div>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main-content" id="mainContent">
      
      <!-- DASHBOARD SECTION -->
     <div id="dashboard" class="content-section active">
         <div class="section-header">
             <h1 class="section-title" id="dashboardTitle">üìä Web3 Dashboard</h1>
             <div style="color: #CCC; font-size: 14px;" id="lastUpdate">Last update: <span id="updateTime">--:--</span></div>
         </div>

         <!-- CONNECTION STATUS -->
         <div class="referral-section" style="margin-bottom: 30px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üîê Connection Status</h3>
             <div id="connectionStatus" style="text-align: center; padding: 20px;">
                 <div style="color: #FF4444; font-size: 18px; margin-bottom: 10px;">‚ö†Ô∏è Wallet Not Connected</div>
                 <div style="color: #CCC;">Connect your SafePal wallet to access all features</div>
                 <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 15px 30px; cursor: pointer; margin-top: 15px; font-weight: bold;" onclick="showSection('wallet')">
                     üîê Connect Wallet
                 </button>
             </div>
         </div>

         <!-- MAIN STATS -->
         <div class="stats-grid">
             <div class="stat-card">
                 <div class="stat-icon">üë•</div>
                 <div class="stat-number" id="totalContacts">0</div>
                 <div class="stat-label" id="totalContactsLabel">Total Contacts</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üîó</div>
                 <div class="stat-number" id="totalReferrals">0</div>
                 <div class="stat-label" id="totalReferralsLabel">Active Referrals</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üíé</div>
                 <div class="stat-number" id="totalEarnings">0.000</div>
                 <div class="stat-label" id="totalEarningsLabel">Earnings (opBNB)</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üéÅ</div>
                 <div class="stat-number" id="totalCards">0</div>
                 <div class="stat-label" id="totalCardsLabel">Cards Generated</div>
             </div>
         </div>

         <!-- CONTACT CATEGORIES -->
         <h3 style="color: #FFD700; margin-bottom: 20px;" id="contactCategoriesTitle">üì± Contact Categories</h3>
         <div class="contact-categories">
             <div class="category-card" onclick="filterContacts('telegram')">
                 <div class="category-icon">üì±</div>
                 <div class="category-name">Telegram</div>
                 <div class="category-count" id="telegramCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('whatsapp')">
                 <div class="category-icon">üí¨</div>
                 <div class="category-name">WhatsApp</div>
                 <div class="category-count" id="whatsappCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('email')">
                 <div class="category-icon">üìß</div>
                 <div class="category-name">Email</div>
                 <div class="category-count" id="emailCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('instagram')">
                 <div class="category-icon">üì∑</div>
                 <div class="category-name">Instagram</div>
                 <div class="category-count" id="instagramCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('viber')">
                 <div class="category-icon">üíú</div>
                 <div class="category-name">Viber</div>
                 <div class="category-count" id="viberCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('facebook')">
                 <div class="category-icon">üë§</div>
                 <div class="category-name">Facebook</div>
                 <div class="category-count" id="facebookCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('tiktok')">
                 <div class="category-icon">üéµ</div>
                 <div class="category-name">TikTok</div>
                 <div class="category-count" id="tiktokCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('twitter')">
                 <div class="category-icon">üê¶</div>
                 <div class="category-name">Twitter/X</div>
                 <div class="category-count" id="twitterCount">0</div>
             </div>
         </div>

         <!-- RECENT ACTIVITY -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;" id="recentActivityTitle">üìà Recent Activity</h3>
             <div id="recentActivityList">
                 <div style="text-align: center; color: #CCC; padding: 20px;" id="noActivityText">
                     Connect your wallet to see activity
                 </div>
             </div>
         </div>
     </div>

     <!-- CONTACTS SECTION -->
     <div id="contacts" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="contactsTitle">üë• Contact Management</h1>
             <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="exportContacts()">
                 üì• <span id="exportBtn">Export All</span>
             </button>
         </div>

         <!-- ‚úÖ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê –§–£–ù–ö–¶–ò–Ø –ü–û–ò–°–ö–ê –ü–û –ö–ê–¢–ï–ì–û–†–ò–Ø–ú -->
         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px; margin-bottom: 20px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üîç Search Contacts</h3>
             <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                 <select id="categoryFilter" style="background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 8px; padding: 8px 12px; color: #FFF;">
                     <option value="all">All Categories</option>
                     <option value="telegram">Telegram</option>
                     <option value="whatsapp">WhatsApp</option>
                     <option value="email">Email</option>
                     <option value="instagram">Instagram</option>
                     <option value="viber">Viber</option>
                     <option value="facebook">Facebook</option>
                     <option value="tiktok">TikTok</option>
                     <option value="twitter">Twitter/X</option>
                 </select>
                 <input type="text" id="searchInput" placeholder="Search by name or contact..." style="background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 8px; padding: 8px 12px; color: #FFF; flex: 1; min-width: 200px;">
                 <button onclick="searchContacts()" style="background: #FFD700; color: #000; border: none; border-radius: 8px; padding: 8px 16px; cursor: pointer; font-weight: bold;">Search</button>
                 <button onclick="clearSearch()" style="background: rgba(255, 68, 68, 0.2); color: #FF4444; border: 1px solid #FF4444; border-radius: 8px; padding: 8px 16px; cursor: pointer;">Clear</button>
             </div>
         </div>

         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px;">
             <div id="contactsTable">
                 <div style="text-align: center; color: #CCC; padding: 40px;" id="noContactsText">
                     Connect wallet to manage contacts
                 </div>
             </div>
         </div>
     </div>

     <!-- ‚úÖ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê –ü–û–õ–ù–ê–Ø REFERRALS SECTION –° –ú–ê–†–ö–ï–¢–ò–ù–ì–û–ú -->
     <div id="referrals" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="referralsTitle">üîó Referral Network & Marketing</h1>
             <div style="color: #CCC;" id="networkStatus">Network Status: Disconnected</div>
         </div>

         <!-- ‚úÖ –ú–ê–†–ö–ï–¢–ò–ù–ì–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üìä Marketing Dashboard</h3>
             
             <!-- –£—Ä–æ–≤–Ω–∏ –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã -->
             <div class="level-buttons">
                 <button class="level-btn active" onclick="showLevel(1)" data-level="1">1</button>
                 <button class="level-btn" onclick="showLevel(2)" data-level="2">2</button>
                 <button class="level-btn" onclick="showLevel(3)" data-level="3">3</button>
                 <button class="level-btn" onclick="showLevel(4)" data-level="4">4</button>
                 <button class="level-btn" onclick="showLevel(5)" data-level="5">5</button>
                 <button class="level-btn locked" onclick="showLevel(6)" data-level="6">6</button>
                 <button class="level-btn locked" onclick="showLevel(7)" data-level="7">7</button>
                 <button class="level-btn locked" onclick="showLevel(8)" data-level="8">8</button>
                 <button class="level-btn locked" onclick="showLevel(9)" data-level="9">9</button>
             </div>

             <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —É—Ä–æ–≤–Ω–µ–π -->
             <div class="level-content active" id="level1Content">
                 <div class="level-header">
                     <div class="level-title">Level 1 - Direct Referrals</div>
                     <div class="level-count" id="level1Count">0 users</div>
                 </div>
                 <div class="team-table">
                     <table>
                         <thead>
                             <tr>
                                 <th>User ID</th>
                                 <th>Name</th>
                                 <th>Platform</th>
                                 <th>Status</th>
                                 <th>Wallet</th>
                                 <th>Joined</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="level1Table">
                             <tr>
                                 <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                     No referrals yet
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

             <div class="level-content" id="level2Content">
                 <div class="level-header">
                     <div class="level-title">Level 2 - Second Generation</div>
                     <div class="level-count" id="level2Count">0 users</div>
                 </div>
                 <div class="team-table">
                     <table>
                         <thead>
                             <tr>
                                 <th>User ID</th>
                                 <th>Name</th>
                                 <th>Platform</th>
                                 <th>Status</th>
                                 <th>Wallet</th>
                                 <th>Joined</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="level2Table">
                             <tr>
                                 <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                     No level 2 referrals yet
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

             <div class="level-content" id="level3Content">
                 <div class="level-header">
                     <div class="level-title">Level 3 - Third Generation</div>
                     <div class="level-count" id="level3Count">0 users</div>
                 </div>
                 <div class="team-table">
                     <table>
                         <thead>
                             <tr>
                                 <th>User ID</th>
                                 <th>Name</th>
                                 <th>Platform</th>
                                 <th>Status</th>
                                 <th>Wallet</th>
                                 <th>Joined</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="level3Table">
                             <tr>
                                 <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                     No level 3 referrals yet
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

             <div class="level-content" id="level4Content">
                 <div class="level-header">
                     <div class="level-title">Level 4 - Fourth Generation</div>
                     <div class="level-count" id="level4Count">0 users</div>
                 </div>
                 <div class="team-table">
                     <table>
                         <thead>
                             <tr>
                                 <th>User ID</th>
                                 <th>Name</th>
                                 <th>Platform</th>
                                 <th>Status</th>
                                 <th>Wallet</th>
                                 <th>Joined</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="level4Table">
                             <tr>
                                 <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                     No level 4 referrals yet
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

             <div class="level-content" id="level5Content">
                 <div class="level-header">
                     <div class="level-title">Level 5 - Fifth Generation</div>
                     <div class="level-count" id="level5Count">0 users</div>
                 </div>
                 <div class="team-table">
                     <table>
                         <thead>
                             <tr>
                                 <th>User ID</th>
                                 <th>Name</th>
                                 <th>Platform</th>
                                 <th>Status</th>
                                 <th>Wallet</th>
                                 <th>Joined</th>
                                 <th>Actions</th>
                             </tr>
                         </thead>
                         <tbody id="level5Table">
                             <tr>
                                 <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                                     Unlock with Mini Admin activation
                                 </td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
             </div>

             <!-- –£—Ä–æ–≤–Ω–∏ 6-9 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã -->
             <div class="level-content" id="level6Content">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     üîí Level 6-9 available for Super Admin users
                 </div>
             </div>
             <div class="level-content" id="level7Content">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     üîí Level 6-9 available for Super Admin users
                 </div>
             </div>
             <div class="level-content" id="level8Content">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     üîí Level 6-9 available for Super Admin users
                 </div>
             </div>
             <div class="level-content" id="level9Content">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     üîí Level 6-9 available for Super Admin users
                 </div>
             </div>
         </div>

         <!-- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üîó Your Referral Link</h3>
             <div style="display: flex; gap: 10px; align-items: center;">
                 <input type="text" id="referralLink" value="registration.html?ref=YOUR_ID" readonly style="background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 8px; padding: 10px; color: #FFF; flex: 1;">
                 <button onclick="copyReferralLink()" style="background: #FFD700; color: #000; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-weight: bold;">üìã Copy</button>
                 <button onclick="shareReferralLink()" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; font-weight: bold;">üì§ Share</button>
             </div>
         </div>

         <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—Ä–∞–±–æ—Ç–∫–∞ -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üí∞ Earnings Statistics</h3>
             <div class="stats-grid">
                 <div class="stat-card">
                     <div class="stat-icon">üíé</div>
                     <div class="stat-number" id="totalEarningsRef">0.000</div>
                     <div class="stat-label">Total Earnings (BNB)</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">üìà</div>
                     <div class="stat-number" id="monthlyEarnings">0.000</div>
                     <div class="stat-label">This Month</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">üë•</div>
                     <div class="stat-number" id="activeReferrals">0</div>
                     <div class="stat-label">Active Referrals</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">‚ö°</div>
                     <div class="stat-number" id="conversionRate">0%</div>
                     <div class="stat-label">Conversion Rate</div>
                 </div>
             </div>
         </div>
     </div>

     <!-- ‚úÖ –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ê CRM SECTION -->
     <div id="crm" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="crmTitle">üí¨ CRM & Internal Chat</h1>
             <button style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="refreshCRMData()">
                 üîÑ Refresh Data
             </button>
         </div>

         <!-- CRM Dashboard -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üìä CRM Overview</h3>
             <div class="stats-grid">
                 <div class="stat-card">
                     <div class="stat-icon">üë•</div>
                     <div class="stat-number" id="totalCRMContacts">0</div>
                     <div class="stat-label">Total CRM Contacts</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">üí¨</div>
                     <div class="stat-number" id="unreadMessages">0</div>
                     <div class="stat-label">Unread Messages</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">üìù</div>
                     <div class="stat-number" id="totalNotes">0</div>
                     <div class="stat-label">Saved Notes</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-icon">üìû</div>
                     <div class="stat-number" id="activeChats">0</div>
                     <div class="stat-label">Active Chats</div>
                 </div>
             </div>
         </div>

         <!-- Recent Conversations -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üí¨ Recent Conversations</h3>
             <div id="recentConversations">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     No recent conversations
                 </div>
             </div>
         </div>

         <!-- Quick Actions -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;">‚ö° Quick Actions</h3>
             <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                 <button onclick="createNewChat()" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                     üí¨ New Chat
                 </button>
                 <button onclick="exportCRMData()" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                     üì• Export Data
                 </button>
                 <button onclick="sendBroadcast()" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                     üì¢ Broadcast
                 </button>
                 <button onclick="generateReport()" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-weight: bold;">
                     üìä Generate Report
                 </button>
             </div>
         </div>
     </div>

     <!-- CO-AUTHORS SECTION -->
     <div id="coauthors" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="coauthorsTitle">üëë Co-Authors Management</h1>
         </div>

         <div class="coauthors-section">
             <h3 style="color: #D2691E; margin-bottom: 15px;">üëë Current Co-Authors</h3>
             <button class="add-coauthor-btn" onclick="addNewCoauthor()">
                 ‚ûï Add New Co-Author
             </button>
             
             <div id="coauthorsList" style="margin-top: 20px;">
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     No co-authors assigned yet
                 </div>
             </div>
         </div>
     </div>

     <!-- MAILINGS SECTION -->
     <div id="mailings" class="content-section">
         <div class="development-placeholder">
             <div class="development-icon">üöß</div>
             <div class="development-title" id="mailingsDevTitle">Mass Mailings System</div>
             <div class="development-text" id="mailingsDevText">
                 Advanced mailing system is currently in development.<br>
                 This section will include:<br><br>
                 ‚Ä¢ Multi-platform messaging (Telegram, WhatsApp, Email)<br>
                 ‚Ä¢ Template management<br>
                 ‚Ä¢ Scheduling and automation<br>
                 ‚Ä¢ Delivery analytics<br>
                 ‚Ä¢ Anti-spam protection
             </div>
         </div>
     </div>

     <!-- ANALYTICS SECTION -->
     <div id="analytics" class="content-section">
         <div class="development-placeholder">
             <div class="development-icon">üìä</div>
             <div class="development-title" id="analyticsDevTitle">Advanced Analytics</div>
             <div class="development-text" id="analyticsDevText">
                 Comprehensive analytics dashboard is in development.<br>
                 Features coming soon:<br><br>
                 ‚Ä¢ Real-time statistics<br>
                 ‚Ä¢ Contact growth charts<br>
                 ‚Ä¢ Conversion tracking<br>
                 ‚Ä¢ Revenue analytics<br>
                 ‚Ä¢ Performance reports
             </div>
         </div>
     </div>

     <!-- WALLET SECTION -->
     <div id="wallet" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="walletTitle">üíé Web3 Wallet</h1>
             <div style="color: #CCC;" id="walletNetwork">Network: opBNB Mainnet</div>
         </div>

         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 30px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;" id="walletConnectionTitle">üîó Blockchain Connection</h3>
             
             <button id="connectWalletBtn" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 12px; padding: 15px 30px; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s ease; margin-bottom: 15px;" onclick="connectWallet()">
                 <span id="connectWalletText">üîê Connect SafePal Wallet</span>
             </button>
             
             <div id="walletStatus" style="background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50; border-radius: 10px; padding: 15px; text-align: center; display: none;">
                 <div style="font-weight: bold; margin-bottom: 10px;" id="walletConnectedText">‚úÖ SafePal Connected</div>
                 <div id="walletAddress" style="color: #4CAF50; margin-bottom: 5px;"></div>
                 <div id="walletBalance" style="color: #CCC; font-size: 14px;"></div>
             </div>

             <!-- SMART CONTRACT INFO -->
             <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px; margin-top: 20px;">
                 <h4 style="color: #FFD700; margin-bottom: 10px;" id="contractInfoTitle">üìÑ Smart Contract Info</h4>
                 <div style="color: #CCC; font-size: 14px;">
                     <div><strong id="contractStatusLabel">Status:</strong> <span style="color: #4CAF50;" id="contractStatus">Active</span></div>
                     <div><strong id="contractNetworkLabel">Network:</strong> opBNB Mainnet</div>
                     <div><strong id="contractAddressLabel">Address:</strong> <span style="word-break: break-all;" id="contractAddress">0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618</span></div>
                 </div>
             </div>
         </div>
     </div>
 </div>

      <!-- SETTINGS SECTION -->
      <div id="settings" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="settingsTitle">‚öôÔ∏è Settings</h1>
          </div>

          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="languageSettingsTitle">üåç Language Settings</h3>
              <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                  <button class="lang-btn active" onclick="switchLanguage('en')" style="padding: 10px 20px; border-radius: 8px;">
                      üá∫üá∏ English
                  </button>
                  <button class="lang-btn" onclick="switchLanguage('ru')" style="padding: 10px 20px; border-radius: 8px;">
                      üá∑üá∫ –†—É—Å—Å–∫–∏–π
                  </button>
                  <button class="lang-btn" onclick="switchLanguage('ua')" style="padding: 10px 20px; border-radius: 8px;">
                      üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
                  </button>
              </div>
          </div>
      </div>
  </div>

  <script>
      // ==================== WEB3 CONFIGURATION ====================
      const CONTRACT_CONFIG = {
          address: '0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618',
          network: 'opBNB',
          chainId: 204,
          rpcUrl: 'https://opbnb-mainnet-rpc.bnbchain.org',
          abi: [
    {
        "inputs": [{"name": "user", "type": "address"}],
        "name": "getUserLevel",
        "outputs": [{"name": "", "type": "uint256"}],
        "stateMutability": "view",
        "type": "function"
    },
    {
        "inputs": [{"name": "user", "type": "address"}],
        "name": "getUserReferrals", 
        "outputs": [{"name": "", "type": "address[]"}],
        "stateMutability": "view",
        "type": "function"
    },
    {
        "inputs": [{"name": "user", "type": "address"}],
        "name": "isUserActive",
        "outputs": [{"name": "", "type": "bool"}],
        "stateMutability": "view", 
        "type": "function"
    },
    {
        "inputs": [{"name": "user", "type": "address"}],
        "name": "getTotalEarnings",
        "outputs": [{"name": "", "type": "uint256"}],
        "stateMutability": "view",
        "type": "function"
    },
    {
        "inputs": [],
        "name": "activateUser",
        "outputs": [],
        "stateMutability": "payable",
        "type": "function"
    },
    {
        "inputs": [],
        "name": "activateMiniAdmin",
        "outputs": [],
        "stateMutability": "payable",
        "type": "function"
    },
    {
        "inputs": [],
        "name": "activateSuperAdmin",
        "outputs": [],
        "stateMutability": "payable",
        "type": "function"
    },
    {
        "inputs": [{"name": "referrerId", "type": "string"}],
        "name": "registerUser",
        "outputs": [{"name": "", "type": "string"}],
        "stateMutability": "nonpayable",
        "type": "function"
    }
]
      };

      const SUPPORTED_WALLETS = {
          safepal: {
              name: 'SafePal',
              icon: 'üîê',
              priority: 1,
              detected: () => window.safepal || window.ethereum?.isSafePal
          },
          metamask: {
              name: 'MetaMask', 
              icon: 'ü¶ä',
              priority: 2,
              detected: () => window.ethereum?.isMetaMask
          },
          trustwallet: {
              name: 'Trust Wallet',
              icon: 'üíô', 
              priority: 3,
              detected: () => window.ethereum?.isTrust
          },
          generic: {
              name: 'Web3 Wallet',
              icon: 'üí∞',
              priority: 4,
              detected: () => window.ethereum
          }
      };

      // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
      let currentLanguage = 'en';
      let currentSection = 'dashboard';
      let web3;
      let contract;
      let userWalletAddress = null;
      let isWeb3Connected = false;
      let connectedWallet = null;
      let currentUser = {
          userId: 'NOT_CONNECTED',
          level: 0,
          isActive: false,
          walletAddress: null
      };
      let walletConnected = false;
      let contactsData = {};
      let referralData = {};
      let currentLevel = 1;
      let currentCRMUser = null;
      let notifications = {
          referral: 0,
          crm: 0
      };

      // ==================== WEB3 INTEGRATION ====================
      async function initWeb3() {
          const availableWallets = Object.entries(SUPPORTED_WALLETS)
              .filter(([key, wallet]) => wallet.detected())
              .sort((a, b) => a[1].priority - b[1].priority);
          
          if (availableWallets.length === 0) {
              console.warn('No Web3 wallets detected');
              showInstallWalletPrompt();
              return;
          }
          
          const [walletKey, walletInfo] = availableWallets[0];
          connectedWallet = walletKey;
          
          try {
              let provider = window.safepal?.ethereum || window.ethereum;
              
              web3 = new Web3(provider);
              contract = new web3.eth.Contract(CONTRACT_CONFIG.abi, CONTRACT_CONFIG.address);
              
              const savedAddress = localStorage.getItem('connectedWallet');
              const savedWalletType = localStorage.getItem('connectedWalletType');
              
              if (savedAddress && savedWalletType === walletKey) {
                  userWalletAddress = savedAddress;
                  isWeb3Connected = true;
                  await checkNetwork();
                  await checkUserAccess();
              }
              
              console.log(`üîê Using ${walletInfo.name} provider`);
              
          } catch (error) {
              console.error('Web3 initialization failed:', error);
          }
      }

      async function checkNetwork() {
          try {
              const chainId = await web3.eth.getChainId();
              if (Number(chainId) !== CONTRACT_CONFIG.chainId) {
                  await switchToCorrectNetwork();
              }
          } catch (error) {
              console.error('Network check failed:', error);
          }
      }

      async function switchToCorrectNetwork() {
          try {
              await window.ethereum.request({
                  method: 'wallet_switchEthereumChain',
                  params: [{ chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId) }]
              });
          } catch (error) {
              if (error.code === 4902) {
                  await addNetwork();
              }
          }
      }

      async function addNetwork() {
          try {
              await window.ethereum.request({
                  method: 'wallet_addEthereumChain',
                  params: [{
                      chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId),
                      chainName: 'opBNB Mainnet',
                      nativeCurrency: {
                          name: 'BNB',
                          symbol: 'BNB',
                          decimals: 18
                      },
                      rpcUrls: [CONTRACT_CONFIG.rpcUrl],
                      blockExplorerUrls: ['https://opbnbscan.com/']
                  }]
              });
              
              showNotification('opBNB network added successfully!', 'success');
          } catch (error) {
              console.error('Failed to add network:', error);
              showNotification('Failed to add opBNB network', 'error');
          }
      }

      // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–π
      async function checkUserAccess() {
          if (!userWalletAddress) return;
          
          try {
              console.log('üîç Checking user access for:', userWalletAddress);
              
              // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –û–°–ù–û–í–ê–¢–ï–õ–ï–ô –ü–ï–†–í–´–ú –î–ï–õ–û–ú
              const founders = [
                  '0x0099188030174e381e7a7ee36d2783ecc31b6728', // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
                  '0xab17adbe29c4e1d695c239206682b02ebdb3f707',
                  '0xb5986b808dad481ad86d63df152cc0ad7b473e48',
                  '0xa3496cacc8523421dd151f1d92a456c2dafa28c2',
                  '0x8af1bc6b4a5aaced37889cc06bed4569a6b64044',
                  '0x0ab97e3934b1afc9f1f6447ccf676e4f1d8b9639',
                  '0x03284a899147f5a07f82c622f34df92198671635',
                  '0xb0e256ca055937a8fd9ca1f5e3d8a6bd44146d50'
              ];
              
              if (founders.includes(userWalletAddress.toLowerCase())) {
                  console.log('üî• –û–°–ù–û–í–ê–¢–ï–õ–¨ –û–ë–ù–ê–†–£–ñ–ï–ù - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø!');
                  currentUser = {
                      userId: `FOUNDER_${userWalletAddress.substring(2, 8).toUpperCase()}`,
                      level: 4,
                      isActive: true,
                      walletAddress: userWalletAddress
                  };
                  return;
              }
              
              // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ø—Ä–æ–±—É–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç
              try {
                  const userLevel = await contract.methods.getUserLevel(userWalletAddress).call();
                  const isActive = await contract.methods.isUserActive(userWalletAddress).call();
                  
                  currentUser = {
                      userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                      level: parseInt(userLevel),
                      isActive: isActive,
                      walletAddress: userWalletAddress
                  };
              } catch (contractError) {
                  console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:', contractError);
                  // Fallback - –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                  currentUser = {
                      userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                      level: 0,
                      isActive: false,
                      walletAddress: userWalletAddress
                  };
              }
              
              // –õ–û–ì–ò–ö–ê –ê–ö–¢–ò–í–ê–¶–ò–ò –ë–ï–ó –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò
              if (parseInt(currentUser.level) === 0 && !currentUser.isActive) {
                  showActivationOptions();
              }
              
              updateUserInterface();
              
          } catch (error) {
              console.error('Access check failed:', error);
              showActivationOptions();
          }
      }

      function showActivationOptions() {
          const connectionStatus = document.getElementById('connectionStatus');
          if (connectionStatus) {
              connectionStatus.innerHTML = `
                  <div style="color: #FFA500; font-size: 18px; margin-bottom: 15px;">‚ö° Choose Your Level</div>
                  
                  <!-- –ö–ù–û–ü–ö–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò -->
                  <button onclick="registerNewUser()" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold; margin-bottom: 15px; width: 100%;">
                      üìù Register Account
                  </button>
                  
                  <div style="color: #CCC; margin-bottom: 15px;">or activate directly:</div>
                  
                  <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                      <button onclick="activateUser(1)" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          üë§ Basic User<br><small>0.0025 BNB</small>
                      </button>
                      <button onclick="activateUser(2)" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          ‚ö° Mini Admin<br><small>0.05 BNB</small>
                      </button>
                      <button onclick="activateUser(3)" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          üöÄ Super Admin<br><small>0.25 BNB</small>
                      </button>
                  </div>
              `;
          }
      }

// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
async function activateUser(level) {
    try {
        showNotification('Preparing activation...', 'info');
        
        if (!contract || !userWalletAddress) {
            throw new Error('Wallet not connected');
        }
        
        let txResult;
        let price;
        
        switch(level) {
            case 1:
                // –ë–∞–∑–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è (0.0025 BNB)
                price = '2500000000000000'; // 0.0025 BNB –≤ wei
                txResult = await contract.methods.activateUser().send({ 
                    from: userWalletAddress,
                    value: price,
                    gas: 200000
                });
                break;
                
            case 2: 
                // –ú–∏–Ω–∏-–∞–¥–º–∏–Ω (0.05 BNB)
                price = '50000000000000000'; // 0.05 BNB –≤ wei
                txResult = await contract.methods.activateMiniAdmin().send({ 
                    from: userWalletAddress,
                    value: price,
                    gas: 250000
                });
                break;
                
            case 3:
                // –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω (0.25 BNB)
                price = '250000000000000000'; // 0.25 BNB –≤ wei
                txResult = await contract.methods.activateSuperAdmin().send({ 
                    from: userWalletAddress,
                    value: price,
                    gas: 300000
                });
                break;
                
            default:
                throw new Error('Unknown activation level');
        }
        
        showNotification(`Level ${level} activation successful!`, 'success');
        await checkUserAccess();
        
    } catch (error) {
        console.error('Activation failed:', error);
        showNotification(`Activation error: ${error.message}`, 'error');
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
async function registerNewUser(referrerId = '') {
    try {
        showNotification('Registering user...', 'info');
        
        if (!contract || !userWalletAddress) {
            throw new Error('Connect wallet to register');
        }
        
        const result = await contract.methods.registerUser(referrerId).send({ 
            from: userWalletAddress,
            gas: 300000
        });
        
        showNotification('Registration successful! You can now activate.', 'success');
        await checkUserAccess();
        
    } catch (error) {
        console.error('Registration failed:', error);
        showNotification(`Registration error: ${error.message}`, 'error');
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ registration.html
function processRegistrationData(userData) {
    try {
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 7-–∑–Ω–∞—á–Ω—ã–π ID
        const newUserId = generateUserId();
        
        // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–∫–∏
        const userObject = {
            userId: newUserId,
            name: userData.name,
            messenger: userData.messenger,
            contact: userData.contact,
            referralId: userData.referralId || '', // –ö—Ç–æ –ø—Ä–∏–≤–µ–ª
            walletAddress: userData.walletAddress || '',
            registrationDate: new Date().toISOString(),
            level: 0,
            isActive: false,
            status: 'registered'
        };
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–æ—Ü—Å–µ—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
        if (!contactsData[userData.messenger]) {
            contactsData[userData.messenger] = [];
        }
        contactsData[userData.messenger].push(userObject);
        localStorage.setItem('allContacts', JSON.stringify(contactsData));
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–∞—Ä—Ç–Ω–µ—Ä–∫—É
        if (userData.referralId) {
            if (!referralData.levels[1]) referralData.levels[1] = [];
            referralData.levels[1].push(userObject);
            referralData.users[newUserId] = userObject;
            localStorage.setItem('referralDatabase', JSON.stringify(referralData));
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–≤—è–∑—å ID - –∫–æ—à–µ–ª–µ–∫
        if (userData.walletAddress) {
            window.walletDatabase[newUserId] = userData.walletAddress;
            localStorage.setItem('walletDatabase', JSON.stringify(window.walletDatabase));
        }
        
        console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—ã:', newUserId);
        updateDashboardStats();
        
        return newUserId;
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
        return null;
    }
}

// ‚úÖ –ù–û–í–ê–Ø: –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è registration.html
window.addUserToDatabase = processRegistrationData;

      function updateUserInterface() {
          const levelNames = {
              0: 'NOT REGISTERED',
              1: 'BASIC USER', 
              2: 'MINI ADMIN',
              3: 'SUPER ADMIN',
              4: 'FOUNDER'
          };
          
          document.getElementById('userLevel').textContent = levelNames[currentUser.level] || 'UNKNOWN';
          document.getElementById('currentUserId').textContent = currentUser.userId || 'Not Connected';
          
          if (userWalletAddress) {
              const shortAddress = `${userWalletAddress.substring(0, 6)}...${userWalletAddress.substring(userWalletAddress.length - 4)}`;
              document.getElementById('currentUserId').textContent = `${currentUser.userId} (${shortAddress})`;
              
              // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        const connectionStatus = document.getElementById('connectionStatus');
        if (connectionStatus && currentUser.level > 0) {
            connectionStatus.style.display = 'none';
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–∏
        document.getElementById('networkStatus').textContent = 'Network Status: Connected';
        
        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
        if (userWalletAddress && currentUser.userId !== 'NOT_CONNECTED') {
            const referralLinkInput = document.getElementById('referralLink');
            if (referralLinkInput) {
                referralLinkInput.value = `${window.location.origin}/registration.html?ref=${currentUser.userId}`;
            }
        }
    }
    
        updateMenuAccess();
    }

      function updateMenuAccess() {
          const menuItems = document.querySelectorAll('.menu-item');
          
          menuItems.forEach(item => {
              const section = item.getAttribute('data-section');
              
              if (currentUser.level === 0) {
                  if (section !== 'wallet' && section !== 'dashboard') {
                      item.classList.add('locked');
                  }
              } else if (currentUser.level >= 1) {
                  if (['dashboard', 'contacts', 'wallet'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
              
              if (currentUser.level >= 2) {
                  if (['referrals', 'crm'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
              
              if (currentUser.level >= 3) {
                  if (['mailings', 'analytics'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
              
              if (currentUser.level >= 4) {
                  item.classList.remove('locked');
              }
          });
      }

      function showInstallWalletPrompt() {
          const connectBtn = document.getElementById('connectWalletBtn');
          if (connectBtn) {
              connectBtn.innerHTML = 'üì± Install SafePal or Compatible Wallet';
              connectBtn.onclick = () => {
                  if (confirm('Install SafePal for best opBNB experience?\n\nClick OK for SafePal or Cancel for other wallets.')) {
                      window.open('https://safepal.io/download', '_blank');
                  } else {
                      window.open('https://metamask.io/download/', '_blank');
                  }
              };
          }
      }

      async function connectWallet() {
          if (!web3) {
              await initWeb3();
          }
          
          try {
              const connectBtn = document.getElementById('connectWalletBtn');
              const walletInfo = SUPPORTED_WALLETS[connectedWallet];
              
              connectBtn.textContent = `üîÑ Connecting to ${walletInfo.name}...`;
              connectBtn.disabled = true;
              
              let accounts = [];
              
              if (window.safepal && window.safepal.ethereum) {
                  try {
                      accounts = await window.safepal.ethereum.request({
                          method: 'eth_requestAccounts'
                      });
                      console.log('‚úÖ SafePal –ø–æ–¥–∫–ª—é—á–µ–Ω:', accounts);
                  } catch (safePalError) {
                      console.log('‚ö†Ô∏è SafePal API –æ—à–∏–±–∫–∞, –ø—Ä–æ–±—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥');
                      accounts = await window.ethereum.request({
                          method: 'eth_requestAccounts'
                      });
                  }
              } else if (window.ethereum) {
                  accounts = await window.ethereum.request({
                      method: 'eth_requestAccounts'
                  });
                  console.log('‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Web3 –ø–æ–¥–∫–ª—é—á–µ–Ω:', accounts);
              }
              
              if (accounts && accounts.length > 0) {
                  userWalletAddress = accounts[0];
                  localStorage.setItem('connectedWallet', userWalletAddress);
                  localStorage.setItem('connectedWalletType', connectedWallet);
                  isWeb3Connected = true;
                  
                  await checkNetwork();
                  await checkUserAccess();
                  
                  showWalletConnected(userWalletAddress);
                  showNotification(`${walletInfo.icon} ${walletInfo.name} connected successfully!`, 'success');
              }
          } catch (error) {
              console.error('Wallet connection failed:', error);
              showNotification('Wallet connection failed', 'error');
              
              const connectBtn = document.getElementById('connectWalletBtn');
              connectBtn.textContent = `üîê Connect ${SUPPORTED_WALLETS[connectedWallet].name}`;
              connectBtn.disabled = false;
          }
      }

      function showWalletConnected(address) {
          const connectBtn = document.getElementById('connectWalletBtn');
          const walletStatus = document.getElementById('walletStatus');
          const walletInfo = SUPPORTED_WALLETS[connectedWallet];
          
          if (connectBtn) connectBtn.style.display = 'none';
          if (walletStatus) walletStatus.style.display = 'block';
          
          document.getElementById('walletAddress').textContent = 
              `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
          
          const walletConnectedText = document.getElementById('walletConnectedText');
          if (walletConnectedText) {
              walletConnectedText.textContent = `‚úÖ ${walletInfo.icon} ${walletInfo.name} Connected`;
          }
          
          walletConnected = true;
      }

      // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
      window.onload = async function() {
          console.log('üöÄ CardGift Web3 Dashboard initializing...');
          
          await initWeb3();
          
          if (!referralData || !referralData.levels) {
              referralData = {
                  levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] }
              };
          }
          
          if (isWeb3Connected && userWalletAddress) {
              await checkUserAccess();
          } else {
              currentUser = {
                  userId: 'NOT_CONNECTED',
                  level: 0,
                  isActive: false,
                  walletAddress: null
              };
          }

          localStorage.setItem('currentUser', JSON.stringify(currentUser));
          
          updateUserInterface();
          loadDashboardData();
          updateTime();
          
          console.log('‚úÖ Web3 Dashboard initialized');
      };

      // ==================== –ù–ê–í–ò–ì–ê–¶–ò–Ø ====================
      function showSection(sectionId) {
          document.querySelectorAll('.content-section').forEach(section => {
              section.classList.remove('active');
          });
          
          document.getElementById(sectionId).classList.add('active');
          
          document.querySelectorAll('.menu-item').forEach(item => {
              item.classList.remove('active');
          });
          
          document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
          
          currentSection = sectionId;
          
          if (window.innerWidth <= 768) {
              toggleSidebar();
          }
      }

      function toggleSidebar() {
          const sidebar = document.getElementById('sidebar');
          const mainContent = document.getElementById('mainContent');
          
          sidebar.classList.toggle('mobile-visible');
          sidebar.classList.toggle('mobile-hidden');
          
          if (sidebar.classList.contains('mobile-visible')) {
              mainContent.classList.add('full-width');
          } else {
              mainContent.classList.remove('full-width');
          }
      }

      // ==================== –ú–ê–†–ö–ï–¢–ò–ù–ì–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================
      function showLevel(level) {
          // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —É—Ä–æ–≤–Ω–∏
          document.querySelectorAll('.level-content').forEach(content => {
              content.classList.remove('active');
          });
          
          // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –∫–Ω–æ–ø–æ–∫
          document.querySelectorAll('.level-btn').forEach(btn => {
              btn.classList.remove('active');
          });
          
          // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
          const levelContent = document.getElementById(`level${level}Content`);
          if (levelContent) {
              levelContent.classList.add('active');
          }
          
          // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
          const levelBtn = document.querySelector(`[data-level="${level}"]`);
          if (levelBtn) {
              levelBtn.classList.add('active');
          }
          
          currentLevel = level;
          
          // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω—è
          loadLevelData(level);
      }

      function loadLevelData(level) {
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è
          if (level > 5 && currentUser.level < 3) {
              // –£—Ä–æ–≤–Ω–∏ 6-9 —Ç–æ–ª—å–∫–æ –¥–ª—è Super Admin
              return;
          }
          
          if (level > 2 && currentUser.level < 2) {
              // –£—Ä–æ–≤–Ω–∏ 3-5 —Ç–æ–ª—å–∫–æ –¥–ª—è Mini Admin
              return;
          }
          
          // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –¥–ª—è —É—Ä–æ–≤–Ω—è
          const levelData = referralData.levels[level] || [];
          updateLevelTable(level, levelData);
      }

      function updateLevelTable(level, data) {
          const tableBody = document.getElementById(`level${level}Table`);
          const countElement = document.getElementById(`level${level}Count`);
          
          if (!tableBody || !countElement) return;
          
          countElement.textContent = `${data.length} users`;
          
          if (data.length === 0) {
              tableBody.innerHTML = `
                  <tr>
                      <td colspan="7" style="text-align: center; color: #CCC; padding: 20px;">
                          No level ${level} referrals yet
                      </td>
                  </tr>
              `;
              return;
          }
          
          let tableHTML = '';
          data.forEach(user => {
              tableHTML += `
                  <tr>
                      <td class="user-id-cell" onclick="openCRMModal('${user.userId}')">${user.userId}</td>
                      <td>${user.name || 'Unknown'}</td>
                      <td>${user.platform || 'Unknown'}</td>
                      <td><span class="status-badge status-${user.status || 'basic'}">${user.status || 'Basic'}</span></td>
                      <td><span class="wallet-status wallet-${user.walletConnected ? 'active' : 'inactive'}">${user.walletConnected ? 'Connected' : 'Not Connected'}</span></td>
                      <td>${user.joinDate || 'Unknown'}</td>
                      <td>
                          <button class="action-btn" onclick="viewUserDetails('${user.userId}')">View</button>
                          <button class="action-btn" onclick="openCRMModal('${user.userId}')">CRM</button>
                      </td>
                  </tr>
              `;
          });
          
          tableBody.innerHTML = tableHTML;
      }

      // ==================== –ö–û–ù–¢–ê–ö–¢–´ –§–£–ù–ö–¶–ò–ò ====================
      function filterContacts(category) {
          showSection('contacts');
          
          // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä
          const categoryFilter = document.getElementById('categoryFilter');
          if (categoryFilter) {
              categoryFilter.value = category;
          }
          
          searchContacts();
      }

      function searchContacts() {
          const category = document.getElementById('categoryFilter').value;
          const searchTerm = document.getElementById('searchInput').value.toLowerCase();
          
          let filteredContacts = [];
          
          if (category === 'all') {
              // –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
              Object.keys(contactsData).forEach(cat => {
                  const contacts = contactsData[cat] || [];
                  filteredContacts = filteredContacts.concat(
                      contacts.filter(contact => 
                          contact.name.toLowerCase().includes(searchTerm) ||
                          contact.contact.toLowerCase().includes(searchTerm)
                      )
                  );
              });
          } else {
              // –ü–æ–∏—Å–∫ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
              const contacts = contactsData[category] || [];
              filteredContacts = contacts.filter(contact => 
                  contact.name.toLowerCase().includes(searchTerm) ||
                  contact.contact.toLowerCase().includes(searchTerm)
              );
          }
          
          displayContactsTable(filteredContacts);
      }

      function clearSearch() {
          document.getElementById('categoryFilter').value = 'all';
          document.getElementById('searchInput').value = '';
          searchContacts();
      }

      function displayContactsTable(contacts) {
          const contactsTable = document.getElementById('contactsTable');
          
          if (contacts.length === 0) {
              contactsTable.innerHTML = `
                  <div style="text-align: center; color: #CCC; padding: 40px;">
                      No contacts found
                  </div>
              `;
              return;
          }
          
          let tableHTML = `
              <div class="team-table">
                  <table>
                      <thead>
                          <tr>
                              <th>Name</th>
                              <th>Platform</th>
                              <th>Contact</th>
                              <th>Registration Date</th>
                              <th>Status</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody>
          `;
          
          contacts.forEach(contact => {
              tableHTML += `
                  <tr>
                      <td>${contact.name}</td>
                      <td>${contact.platform}</td>
                      <td>${contact.contact}</td>
                      <td>${contact.registrationDate || 'Unknown'}</td>
                     <td><span class="status-badge status-${contact.status || 'basic'}">${contact.status || 'Basic'}</span></td>
                     <td>
                         <button class="action-btn" onclick="viewContactDetails('${contact.userId}')">View</button>
                         <button class="action-btn" onclick="openCRMModal('${contact.userId}')">CRM</button>
                         <button class="action-btn danger" onclick="deleteContact('${contact.userId}')">Delete</button>
                     </td>
                 </tr>
             `;
         });
         
         tableHTML += `
                     </tbody>
                 </table>
             </div>
         `;
         
         contactsTable.innerHTML = tableHTML;
     }

     function viewContactDetails(userId) {
         showNotification(`Viewing details for ${userId}`, 'info');
         // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞
     }

     function deleteContact(userId) {
         if (confirm('Are you sure you want to delete this contact?')) {
             // –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–∞–∫—Ç –∏–∑ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
             Object.keys(contactsData).forEach(category => {
                 contactsData[category] = contactsData[category].filter(contact => contact.userId !== userId);
             });
             
             // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
             localStorage.setItem('allContacts', JSON.stringify(contactsData));
             
             // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
             searchContacts();
             updateDashboardStats();
             
             showNotification('Contact deleted successfully', 'success');
         }
     }

     // ==================== CRM –§–£–ù–ö–¶–ò–ò ====================
     function openCRMModal(userId) {
         if (currentUser.level < 2) {
             showNotification('CRM access requires Mini Admin level or higher', 'error');
             return;
         }
         
         currentCRMUser = userId;
         document.getElementById('crmModal').classList.add('show');
         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
         loadCRMUserData(userId);
     }

     function loadCRMUserData(userId) {
         // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
         document.getElementById('crmModalTitle').textContent = `CRM - ${userId}`;
         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–º–µ—Ç–∫–∏
         const savedNotes = localStorage.getItem(`crm_notes_${userId}`) || '';
         document.getElementById('userNotes').value = savedNotes;
         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
         loadUserSocialInfo(userId);
         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
         loadUserChat(userId);
     }

     function loadUserSocialInfo(userId) {
         // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–∞–∫—Ç–∞—Ö
         let userInfo = null;
         
         Object.keys(contactsData).forEach(category => {
             const found = contactsData[category].find(contact => contact.userId === userId);
             if (found) {
                 userInfo = found;
             }
         });
         
         if (userInfo) {
             document.getElementById('userPlatform').textContent = userInfo.platform || 'Unknown';
             document.getElementById('userContact').textContent = userInfo.contact || 'Unknown';
             document.getElementById('userRegDate').textContent = userInfo.registrationDate || 'Unknown';
         } else {
             document.getElementById('userPlatform').textContent = 'Unknown';
             document.getElementById('userContact').textContent = 'Unknown';
             document.getElementById('userRegDate').textContent = 'Unknown';
         }
     }

     function loadUserChat(userId) {
         const chatMessages = document.getElementById('chatMessages');
         const savedMessages = localStorage.getItem(`crm_chat_${userId}`);
         
         if (savedMessages) {
             const messages = JSON.parse(savedMessages);
             let chatHTML = '';
             
             messages.forEach(message => {
                 chatHTML += `
                     <div style="margin-bottom: 10px; padding: 8px; background: rgba(255, 255, 255, 0.05); border-radius: 8px;">
                         <div style="font-size: 12px; color: #CCC;">${message.timestamp}</div>
                         <div style="color: #FFF;">${message.text}</div>
                     </div>
                 `;
             });
             
             chatMessages.innerHTML = chatHTML;
         } else {
             chatMessages.innerHTML = `
                 <div style="text-align: center; color: #CCC; padding: 20px;">
                     No messages yet. Start a conversation!
                 </div>
             `;
         }
     }

     function closeCRMModal() {
         document.getElementById('crmModal').classList.remove('show');
         currentCRMUser = null;
     }

     function switchCRMTab(tabName) {
         document.querySelectorAll('.crm-tab').forEach(tab => {
             tab.classList.remove('active');
         });
         document.getElementById(`${tabName}Tab`).classList.add('active');
         
         document.querySelectorAll('.crm-content').forEach(content => {
             content.classList.remove('active');
         });
         document.getElementById(`${tabName}Content`).classList.add('active');
     }

     function saveUserNotes() {
         if (!currentCRMUser) return;
         
         const notes = document.getElementById('userNotes').value;
         localStorage.setItem(`crm_notes_${currentCRMUser}`, notes);
         
         showNotification('Notes saved successfully!', 'success');
     }

     function sendMessage() {
         if (!currentCRMUser) return;
         
         const chatInput = document.getElementById('chatInput');
         const messageText = chatInput.value.trim();
         
         if (!messageText) return;
         
         // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
         const savedMessages = localStorage.getItem(`crm_chat_${currentCRMUser}`) || '[]';
         const messages = JSON.parse(savedMessages);
         
         messages.push({
             text: messageText,
             timestamp: new Date().toLocaleString(),
             sender: 'admin'
         });
         
         localStorage.setItem(`crm_chat_${currentCRMUser}`, JSON.stringify(messages));
         
         // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
         chatInput.value = '';
         
         // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
         loadUserChat(currentCRMUser);
         
         showNotification('Message sent!', 'success');
     }

     function openSocialContact() {
         if (!currentCRMUser) return;
         
         const platform = document.getElementById('userPlatform').textContent;
         const contact = document.getElementById('userContact').textContent;
         
         if (platform === 'Unknown' || contact === 'Unknown') {
             showNotification('No contact information available', 'error');
             return;
         }
         
         let url = '';
         
         switch(platform.toLowerCase()) {
             case 'telegram':
                 url = `https://t.me/${contact.replace('@', '')}`;
                 break;
             case 'whatsapp':
                 url = `https://wa.me/${contact.replace('+', '')}`;
                 break;
             case 'instagram':
                 url = `https://instagram.com/${contact.replace('@', '')}`;
                 break;
             case 'facebook':
                 url = `https://facebook.com/${contact}`;
                 break;
             case 'twitter':
                 url = `https://twitter.com/${contact.replace('@', '')}`;
                 break;
             case 'tiktok':
                 url = `https://tiktok.com/@${contact.replace('@', '')}`;
                 break;
             case 'email':
                 url = `mailto:${contact}`;
                 break;
             default:
                 showNotification('Platform not supported for direct contact', 'error');
                 return;
         }
         
         window.open(url, '_blank');
     }

     // ==================== CRM –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
     function refreshCRMData() {
         if (currentUser.level < 2) {
             showNotification('CRM access requires Mini Admin level or higher', 'error');
             return;
         }
         
         // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É CRM
         updateCRMStats();
         loadRecentConversations();
         
         showNotification('CRM data refreshed!', 'success');
     }

     function updateCRMStats() {
         // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
         let totalContacts = 0;
         Object.keys(contactsData).forEach(category => {
             totalContacts += contactsData[category].length;
         });
         
         document.getElementById('totalCRMContacts').textContent = totalContacts;
         
         // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
         let unreadMessages = 0;
         // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–¥—Å—á–µ—Ç–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
         document.getElementById('unreadMessages').textContent = unreadMessages;
         
         // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
         let totalNotes = 0;
         for (let i = 0; i < localStorage.length; i++) {
             const key = localStorage.key(i);
             if (key && key.startsWith('crm_notes_')) {
                 totalNotes++;
             }
         }
         document.getElementById('totalNotes').textContent = totalNotes;
         
         // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã
         let activeChats = 0;
         for (let i = 0; i < localStorage.length; i++) {
             const key = localStorage.key(i);
             if (key && key.startsWith('crm_chat_')) {
                 activeChats++;
             }
         }
         document.getElementById('activeChats').textContent = activeChats;
     }

     function loadRecentConversations() {
         const conversationsContainer = document.getElementById('recentConversations');
         let conversationsHTML = '';
         
         // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä—ã
         const conversations = [];
         for (let i = 0; i < localStorage.length; i++) {
             const key = localStorage.key(i);
             if (key && key.startsWith('crm_chat_')) {
                 const userId = key.replace('crm_chat_', '');
                 const messages = JSON.parse(localStorage.getItem(key) || '[]');
                 
                 if (messages.length > 0) {
                     const lastMessage = messages[messages.length - 1];
                     conversations.push({
                         userId: userId,
                         lastMessage: lastMessage.text,
                         timestamp: lastMessage.timestamp
                     });
                 }
             }
         }
         
         if (conversations.length === 0) {
             conversationsHTML = `
                 <div style="text-align: center; color: #CCC; padding: 40px;">
                     No recent conversations
                 </div>
             `;
         } else {
             conversations.forEach(conv => {
                 conversationsHTML += `
                     <div style="background: rgba(255, 255, 255, 0.05); border-radius: 10px; padding: 15px; margin-bottom: 10px; cursor: pointer;" onclick="openCRMModal('${conv.userId}')">
                         <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                             <strong style="color: #FFD700;">${conv.userId}</strong>
                             <span style="color: #CCC; font-size: 12px;">${conv.timestamp}</span>
                         </div>
                         <div style="color: #FFF; font-size: 14px;">${conv.lastMessage.substring(0, 100)}${conv.lastMessage.length > 100 ? '...' : ''}</div>
                     </div>
                 `;
             });
         }
         
         conversationsContainer.innerHTML = conversationsHTML;
     }

     function createNewChat() {
         const userId = prompt('Enter User ID to start a new chat:');
         if (userId) {
             openCRMModal(userId);
         }
     }

     function exportCRMData() {
         if (currentUser.level < 2) {
             showNotification('CRM access requires Mini Admin level or higher', 'error');
             return;
         }
         
         const crmData = {
             contacts: contactsData,
             notes: {},
             chats: {}
         };
         
         // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏
         for (let i = 0; i < localStorage.length; i++) {
             const key = localStorage.key(i);
             if (key && key.startsWith('crm_notes_')) {
                 const userId = key.replace('crm_notes_', '');
                 crmData.notes[userId] = localStorage.getItem(key);
             }
         }
         
         // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —á–∞—Ç—ã
         for (let i = 0; i < localStorage.length; i++) {
             const key = localStorage.key(i);
             if (key && key.startsWith('crm_chat_')) {
                 const userId = key.replace('crm_chat_', '');
                 crmData.chats[userId] = JSON.parse(localStorage.getItem(key) || '[]');
             }
         }
         
         const dataStr = JSON.stringify(crmData, null, 2);
         const dataBlob = new Blob([dataStr], {type: 'application/json'});
         const url = URL.createObjectURL(dataBlob);
         
         const link = document.createElement('a');
         link.href = url;
         link.download = `cardgift-crm-data-${new Date().toISOString().split('T')[0]}.json`;
         document.body.appendChild(link);
         link.click();
         document.body.removeChild(link);
         
         showNotification('CRM data exported successfully!', 'success');
     }

     function sendBroadcast() {
         showNotification('Broadcast feature will be available soon!', 'info');
     }

     function generateReport() {
         showNotification('Report generation feature will be available soon!', 'info');
     }

     // ==================== –†–ï–§–ï–†–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
     function copyReferralLink() {
    const referralLink = document.getElementById('referralLink');
    
    if (currentUser.userId !== 'NOT_CONNECTED') {
        // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ registration.html
        referralLink.value = `${window.location.origin}/registration.html?ref=${currentUser.userId}`;
    }
         
         navigator.clipboard.writeText(referralLink.value).then(() => {
             showNotification('Referral link copied to clipboard!', 'success');
         }).catch(() => {
             showNotification('Failed to copy referral link', 'error');
         });
     }

     function shareReferralLink() {
         const referralLink = document.getElementById('referralLink').value;
         
         if (navigator.share) {
             navigator.share({
                 title: 'Join CardGift!',
                 text: 'Create amazing greeting cards with CardGift Web3 platform!',
                 url: referralLink
             });
         } else {
             // Fallback –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–æ–≤ –±–µ–∑ Web Share API
             copyReferralLink();
             showNotification('Link copied! Share it manually.', 'info');
         }
     }

     // ==================== CO-AUTHORS –§–£–ù–ö–¶–ò–ò ====================
     function addNewCoauthor() {
         if (currentUser.level < 4) {
             showNotification('Only founders can manage co-authors', 'error');
             return;
         }
         
         const coauthorAddress = prompt('Enter co-author wallet address:');
         if (coauthorAddress && web3.utils.isAddress(coauthorAddress)) {
             // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–∞–≤—Ç–æ—Ä–∞
             showNotification(`Co-author ${coauthorAddress} will be added`, 'success');
         } else {
             showNotification('Invalid wallet address', 'error');
         }
     }

     // ==================== –Ø–ó–´–ö–û–í–´–ï –§–£–ù–ö–¶–ò–ò ====================
     function switchLanguage(lang) {
         currentLanguage = lang;
         localStorage.setItem('adminLanguage', lang);
         
         document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
         document.getElementById(`lang${lang.charAt(0).toUpperCase() + lang.slice(1)}`).classList.add('active');
         
         // –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–µ—Ä–µ–≤–æ–¥—ã
         applyTranslations(lang);
         
         showNotification(`Language changed to ${lang.toUpperCase()}`, 'success', 2000);
     }

     // ==================== –ú–£–õ–¨–¢–ò–Ø–ó–´–ß–ù–û–°–¢–¨ ====================
     const translations = {
         en: {
             // Dashboard
             dashboardTitle: "üìä Web3 Dashboard",
             lastUpdate: "Last update:",
             connectionStatus: "üîê Connection Status",
             walletNotConnected: "‚ö†Ô∏è Wallet Not Connected",
             connectWalletDesc: "Connect your SafePal wallet to access all features",
             connectWallet: "üîê Connect Wallet",
             
             // Menu
             menuDashboard: "Dashboard",
             menuContacts: "Contacts",
             menuReferrals: "Referral System",
             menuCRM: "CRM & Chat",
             menuCoauthors: "Co-Authors",
             menuMailings: "Mass Mailings",
             menuAnalytics: "Advanced Analytics",
             menuWallet: "Web3 Wallet",
             menuSettings: "Settings",
             
             // Stats
             totalContactsLabel: "Total Contacts",
             totalReferralsLabel: "Active Referrals",
             totalEarningsLabel: "Earnings (opBNB)",
             totalCardsLabel: "Cards Generated",
             
             // Categories
             contactCategoriesTitle: "üì± Contact Categories",
             recentActivityTitle: "üìà Recent Activity",
             noActivityText: "Connect your wallet to see activity",
             
             // Activation
             welcomeTitle: "‚ö° Welcome to CardGift",
             registerAccount: "üìù Register Account",
             activateDirectly: "Or activate directly:",
             basicUser: "üë§ Basic User",
             miniAdmin: "‚ö° Mini Admin",
             superAdmin: "üöÄ Super Admin",
             
             // Wallet
             walletTitle: "üíé Web3 Wallet",
             walletNetwork: "Network: opBNB Mainnet",
             blockchainConnection: "üîó Blockchain Connection",
             connectSafePal: "üîê Connect SafePal Wallet",
             safePalConnected: "‚úÖ SafePal Connected",
             contractInfo: "üìÑ Smart Contract Info",
             
             // Settings
             settingsTitle: "‚öôÔ∏è Settings",
             languageSettings: "üåç Language Settings"
         },
         
         ru: {
             // Dashboard
             dashboardTitle: "üìä Web3 –ü–∞–Ω–µ–ª—å",
             lastUpdate: "–û–±–Ω–æ–≤–ª–µ–Ω–æ:",
             connectionStatus: "üîê –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è",
             walletNotConnected: "‚ö†Ô∏è –ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω",
             connectWalletDesc: "–ü–æ–¥–∫–ª—é—á–∏—Ç–µ SafePal –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º",
             connectWallet: "üîê –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫",
             
             // Menu
             menuDashboard: "–ü–∞–Ω–µ–ª—å",
             menuContacts: "–ö–æ–Ω—Ç–∞–∫—Ç—ã",
             menuReferrals: "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞",
             menuCRM: "CRM –∏ –ß–∞—Ç",
             menuCoauthors: "–°–æ–∞–≤—Ç–æ—Ä—ã",
             menuMailings: "–ú–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏",
             menuAnalytics: "–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞",
             menuWallet: "Web3 –ö–æ—à–µ–ª–µ–∫",
             menuSettings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
             
             // Stats
             totalContactsLabel: "–í—Å–µ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",
             totalReferralsLabel: "–ê–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—ã",
             totalEarningsLabel: "–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ (opBNB)",
             totalCardsLabel: "–°–æ–∑–¥–∞–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ–∫",
             
             // Categories
             contactCategoriesTitle: "üì± –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤",
             recentActivityTitle: "üìà –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",
             noActivityText: "–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
             
             // Activation
             welcomeTitle: "‚ö° –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CardGift",
             registerAccount: "üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è",
             activateDirectly: "–ò–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é:",
             basicUser: "üë§ –ë–∞–∑–æ–≤—ã–π",
             miniAdmin: "‚ö° –ú–∏–Ω–∏-–ê–¥–º–∏–Ω",
             superAdmin: "üöÄ –°—É–ø–µ—Ä-–ê–¥–º–∏–Ω",
             
             // Wallet
             walletTitle: "üíé Web3 –ö–æ—à–µ–ª–µ–∫",
             walletNetwork: "–°–µ—Ç—å: opBNB Mainnet",
             blockchainConnection: "üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–ª–æ–∫—á–µ–π–Ω—É",
             connectSafePal: "üîê –ü–æ–¥–∫–ª—é—á–∏—Ç—å SafePal",
             safePalConnected: "‚úÖ SafePal –ø–æ–¥–∫–ª—é—á–µ–Ω",
             contractInfo: "üìÑ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ",
             
             // Settings
             settingsTitle: "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏",
             languageSettings: "üåç –Ø–∑—ã–∫–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
         },
         
         ua: {
             // Dashboard
             dashboardTitle: "üìä Web3 –ü–∞–Ω–µ–ª—å",
             lastUpdate: "–û–Ω–æ–≤–ª–µ–Ω–æ:",
             connectionStatus: "üîê –°—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è",
             walletNotConnected: "‚ö†Ô∏è –ì–∞–º–∞–Ω–µ—Ü—å –Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ",
             connectWalletDesc: "–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å SafePal –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π",
             connectWallet: "üîê –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å",
             
             // Menu
             menuDashboard: "–ü–∞–Ω–µ–ª—å",
             menuContacts: "–ö–æ–Ω—Ç–∞–∫—Ç–∏",
             menuReferrals: "–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞",
             menuCRM: "CRM —ñ –ß–∞—Ç",
             menuCoauthors: "–°–ø—ñ–≤–∞–≤—Ç–æ—Ä–∏",
             menuMailings: "–ú–∞—Å–æ–≤—ñ —Ä–æ–∑—Å–∏–ª–∫–∏",
             menuAnalytics: "–†–æ–∑—à–∏—Ä–µ–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞",
             menuWallet: "Web3 –ì–∞–º–∞–Ω–µ—Ü—å",
             menuSettings: "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
             
             // Stats
             totalContactsLabel: "–í—Å—å–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤",
             totalReferralsLabel: "–ê–∫—Ç–∏–≤–Ω—ñ —Ä–µ—Ñ–µ—Ä–∞–ª–∏",
             totalEarningsLabel: "–ó–∞—Ä–æ–±—ñ—Ç–æ–∫ (opBNB)",
             totalCardsLabel: "–°—Ç–≤–æ—Ä–µ–Ω–æ –ª–∏—Å—Ç—ñ–≤–æ–∫",
             
             // Categories
             contactCategoriesTitle: "üì± –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤",
             recentActivityTitle: "üìà –û—Å—Ç–∞–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å",
             noActivityText: "–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å –≥–∞–º–∞–Ω–µ—Ü—å –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ",
             
             // Activation
             welcomeTitle: "‚ö° –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –≤ CardGift",
             registerAccount: "üìù –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è",
             activateDirectly: "–ê–±–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –Ω–∞–ø—Ä—è–º—É:",
             basicUser: "üë§ –ë–∞–∑–æ–≤–∏–π",
             miniAdmin: "‚ö° –ú—ñ–Ω—ñ-–ê–¥–º—ñ–Ω",
             superAdmin: "üöÄ –°—É–ø–µ—Ä-–ê–¥–º—ñ–Ω",
             
             // Wallet
             walletTitle: "üíé Web3 –ì–∞–º–∞–Ω–µ—Ü—å",
             walletNetwork: "–ú–µ—Ä–µ–∂–∞: opBNB Mainnet",
             blockchainConnection: "üîó –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–ª–æ–∫—á–µ–π–Ω—É",
             connectSafePal: "üîê –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ SafePal",
             safePalConnected: "‚úÖ SafePal –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ",
             contractInfo: "üìÑ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç",
             
             // Settings
             settingsTitle: "‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
             languageSettings: "üåç –ú–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"
         }
     };

     // –§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤
     function applyTranslations(lang) {
         const t = translations[lang] || translations.en;
         
         // –û–±–Ω–æ–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ ID
         Object.keys(t).forEach(key => {
             const element = document.getElementById(key);
             if (element) {
                 element.textContent = t[key];
             }
         });
         
         // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
         document.title = `CardGift - ${t.dashboardTitle || 'Admin Dashboard'}`;
         
         console.log(`üåç –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: ${lang}`);
     }

     // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
     function loadSavedLanguage() {
         const savedLang = localStorage.getItem('adminLanguage') || 'en';
         currentLanguage = savedLang;
         applyTranslations(savedLang);
         
         // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
         document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
         const activeBtn = document.getElementById(`lang${savedLang.charAt(0).toUpperCase() + savedLang.slice(1)}`);
         if (activeBtn) {
             activeBtn.classList.add('active');
         }
     }

     // ==================== –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• ====================
    function loadDashboardData() {
    // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
    const storedContacts = localStorage.getItem('allContacts');
    if (storedContacts) {
        contactsData = JSON.parse(storedContacts);
    } else {
        contactsData = {
            telegram: [],
            whatsapp: [],
            email: [],
            instagram: [],
            viber: [],
            facebook: [],
            tiktok: [],
            twitter: []
        };
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫—É—é –ë–î
    const storedReferrals = localStorage.getItem('referralDatabase');
    if (storedReferrals) {
        referralData = JSON.parse(storedReferrals);
    } else {
        referralData = {
            levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] },
            users: {} // ID: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        };
    }
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—à–µ–ª—å–∫–∏
    const storedWallets = localStorage.getItem('walletDatabase');
    if (storedWallets) {
        window.walletDatabase = JSON.parse(storedWallets);
    } else {
        window.walletDatabase = {}; // userID: walletAddress
    }
    
    updateDashboardStats();
}

    function updateDashboardStats() {
        let totalContacts = 0;
        Object.keys(contactsData).forEach(category => {
            const count = contactsData[category].length;
            totalContacts += count;
            
            const counterElement = document.getElementById(category + 'Count');
            if (counterElement) {
                counterElement.textContent = count;
            }
        });
        
        document.getElementById('totalContacts').textContent = totalContacts;
        
        const cardsData = localStorage.getItem('userCards');
        let totalCards = 0;
        if (cardsData) {
            const cardsObject = JSON.parse(cardsData);
            Object.keys(cardsObject).forEach(userId => {
                totalCards += cardsObject[userId].length;
            });
        }
        document.getElementById('totalCards').textContent = totalCards;
        
        let totalReferrals = 0;
        if (referralData && referralData.levels) {
            Object.values(referralData.levels).forEach(level => {
                totalReferrals += level.length;
            });
        }
        document.getElementById('totalReferrals').textContent = totalReferrals;
        
        updateTime();
    }

    // ==================== –£–¢–ò–õ–ò–¢–´ ====================
    function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        const updateTimeElement = document.getElementById('updateTime');
        if (updateTimeElement) {
            updateTimeElement.textContent = timeString;
        }
    }

    function exportContacts() {
        if (currentUser.level === 0) {
            showNotification('Connect wallet to export contacts', 'error');
            return;
        }
        
        const dataStr = JSON.stringify(contactsData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `cardgift-contacts-${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('Contacts exported successfully!', 'success');
    }

    // ==================== –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ====================
    function showNotification(message, type = 'info', duration = 3000) {
        const existingNotification = document.querySelector('.notification');
        if (existingNotification) {
            existingNotification.remove();
        }
        
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.textContent = message;
        
        notification.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 10000;
            opacity: 0;
            transform: translateY(100%);
            transition: all 0.3s ease;
            border: 1px solid #333;
            max-width: 400px;
            word-wrap: break-word;
            font-weight: 500;
            backdrop-filter: blur(10px);
        `;
        
        if (type === 'success') {
            notification.style.borderColor = '#4CAF50';
            notification.style.background = 'rgba(76, 175, 80, 0.2)';
            notification.style.color = '#4CAF50';
        } else if (type === 'error') {
            notification.style.borderColor = '#f44336';
            notification.style.background = 'rgba(244, 67, 54, 0.2)';
            notification.style.color = '#f44336';
        } else if (type === 'info') {
            notification.style.borderColor = '#2196F3';
            notification.style.background = 'rgba(33, 150, 243, 0.2)';
            notification.style.color = '#2196F3';
        }
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.opacity = '1';
            notification.style.transform = 'translateY(0)';
        }, 100);
        
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translateY(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, duration);
    }

    // ==================== –ü–ï–†–ò–û–î–ò–ß–ï–°–ö–ò–ï –û–ë–ù–û–í–õ–ï–ù–ò–Ø ====================
    setInterval(() => {
        updateTime();
        
        if (currentSection === 'dashboard') {
            updateDashboardStats();
        }
        
        if (currentSection === 'crm' && currentUser.level >= 2) {
            updateCRMStats();
        }
    }, 30000);

    // ==================== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ====================
    window.addEventListener('resize', () => {
        if (window.innerWidth > 768) {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            sidebar.classList.remove('mobile-visible', 'mobile-hidden');
            mainContent.classList.remove('full-width');
        }
    });

    // ==================== –ó–ê–ö–†–´–¢–ò–ï –ú–û–î–ê–õ–¨–ù–´–• –û–ö–û–ù ====================
    window.addEventListener('click', function(event) {
        const crmModal = document.getElementById('crmModal');
        if (event.target === crmModal) {
            closeCRMModal();
        }
    });

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeCRMModal();
        }
    });

    // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –ö–û–®–ï–õ–¨–ö–ê ====================
    // –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —è–∑—ã–∫
            loadSavedLanguage();
            
            const provider = window.safepal?.ethereum || window.ethereum;
            
            if (provider) {
                const accounts = await provider.request({
                    method: 'eth_accounts'
                });
                
                if (accounts.length > 0) {
                    console.log('üîÑ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:', accounts[0]);
                    userWalletAddress = accounts[0].toLowerCase();
                    localStorage.setItem('connectedWallet', userWalletAddress);
                    isWeb3Connected = true;
                    await checkUserAccess();
                    updateUserInterface();
                    console.log('‚úÖ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ');
                }
            }
        } catch (error) {
            console.log('‚ÑπÔ∏è –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:', error);
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ—à–µ–ª—å–∫–∞
    if (window.safepal && window.safepal.ethereum) {
        window.safepal.ethereum.on('accountsChanged', (accounts) => {
            console.log('üîÑ SafePal –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
            if (accounts.length === 0) {
                userWalletAddress = null;
                isWeb3Connected = false;
                currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                localStorage.removeItem('connectedWallet');
                updateUserInterface();
                showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
                window.location.reload();
            } else {
                userWalletAddress = accounts[0].toLowerCase();
                localStorage.setItem('connectedWallet', userWalletAddress);
                checkUserAccess().then(() => updateUserInterface());
            }
        });
        
        window.safepal.ethereum.on('chainChanged', (chainId) => {
            console.log('üîÑ SafePal —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
            if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
            }
            setTimeout(() => window.location.reload(), 1000);
        });
    } else if (window.ethereum) {
        window.ethereum.on('accountsChanged', (accounts) => {
            console.log('üîÑ Ethereum –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
            if (accounts.length === 0) {
                userWalletAddress = null;
                isWeb3Connected = false;
                currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                localStorage.removeItem('connectedWallet');
                updateUserInterface();
                showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
                window.location.reload();
            } else {
                userWalletAddress = accounts[0].toLowerCase();
                localStorage.setItem('connectedWallet', userWalletAddress);
                checkUserAccess().then(() => updateUserInterface());
            }
        });
        
        window.ethernet.on('chainChanged', (chainId) => {
            console.log('üîÑ Ethereum —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
            if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
            }
            setTimeout(() => window.location.reload(), 1000);
        });
    }

    // ==================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–¢–ò–õ–ò–¢–´ ====================
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏ opBNB
    async function ensureOpBNBNetwork() {
        try {
            const provider = window.safepal?.ethereum || window.ethereum;
            if (!provider) return false;
            
            const chainId = await provider.request({ method: 'eth_chainId' });
            const currentChainId = parseInt(chainId, 16);
            
            if (currentChainId !== CONTRACT_CONFIG.chainId) {
                console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ opBNB...');
                
                try {
                    await provider.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId) }]
                    });
                    console.log('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ opBNB');
                    return true;
                } catch (switchError) {
                    if (switchError.code === 4902) {
                        // –°–µ—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –¥–æ–±–∞–≤–ª—è–µ–º
                        await provider.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId),
                                chainName: 'opBNB Mainnet',
                                nativeCurrency: {
                                    name: 'BNB',
                                    symbol: 'BNB',
                                    decimals: 18
                                },
                                rpcUrls: [CONTRACT_CONFIG.rpcUrl],
                                blockExplorerUrls: ['https://opbnbscan.com/']
                            }]
                        });
                        console.log('‚úÖ opBNB —Å–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞');
                        return true;
                    }
                    throw switchError;
                }
            }
            
            return true;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é:', error);
            showNotification('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ opBNB', 'error');
            return false;
        }
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
    async function getWalletBalance() {
        try {
            if (!web3 || !userWalletAddress) return '0';
            
            const balance = await web3.eth.getBalance(userWalletAddress);
            return web3.utils.fromWei(balance, 'ether');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
            return '0';
        }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
    async function updateWalletBalance() {
        try {
            const balance = await getWalletBalance();
            const balanceElement = document.getElementById('walletBalance');
            if (balanceElement) {
                balanceElement.textContent = `Balance: ${parseFloat(balance).toFixed(4)} BNB`;
            }
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    async function checkTransactionStatus(txHash) {
        try {
            if (!web3) return null;
            
            const receipt = await web3.eth.getTransactionReceipt(txHash);
            return receipt;
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:', error);
            return null;
        }
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–∞
    function isValidAddress(address) {
        try {
            return web3.utils.isAddress(address);
        } catch (error) {
            return false;
        }
    }

    // –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    function shortenAddress(address, chars = 4) {
        if (!address) return '';
        return `${address.substring(0, chars + 2)}...${address.substring(address.length - chars)}`;
    }

    // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
    async function copyToClipboard(text) {
        try {
            await navigator.clipboard.writeText(text);
            showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success', 1500);
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
            showNotification('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
        }
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞
    function formatNumber(num, decimals = 4) {
        if (isNaN(num)) return '0';
        return parseFloat(num).toFixed(decimals);
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    function isMobile() {
        return window.innerWidth <= 768;
    }

    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    function logEvent(eventName, data = {}) {
        const timestamp = new Date().toISOString();
        console.log(`üìä [${timestamp}] ${eventName}:`, data);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        const logs = JSON.parse(localStorage.getItem('dashboardLogs') || '[]');
        logs.push({
            timestamp,
            event: eventName,
            data,
            userAgent: navigator.userAgent,
            wallet: connectedWallet,
            userLevel: currentUser.level
        });
        
        // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π
        if (logs.length > 100) {
            logs.splice(0, logs.length - 100);
        }
        
        localStorage.setItem('dashboardLogs', JSON.stringify(logs));
    }

    // –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
    function clearAllData() {
        if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ dashboard? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
            localStorage.clear();
            sessionStorage.clear();
            showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
            setTimeout(() => window.location.reload(), 1000);
        }
    }

    // –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    function exportLogs() {
        try {
            const logs = localStorage.getItem('dashboardLogs') || '[]';
            const blob = new Blob([logs], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `cardgift-dashboard-logs-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            showNotification('–õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        } catch (error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤:', error);
            showNotification('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤', 'error');
        }
    }

    // ==================== –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    window.onload = async function() {
        console.log('üöÄ CardGift Web3 Dashboard initializing...');
        
        // ‚úÖ –ó–ê–ì–†–£–ñ–ê–ï–ú –Ø–ó–´–ö –ü–ï–†–í–´–ú –î–ï–õ–û–ú
        loadSavedLanguage();
        
        await initWeb3();
        
        if (!referralData || !referralData.levels) {
            referralData = {
                levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] }
            };
        }
        
        if (isWeb3Connected && userWalletAddress) {
            await checkUserAccess();
        } else {
            currentUser = {
                userId: 'NOT_CONNECTED',
                level: 0,
                isActive: false,
                walletAddress: null
            };
        }

        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        
        updateUserInterface();
        loadDashboardData();
        updateTime();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º CRM –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø
        if (currentUser.level >= 2) {
            updateCRMStats();
            loadRecentConversations();
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –∫–æ—à–µ–ª—å–∫–∞
        if (userWalletAddress) {
            updateWalletBalance();
        }
        
        console.log('‚úÖ Web3 Dashboard initialized');
    };

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    window.cardGiftDebug = {
        clearData: clearAllData,
        exportLogs: exportLogs,
        checkUser: checkUserAccess,
        updateUI: updateUserInterface,
        getBalance: getWalletBalance,
        ensureNetwork: ensureOpBNBNetwork,
        currentUser: () => currentUser,
        contractConfig: CONTRACT_CONFIG,
        showLevel: showLevel,
        searchContacts: searchContacts,
        updateCRM: updateCRMStats
    };

    console.log('üéâ CardGift Web3 Dashboard –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
    console.log('üí° –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: window.cardGiftDebug');
    
    // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
    logEvent('dashboard_initialized', {
        userAgent: navigator.userAgent,
        screenSize: `${window.innerWidth}x${window.innerHeight}`,
        timestamp: new Date().toISOString(),
        language: currentLanguage,
        userLevel: currentUser.level
    });

</script>
</body>
</html>
