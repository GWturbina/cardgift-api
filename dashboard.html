<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title id="pageTitle">CardGift - Admin Dashboard</title>
   
   <!-- PWA Meta tags -->
   <meta name="description" content="CardGift Admin Dashboard - Manage your network">
   <meta name="theme-color" content="#FFD700">
   
   <!-- Favicon fix -->
   <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÅ</text></svg>">
   
   <!-- Web3 Integration - SafePal Priority -->
   <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
   <script src="https://unpkg.com/@binance-chain/bsc-connector@1.0.0/dist/index.umd.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
   
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: 'Arial', sans-serif;
           background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
           color: #FFFFFF;
           overflow-x: hidden;
           min-height: 100vh;
       }

       /* –ó–æ–ª–æ—Ç—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Ñ–æ–Ω–∞ */
       body::before {
           content: '';
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                       radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
           pointer-events: none;
           z-index: -1;
       }

       /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
       .language-switcher {
           position: fixed;
           top: 15px;
           right: 15px;
           z-index: 1000;
           display: flex;
           background: rgba(0, 0, 0, 0.9);
           border-radius: 15px;
           padding: 4px;
           backdrop-filter: blur(10px);
           border: 1px solid rgba(255, 215, 0, 0.3);
       }

       .lang-btn {
           background: transparent;
           border: none;
           color: #FFD700;
           padding: 6px 12px;
           border-radius: 10px;
           cursor: pointer;
           font-size: 12px;
           font-weight: bold;
           transition: all 0.3s ease;
           min-width: 35px;
       }

       .lang-btn.active {
           background: rgba(255, 215, 0, 0.3);
           color: #FFF;
       }

       /* SIDEBAR */
       .sidebar {
           position: fixed;
           left: 0;
           top: 0;
           width: 280px;
           height: 100vh;
           background: rgba(0, 0, 0, 0.95);
           backdrop-filter: blur(20px);
           border-right: 2px solid #FFD700;
           z-index: 100;
           overflow-y: auto;
           transition: transform 0.3s ease;
       }

       .sidebar.mobile-hidden {
           transform: translateX(-100%);
       }

       .sidebar-header {
           padding: 25px 20px;
           text-align: center;
           border-bottom: 1px solid rgba(255, 215, 0, 0.3);
       }

       .logo {
           font-size: 28px;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           font-weight: bold;
           margin-bottom: 8px;
       }

       .user-info {
           background: rgba(255, 215, 0, 0.1);
           border-radius: 10px;
           padding: 15px;
           margin-top: 15px;
       }

       .user-level {
           background: #FFD700;
           color: #000;
           padding: 4px 10px;
           border-radius: 15px;
           font-size: 11px;
           font-weight: bold;
           display: inline-block;
           margin-bottom: 8px;
       }

       .user-id {
           color: #CCC;
           font-size: 12px;
       }

       /* NOTIFICATION BADGE */
       .notification-badge {
           position: absolute;
           top: -8px;
           right: -8px;
           background: #FF4444;
           color: white;
           border-radius: 50%;
           width: 20px;
           height: 20px;
           font-size: 10px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           animation: pulse 2s infinite;
       }

       .notification-badge.read {
           background: #4CAF50;
           animation: none;
       }

       .notification-badge.hidden {
           display: none;
       }

       @keyframes pulse {
           0% { transform: scale(1); }
           50% { transform: scale(1.1); }
           100% { transform: scale(1); }
       }

       /* MENU */
       .sidebar-menu {
           padding: 20px 0;
       }

       .menu-item {
           display: flex;
           align-items: center;
           padding: 15px 25px;
           color: #CCC;
           text-decoration: none;
           transition: all 0.3s ease;
           border-left: 3px solid transparent;
           cursor: pointer;
           position: relative;
       }

       .menu-item:hover {
           background: rgba(255, 215, 0, 0.1);
           color: #FFF;
       }

       .menu-item.active {
           background: rgba(255, 215, 0, 0.2);
           border-left-color: #FFD700;
           color: #FFD700;
       }

       .menu-item.locked {
           opacity: 0.4;
           cursor: not-allowed;
           position: relative;
       }

       .menu-item.locked::after {
           content: "üîí";
           position: absolute;
           right: 25px;
           font-size: 16px;
       }

       .menu-icon {
           width: 24px;
           margin-right: 15px;
           text-align: center;
           font-size: 18px;
       }

       /* MAIN CONTENT */
       .main-content {
           margin-left: 280px;
           padding: 30px;
           min-height: 100vh;
           transition: margin-left 0.3s ease;
       }

       .main-content.full-width {
           margin-left: 0;
       }

       /* MOBILE TOGGLE */
       .mobile-toggle {
           display: none;
           position: fixed;
           top: 15px;
           left: 15px;
           z-index: 1001;
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 10px;
           padding: 10px;
           cursor: pointer;
           color: #FFD700;
       }

       /* SECTION */
       .content-section {
           display: none;
           animation: fadeInUp 0.5s ease;
       }

       .content-section.active {
           display: block;
       }

       .section-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 30px;
           flex-wrap: wrap;
       }

       .section-title {
           font-size: 28px;
           color: #FFD700;
           font-weight: bold;
       }

       /* STATS CARDS */
       .stats-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin-bottom: 30px;
       }

       .stat-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 15px;
           padding: 20px;
           text-align: center;
           transition: transform 0.3s ease;
       }

       .stat-card:hover {
           transform: translateY(-5px);
       }

       .stat-icon {
           font-size: 32px;
           margin-bottom: 10px;
       }

       .stat-number {
           font-size: 24px;
           font-weight: bold;
           color: #FFD700;
           margin-bottom: 5px;
       }

       .stat-label {
           color: #CCC;
           font-size: 14px;
       }

       /* CONTACT CATEGORIES */
       .contact-categories {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 15px;
           margin-bottom: 30px;
       }

       .category-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           text-align: center;
           transition: all 0.3s ease;
           cursor: pointer;
       }

       .category-card:hover {
           border-color: #FFD700;
           background: rgba(255, 215, 0, 0.05);
       }

       .category-icon {
           font-size: 24px;
           margin-bottom: 8px;
       }

       .category-name {
           font-weight: bold;
           margin-bottom: 5px;
       }

       .category-count {
           color: #FFD700;
           font-size: 18px;
           font-weight: bold;
       }

       /* REFERRAL SYSTEM */
       .referral-section {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï LEVEL BUTTONS - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .level-buttons {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: none; /* Firefox */
           -ms-overflow-style: none; /* IE/Edge */
           padding: 5px;
           justify-content: flex-start;
       }

       .level-buttons::-webkit-scrollbar {
           display: none; /* Chrome/Safari */
       }

       .level-btn {
           background: rgba(255, 215, 0, 0.1);
           border: 2px solid #FFD700;
           color: #FFD700;
           border-radius: 50%;
           width: 50px;
           height: 50px;
           min-width: 50px; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
           flex-shrink: 0; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
       }

       .level-btn:hover {
           background: rgba(255, 215, 0, 0.2);
           transform: scale(1.1);
       }

       .level-btn.active {
           background: #FFD700;
           color: #000;
       }

       .level-btn.locked {
           opacity: 0.3;
           cursor: not-allowed;
       }

       .level-btn.locked::after {
           content: "üîí";
           position: absolute;
           top: -5px;
           right: -5px;
           font-size: 12px;
       }

       /* LEVEL CONTENT */
       .level-content {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 10px;
           padding: 20px;
           margin-top: 20px;
           display: none;
       }

       .level-content.active {
           display: block;
       }

       .level-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 15px;
           flex-wrap: wrap;
       }

       .level-title {
           color: #FFD700;
           font-weight: bold;
           font-size: 18px;
       }

       .level-count {
           background: rgba(255, 215, 0, 0.2);
           color: #FFD700;
           padding: 4px 12px;
           border-radius: 15px;
           font-size: 12px;
           font-weight: bold;
       }

       /* ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø TEAM TABLE - —Å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º */
       .team-table {
           overflow-x: auto;
           overflow-y: hidden;
           scrollbar-width: none; /* Firefox */
           -ms-overflow-style: none; /* IE/Edge */
           border-radius: 10px;
           border: 1px solid rgba(255, 215, 0, 0.2);
       }

       .team-table::-webkit-scrollbar {
           display: none; /* Chrome/Safari */
       }

       .team-table table {
           width: 100%;
           border-collapse: collapse;
           min-width: 600px; /* ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞ */
       }

       .team-table th {
           background: rgba(255, 215, 0, 0.1);
           color: #FFD700;
           padding: 12px 8px;
           text-align: left;
           border-bottom: 2px solid #FFD700;
           font-size: 14px;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
       }

       .team-table td {
           padding: 10px 8px;
           border-bottom: 1px solid rgba(255, 215, 0, 0.2);
           color: #FFF;
           font-size: 13px;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
       }

       .team-table tr:hover {
           background: rgba(255, 215, 0, 0.05);
       }

       .user-id-cell {
           color: #4CAF50;
           font-weight: bold;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .user-id-cell:hover {
           color: #FFD700;
       }

       .wallet-status {
           padding: 2px 6px;
           border-radius: 10px;
           font-size: 10px;
           font-weight: bold;
       }

       .wallet-active {
           background: rgba(76, 175, 80, 0.3);
           color: #4CAF50;
       }

       .wallet-inactive {
           background: rgba(128, 128, 128, 0.3);
           color: #888;
       }

       .status-badge {
           padding: 3px 8px;
           border-radius: 12px;
           font-size: 10px;
           font-weight: bold;
       }

       .status-coauthor {
           background: rgba(139, 69, 19, 0.3);
           color: #D2691E;
       }

       .status-super {
           background: rgba(255, 215, 0, 0.3);
           color: #FFD700;
       }

       .status-mini {
           background: rgba(255, 193, 7, 0.3);
           color: #FFC107;
       }

       .status-basic {
           background: rgba(128, 128, 128, 0.3);
           color: #CCC;
       }

       /* CRM MODAL */
       .crm-modal {
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.9);
           z-index: 2000;
           display: none;
           align-items: center;
           justify-content: center;
           padding: 20px;
       }

       .crm-modal.show {
           display: flex;
       }

       .crm-modal-content {
           background: rgba(0, 0, 0, 0.95);
           border: 2px solid #FFD700;
           border-radius: 15px;
           padding: 30px;
           max-width: 600px;
           width: 100%;
           max-height: 80vh;
           overflow-y: auto;
       }

       .crm-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 20px;
       }

       .crm-title {
           color: #FFD700;
           font-size: 20px;
           font-weight: bold;
       }

       .close-btn {
           background: none;
           border: none;
           color: #CCC;
           font-size: 24px;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .close-btn:hover {
           color: #FFD700;
       }

       .crm-tabs {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           overflow-x: auto; /* ‚úÖ –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª –¥–ª—è —Ç–∞–±–æ–≤ */
           scrollbar-width: none;
           -ms-overflow-style: none;
       }

       .crm-tabs::-webkit-scrollbar {
           display: none;
       }

       .crm-tab {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           padding: 8px 16px;
           border-radius: 8px;
           cursor: pointer;
           transition: all 0.3s ease;
           white-space: nowrap; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å —Ç–µ–∫—Å—Ç–∞ */
           flex-shrink: 0; /* ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Å–∂–∞—Ç–∏–µ */
       }

       .crm-tab.active {
           background: #FFD700;
           color: #000;
       }

       .crm-content {
           display: none;
       }

       .crm-content.active {
           display: block;
       }

       .notes-textarea {
           width: 100%;
           min-height: 150px;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 15px;
           color: #FFF;
           resize: vertical;
       }

       .notes-textarea:focus {
           outline: none;
           border-color: #FFA500;
       }

       .save-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
           border: none;
           border-radius: 8px;
           padding: 10px 20px;
           cursor: pointer;
           margin-top: 10px;
           transition: all 0.3s ease;
       }

       .save-btn:hover {
           transform: translateY(-2px);
       }

       /* CHAT SECTION */
       .chat-container {
           border: 1px solid #FFD700;
           border-radius: 8px;
           height: 300px;
           display: flex;
           flex-direction: column;
       }

       .chat-messages {
           flex: 1;
           padding: 15px;
           overflow-y: auto;
           background: rgba(255, 255, 255, 0.05);
       }

       .chat-input-area {
           padding: 10px;
           border-top: 1px solid #FFD700;
           display: flex;
           gap: 10px;
       }

       .chat-input {
           flex: 1;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 8px 12px;
           color: #FFF;
       }

       .send-btn {
           background: #FFD700;
           color: #000;
           border: none;
           border-radius: 8px;
           padding: 8px 16px;
           cursor: pointer;
           font-weight: bold;
       }

       /* CO-AUTHORS MANAGEMENT */
       .coauthors-section {
           background: rgba(139, 69, 19, 0.1);
           border: 2px solid #D2691E;
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       .add-coauthor-btn {
           background: linear-gradient(45deg, #D2691E, #A0522D);
           color: white;
           border: none;
           border-radius: 10px;
           padding: 12px 25px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
       }

       .add-coauthor-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 4px 8px rgba(210, 105, 30, 0.3);
       }

       .coauthor-item {
           display: flex;
           justify-content: space-between;
           align-items: center;
           padding: 15px;
           background: rgba(139, 69, 19, 0.1);
           border-radius: 10px;
           margin-bottom: 10px;
       }

       .coauthor-info {
           color: #D2691E;
           font-weight: bold;
       }

       .coauthor-actions {
           display: flex;
           gap: 10px;
       }

       .action-btn {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           border-radius: 5px;
           padding: 5px 10px;
           cursor: pointer;
           transition: all 0.3s ease;
       }

       .action-btn:hover {
           background: rgba(255, 215, 0, 0.2);
       }

       .action-btn.danger {
           border-color: #FF4444;
           color: #FF4444;
       }

       .action-btn.danger:hover {
           background: rgba(255, 68, 68, 0.2);
       }

       /* DEVELOPMENT PLACEHOLDER */
       .development-placeholder {
           background: rgba(255, 165, 0, 0.1);
           border: 2px dashed #FFA500;
           border-radius: 15px;
           padding: 50px;
           text-align: center;
           margin: 30px 0;
       }

       .development-icon {
           font-size: 64px;
           margin-bottom: 20px;
       }

       .development-title {
           color: #FFA500;
           font-size: 24px;
           font-weight: bold;
           margin-bottom: 15px;
       }

       .development-text {
           color: #CCC;
           line-height: 1.6;
       }

       /* ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
       @media (max-width: 768px) {
           .sidebar {
               transform: translateX(-100%);
           }

           .sidebar.mobile-visible {
               transform: translateX(0);
           }

           .main-content {
               margin-left: 0;
               padding: 20px;
               padding-top: 70px;
           }

           .mobile-toggle {
               display: block;
           }

           .stats-grid {
               grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
               gap: 15px;
           }

           .contact-categories {
               grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
           }

           .section-header {
               flex-direction: column;
               align-items: flex-start;
               gap: 15px;
           }

           .language-switcher {
               top: 75px;
               right: 10px;
           }

           /* ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è level-buttons */
           .level-buttons {
               gap: 8px;
               padding: 10px 5px;
               justify-content: flex-start;
           }

           .level-btn {
               width: 45px;
               height: 45px;
               min-width: 45px;
               font-size: 14px;
           }

           .crm-modal-content {
               padding: 20px;
               margin: 10px;
           }

           /* ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü */
           .team-table {
               font-size: 12px;
           }

           .team-table th,
           .team-table td {
               padding: 8px 4px;
               font-size: 11px;
           }

           /* ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ç–∞–±—ã CRM */
           .crm-tabs {
               gap: 5px;
           }

           .crm-tab {
               padding: 6px 12px;
               font-size: 12px;
           }
       }

       /* ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ */
       @media (max-width: 480px) {
           .level-btn {
               width: 40px;
               height: 40px;
               min-width: 40px;
               font-size: 12px;
           }

           .level-buttons {
               gap: 5px;
           }

           .team-table table {
               min-width: 500px; /* –£–º–µ–Ω—å—à–µ–Ω–æ –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
           }
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateY(30px);
           }
           to {
               opacity: 1;
               transform: translateY(0);
           }
       }
   </style>
</head>
<body>
   <!-- –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ -->
   <div class="language-switcher">
       <button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
       <button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
       <button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
   </div>

   <!-- MOBILE TOGGLE -->
   <div class="mobile-toggle" onclick="toggleSidebar()">
       <span style="font-size: 20px;">‚ò∞</span>
   </div>

   <!-- SIDEBAR -->
   <div class="sidebar" id="sidebar">
       <div class="sidebar-header">
           <div class="logo">üéÅ CardGift</div>
           <div class="user-info">
               <div class="user-level" id="userLevel">NOT CONNECTED</div>
               <div class="user-id" id="userIdDisplay">ID: <span id="currentUserId">Connect Wallet</span></div>
           </div>
       </div>
       
       <nav class="sidebar-menu">
           <div class="menu-item active" onclick="showSection('dashboard')" data-section="dashboard">
               <div class="menu-icon">üìä</div>
               <span id="menuDashboard">Dashboard</span>
           </div>
           <div class="menu-item locked" onclick="showSection('contacts')" data-section="contacts">
               <div class="menu-icon">üë•</div>
               <span id="menuContacts">Contacts</span>
           </div>
           <div class="menu-item locked" onclick="showSection('referrals')" data-section="referrals">
               <div class="menu-icon">üîó</div>
               <span id="menuReferrals">Referral System</span>
               <div class="notification-badge hidden" id="referralNotifications">0</div>
           </div>
           <div class="menu-item locked" onclick="showSection('crm')" data-section="crm">
               <div class="menu-icon">üí¨</div>
               <span id="menuCRM">CRM & Chat</span>
               <div class="notification-badge hidden" id="crmNotifications">0</div>
           </div>
           <div class="menu-item locked" onclick="showSection('coauthors')" data-section="coauthors" id="coauthorsMenuItem">
               <div class="menu-icon">üëë</div>
               <span id="menuCoauthors">Co-Authors</span>
           </div>
           <div class="menu-item locked" onclick="showSection('mailings')" data-section="mailings">
               <div class="menu-icon">üì¢</div>
               <span id="menuMailings">Mass Mailings</span>
           </div>
           <div class="menu-item locked" onclick="showSection('analytics')" data-section="analytics">
               <div class="menu-icon">üìà</div>
               <span id="menuAnalytics">Advanced Analytics</span>
           </div>
           <div class="menu-item" onclick="showSection('wallet')" data-section="wallet">
               <div class="menu-icon">üíé</div>
               <span id="menuWallet">Web3 Wallet</span>
           </div>
          <div class="menu-item locked" onclick="showSection('settings')" data-section="settings">
              <div class="menu-icon">‚öôÔ∏è</div>
              <span id="menuSettings">Settings</span>
          </div>
      </nav>
  </div>

  <!-- CRM MODAL -->
  <div class="crm-modal" id="crmModal">
      <div class="crm-modal-content">
          <div class="crm-header">
              <div class="crm-title" id="crmModalTitle">User CRM</div>
              <button class="close-btn" onclick="closeCRMModal()">√ó</button>
          </div>
          
          <div class="crm-tabs">
              <button class="crm-tab active" onclick="switchCRMTab('notes')" id="notesTab">üìù Notes</button>
              <button class="crm-tab" onclick="switchCRMTab('chat')" id="chatTab">üí¨ Chat</button>
              <button class="crm-tab" onclick="switchCRMTab('social')" id="socialTab">üì± Social</button>
          </div>
          
          <div class="crm-content active" id="notesContent">
              <textarea class="notes-textarea" id="userNotes" placeholder="Write your notes about this user..."></textarea>
              <button class="save-btn" onclick="saveUserNotes()">üíæ Save Notes</button>
          </div>
          
          <div class="crm-content" id="chatContent">
              <div class="chat-container">
                  <div class="chat-messages" id="chatMessages">
                      <div style="text-align: center; color: #CCC; padding: 20px;">
                          No messages yet. Start a conversation!
                      </div>
                  </div>
                  <div class="chat-input-area">
                      <input type="text" class="chat-input" id="chatInput" placeholder="Type your message...">
                      <button class="send-btn" onclick="sendMessage()">Send</button>
                  </div>
              </div>
          </div>
          
          <div class="crm-content" id="socialContent">
              <div style="color: #CCC; line-height: 1.6;">
                  <h4 style="color: #FFD700; margin-bottom: 10px;">Contact Information:</h4>
                  <div id="userSocialInfo">
                      <p><strong>Platform:</strong> <span id="userPlatform">-</span></p>
                      <p><strong>Contact:</strong> <span id="userContact">-</span></p>
                      <p><strong>Registration Date:</strong> <span id="userRegDate">-</span></p>
                  </div>
                  <button style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin-top: 15px;" onclick="openSocialContact()">
                      üì± Open in Social Media
                  </button>
              </div>
          </div>
      </div>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main-content" id="mainContent">
      
      <!-- DASHBOARD SECTION -->
     <div id="dashboard" class="content-section active">
         <div class="section-header">
             <h1 class="section-title" id="dashboardTitle">üìä Web3 Dashboard</h1>
             <div style="color: #CCC; font-size: 14px;" id="lastUpdate">Last update: <span id="updateTime">--:--</span></div>
         </div>

         <!-- CONNECTION STATUS -->
         <div class="referral-section" style="margin-bottom: 30px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;">üîê Connection Status</h3>
             <div id="connectionStatus" style="text-align: center; padding: 20px;">
                 <div style="color: #FF4444; font-size: 18px; margin-bottom: 10px;">‚ö†Ô∏è Wallet Not Connected</div>
                 <div style="color: #CCC;">Connect your SafePal wallet to access all features</div>
                 <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 15px 30px; cursor: pointer; margin-top: 15px; font-weight: bold;" onclick="showSection('wallet')">
                     üîê Connect Wallet
                 </button>
             </div>
         </div>

         <!-- MAIN STATS -->
         <div class="stats-grid">
             <div class="stat-card">
                 <div class="stat-icon">üë•</div>
                 <div class="stat-number" id="totalContacts">0</div>
                 <div class="stat-label" id="totalContactsLabel">Total Contacts</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üîó</div>
                 <div class="stat-number" id="totalReferrals">0</div>
                 <div class="stat-label" id="totalReferralsLabel">Active Referrals</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üíé</div>
                 <div class="stat-number" id="totalEarnings">0.000</div>
                 <div class="stat-label" id="totalEarningsLabel">Earnings (opBNB)</div>
             </div>
             <div class="stat-card">
                 <div class="stat-icon">üéÅ</div>
                 <div class="stat-number" id="totalCards">0</div>
                 <div class="stat-label" id="totalCardsLabel">Cards Generated</div>
             </div>
         </div>

         <!-- CONTACT CATEGORIES -->
         <h3 style="color: #FFD700; margin-bottom: 20px;" id="contactCategoriesTitle">üì± Contact Categories</h3>
         <div class="contact-categories">
             <div class="category-card" onclick="filterContacts('telegram')">
                 <div class="category-icon">üì±</div>
                 <div class="category-name">Telegram</div>
                 <div class="category-count" id="telegramCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('whatsapp')">
                 <div class="category-icon">üí¨</div>
                 <div class="category-name">WhatsApp</div>
                 <div class="category-count" id="whatsappCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('email')">
                 <div class="category-icon">üìß</div>
                 <div class="category-name">Email</div>
                 <div class="category-count" id="emailCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('instagram')">
                 <div class="category-icon">üì∑</div>
                 <div class="category-name">Instagram</div>
                 <div class="category-count" id="instagramCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('viber')">
                 <div class="category-icon">üíú</div>
                 <div class="category-name">Viber</div>
                 <div class="category-count" id="viberCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('facebook')">
                 <div class="category-icon">üë§</div>
                 <div class="category-name">Facebook</div>
                 <div class="category-count" id="facebookCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('tiktok')">
                 <div class="category-icon">üéµ</div>
                 <div class="category-name">TikTok</div>
                 <div class="category-count" id="tiktokCount">0</div>
             </div>
             <div class="category-card" onclick="filterContacts('twitter')">
                 <div class="category-icon">üê¶</div>
                 <div class="category-name">Twitter/X</div>
                 <div class="category-count" id="twitterCount">0</div>
             </div>
         </div>

         <!-- RECENT ACTIVITY -->
         <div class="referral-section">
             <h3 style="color: #FFD700; margin-bottom: 15px;" id="recentActivityTitle">üìà Recent Activity</h3>
             <div id="recentActivityList">
                 <div style="text-align: center; color: #CCC; padding: 20px;" id="noActivityText">
                     Connect your wallet to see activity
                 </div>
             </div>
         </div>
     </div>

     <!-- CONTACTS SECTION -->
     <div id="contacts" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="contactsTitle">üë• Contact Management</h1>
             <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="exportContacts()">
                 üì• <span id="exportBtn">Export All</span>
             </button>
         </div>

         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px;">
             <div id="contactsTable">
                 <div style="text-align: center; color: #CCC; padding: 40px;" id="noContactsText">
                     Connect wallet to manage contacts
                 </div>
             </div>
         </div>
     </div>

     <!-- REFERRALS SECTION -->
     <div id="referrals" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="referralsTitle">üîó Referral Network</h1>
             <div style="color: #CCC;" id="networkStatus">Network Status: Disconnected</div>
         </div>

         <div class="referral-section">
             <div style="text-align: center; color: #CCC; padding: 40px;">
                 Connect wallet to view referral network
             </div>
         </div>
     </div>

     <!-- CRM SECTION -->
     <div id="crm" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="crmTitle">üí¨ CRM & Internal Chat</h1>
         </div>

         <div class="referral-section">
             <div style="text-align: center; color: #CCC; padding: 40px;">
                 Connect wallet to access CRM features
             </div>
         </div>
     </div>

     <!-- CO-AUTHORS SECTION -->
     <div id="coauthors" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="coauthorsTitle">üëë Co-Authors Management</h1>
         </div>

         <div class="coauthors-section">
             <div style="text-align: center; color: #CCC; padding: 40px;">
                 Connect wallet to manage co-authors
             </div>
         </div>
     </div>

     <!-- MAILINGS SECTION -->
     <div id="mailings" class="content-section">
         <div class="development-placeholder">
             <div class="development-icon">üöß</div>
             <div class="development-title" id="mailingsDevTitle">Mass Mailings System</div>
             <div class="development-text" id="mailingsDevText">
                 Advanced mailing system is currently in development.<br>
                 This section will include:<br><br>
                 ‚Ä¢ Multi-platform messaging (Telegram, WhatsApp, Email)<br>
                 ‚Ä¢ Template management<br>
                 ‚Ä¢ Scheduling and automation<br>
                 ‚Ä¢ Delivery analytics<br>
                 ‚Ä¢ Anti-spam protection
             </div>
         </div>
     </div>

     <!-- ANALYTICS SECTION -->
     <div id="analytics" class="content-section">
         <div class="development-placeholder">
             <div class="development-icon">üìä</div>
             <div class="development-title" id="analyticsDevTitle">Advanced Analytics</div>
             <div class="development-text" id="analyticsDevText">
                 Comprehensive analytics dashboard is in development.<br>
                 Features coming soon:<br><br>
                 ‚Ä¢ Real-time statistics<br>
                 ‚Ä¢ Contact growth charts<br>
                 ‚Ä¢ Conversion tracking<br>
                 ‚Ä¢ Revenue analytics<br>
                 ‚Ä¢ Performance reports
             </div>
         </div>
     </div>

     <!-- WALLET SECTION -->
     <div id="wallet" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="walletTitle">üíé Web3 Wallet</h1>
             <div style="color: #CCC;" id="walletNetwork">Network: opBNB Mainnet</div>
         </div>

         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 30px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;" id="walletConnectionTitle">üîó Blockchain Connection</h3>
             
             <button id="connectWalletBtn" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 12px; padding: 15px 30px; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s ease; margin-bottom: 15px;" onclick="connectWallet()">
                 <span id="connectWalletText">üîê Connect SafePal Wallet</span>
             </button>
             
             <div id="walletStatus" style="background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50; border-radius: 10px; padding: 15px; text-align: center; display: none;">
                 <div style="font-weight: bold; margin-bottom: 10px;" id="walletConnectedText">‚úÖ SafePal Connected</div>
                 <div id="walletAddress" style="color: #4CAF50; margin-bottom: 5px;"></div>
                 <div id="walletBalance" style="color: #CCC; font-size: 14px;"></div>
             </div>

             <!-- SMART CONTRACT INFO -->
             <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px; margin-top: 20px;">
                 <h4 style="color: #FFD700; margin-bottom: 10px;" id="contractInfoTitle">üìÑ Smart Contract Info</h4>
                 <div style="color: #CCC; font-size: 14px;">
                     <div><strong id="contractStatusLabel">Status:</strong> <span style="color: #4CAF50;" id="contractStatus">Active</span></div>
                     <div><strong id="contractNetworkLabel">Network:</strong> opBNB Mainnet</div>
                     <div><strong id="contractAddressLabel">Address:</strong> <span style="word-break: break-all;" id="contractAddress">0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618</span></div>
                 </div>
             </div>
         </div>
     </div>

     <!-- SETTINGS SECTION -->
     <div id="settings" class="content-section">
         <div class="section-header">
             <h1 class="section-title" id="settingsTitle">‚öôÔ∏è Settings</h1>
         </div>

         <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px;">
             <h3 style="color: #FFD700; margin-bottom: 15px;" id="languageSettingsTitle">üåç Language Settings</h3>
             <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                 <button class="lang-btn active" onclick="switchLanguage('en')" style="padding: 10px 20px; border-radius: 8px;">
                     üá∫üá∏ English
                 </button>
                 <button class="lang-btn" onclick="switchLanguage('ru')" style="padding: 10px 20px; border-radius: 8px;">
                     üá∑üá∫ –†—É—Å—Å–∫–∏–π
                 </button>
                 <button class="lang-btn" onclick="switchLanguage('ua')" style="padding: 10px 20px; border-radius: 8px;">
                     üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
                 </button>
             </div>
         </div>
     </div>
 </div>

 <script>
      // ==================== –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø WEB3 –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ====================
      const CONTRACT_CONFIG = {
          address: '0xBb8A0c28A91f8D6B6c4175c0D497164dFC846618',
          network: 'opBNB',
          chainId: 204,
          rpcUrl: 'https://opbnb-mainnet-rpc.bnbchain.org',
          // –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π ABI –¥–ª—è –±–∞–∑–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
          abi: [
              {
                  "inputs": [{"name": "user", "type": "address"}],
                  "name": "getUserLevel",
                  "outputs": [{"name": "", "type": "uint256"}],
                  "stateMutability": "view",
                  "type": "function"
              },
              {
                  "inputs": [],
                  "name": "activateUser",
                  "outputs": [],
                  "stateMutability": "payable",
                  "type": "function"
              },
              {
                  "inputs": [],
                  "name": "activateMiniAdmin",
                  "outputs": [],
                  "stateMutability": "payable",
                  "type": "function"
              },
              {
                  "inputs": [],
                  "name": "activateSuperAdmin",
                  "outputs": [],
                  "stateMutability": "payable",
                  "type": "function"
              },
              {
                  "inputs": [{"name": "referrerId", "type": "string"}],
                  "name": "registerUser",
                  "outputs": [{"name": "", "type": "string"}],
                  "stateMutability": "nonpayable",
                  "type": "function"
              }
          ]
      };

      // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
      let currentLanguage = 'en';
      let currentSection = 'dashboard';
      let web3;
      let contract;
      let userWalletAddress = null;
      let isWeb3Connected = false;
      let connectedWallet = null;
      let currentUser = {
          userId: 'NOT_CONNECTED',
          level: 0,
          isActive: false,
          walletAddress: null
      };
      let walletConnected = false;
      let contactsData = {};
      let referralData = {};
      let currentCRMUser = null;

      // ==================== –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø WEB3 –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
      async function initWeb3() {
          try {
              console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Web3...');
              
              // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
              let provider = null;
              let walletType = '';
              
              if (window.safepal && window.safepal.ethereum) {
                  provider = window.safepal.ethereum;
                  walletType = 'SafePal';
                  console.log('üü¢ SafePal –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
              } else if (window.ethereum) {
                  provider = window.ethereum;
                  walletType = 'MetaMask/Generic';
                  console.log('üü° –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Web3 –ø—Ä–æ–≤–∞–π–¥–µ—Ä');
              } else {
                  console.warn('‚ùå Web3 –ø—Ä–æ–≤–∞–π–¥–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                  showInstallWalletPrompt();
                  return false;
              }
              
              // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Web3
              web3 = new Web3(provider);
              connectedWallet = walletType;
              
              // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç
              contract = new web3.eth.Contract(CONTRACT_CONFIG.abi, CONTRACT_CONFIG.address);
              
              console.log(`‚úÖ Web3 –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å ${walletType}`);
              
              // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
              const savedAddress = localStorage.getItem('connectedWallet');
              if (savedAddress) {
                  userWalletAddress = savedAddress;
                  isWeb3Connected = true;
                  await checkUserAccess();
                  console.log('üîÑ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:', savedAddress);
              }
              
              return true;
              
          } catch (error) {
              console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Web3:', error);
              return false;
          }
      }

      // ==================== –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê ====================
      async function connectWallet() {
          try {
              console.log('üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞...');
              
              if (!web3) {
                  const initResult = await initWeb3();
                  if (!initResult) {
                      throw new Error('Web3 –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                  }
              }
              
              const connectBtn = document.getElementById('connectWalletBtn');
              connectBtn.textContent = 'üîÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...';
              connectBtn.disabled = true;
              
              let accounts = [];
              
              // –ü–æ–ø—Ä–æ–±—É–µ–º SafePal API
              if (window.safepal && window.safepal.ethereum) {
                  try {
                      accounts = await window.safepal.ethereum.request({
                          method: 'eth_requestAccounts'
                      });
                      console.log('‚úÖ SafePal –ø–æ–¥–∫–ª—é—á–µ–Ω:', accounts);
                  } catch (safePalError) {
                      console.log('‚ö†Ô∏è SafePal API –æ—à–∏–±–∫–∞, –ø—Ä–æ–±—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥');
                      accounts = await window.ethereum.request({
                          method: 'eth_requestAccounts'
                      });
                  }
              } else if (window.ethereum) {
                  accounts = await window.ethereum.request({
                      method: 'eth_requestAccounts'
                  });
                  console.log('‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Web3 –ø–æ–¥–∫–ª—é—á–µ–Ω:', accounts);
              }
              
              if (accounts && accounts.length > 0) {
                  userWalletAddress = accounts[0].toLowerCase();
                  localStorage.setItem('connectedWallet', userWalletAddress);
                  isWeb3Connected = true;
                  
                  // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –í–ê–® –ì–õ–ê–í–ù–´–ô –ö–û–®–ï–õ–ï–ö
                  if (userWalletAddress === '0x0099188030174e381e7a7ee36d2783ecc31b6728') {
                      console.log('üî• –¶–ï–ù–¢–†–ê–õ–¨–ù–´–ô –û–°–ù–û–í–ê–¢–ï–õ–¨ –ü–û–î–ö–õ–Æ–ß–ï–ù!');
                      currentUser = {
                          userId: 'FOUNDER_001',
                          level: 4,
                          isActive: true,
                          walletAddress: userWalletAddress
                      };
                      showNotification('üî• –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –û—Å–Ω–æ–≤–∞—Ç–µ–ª—å!', 'success');
                  } else {
                      await checkUserAccess();
                  }
                  
                  updateUserInterface();
                  showWalletConnected(userWalletAddress);
                  showNotification(`–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω: ${connectedWallet}`, 'success');
              } else {
                  throw new Error('–ê–∫–∫–∞—É–Ω—Ç—ã –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã');
              }
              
          } catch (error) {
              console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞:', error);
              showNotification(`–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`, 'error');
              
              const connectBtn = document.getElementById('connectWalletBtn');
              connectBtn.textContent = 'üîê –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫';
              connectBtn.disabled = false;
          }
      }

      // ==================== –£–ü–†–û–©–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ====================
      async function checkUserAccess() {
          if (!userWalletAddress) return;
          
          try {
              console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è:', userWalletAddress);
              
              // ‚úÖ –ü–†–û–í–ï–†–Ø–ï–ú –û–°–ù–û–í–ê–¢–ï–õ–ï–ô –ü–ï–†–í–´–ú –î–ï–õ–û–ú
              const founders = [
                  '0x0099188030174e381e7a7ee36d2783ecc31b6728', // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
                  '0xab17adbe29c4e1d695c239206682b02ebdb3f707',
                  '0xb5986b808dad481ad86d63df152cc0ad7b473e48',
                  '0xa3496cacc8523421dd151f1d92a456c2dafa28c2',
                  '0x8af1bc6b4a5aaced37889cc06bed4569a6b64044',
                  '0x0ab97e3934b1afc9f1f6447ccf676e4f1d8b9639',
                  '0x03284a899147f5a07f82c622f34df92198671635',
                  '0xb0e256ca055937a8fd9ca1f5e3d8a6bd44146d50'
              ];
              
              if (founders.includes(userWalletAddress.toLowerCase())) {
                  console.log('üî• –û–°–ù–û–í–ê–¢–ï–õ–¨ –û–ë–ù–ê–†–£–ñ–ï–ù - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø!');
                  currentUser = {
                      userId: `FOUNDER_${userWalletAddress.substring(2, 8).toUpperCase()}`,
                      level: 4,
                      isActive: true,
                      walletAddress: userWalletAddress
                  };
                  return;
              }
              
              // –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
              try {
                  // –°–æ–∑–¥–∞–µ–º –ø—Ä—è–º–æ–π HTTP –∑–∞–ø—Ä–æ—Å –∫ RPC (–æ–±—Ö–æ–¥ –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º)
                  const response = await fetch(CONTRACT_CONFIG.rpcUrl, {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify({
                          jsonrpc: '2.0',
                          method: 'eth_call',
                          params: [{
                              to: CONTRACT_CONFIG.address,
                              data: web3.eth.abi.encodeFunctionCall({
                                  name: 'getUserLevel',
                                  type: 'function',
                                  inputs: [{'name': 'user', 'type': 'address'}]
                              }, [userWalletAddress])
                          }, 'latest'],
                          id: 1
                      })
                  });
                  
                  const result = await response.json();
                  if (result.result) {
                      const level = parseInt(result.result, 16);
                      console.log('üìä –£—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:', level);
                      
                      currentUser = {
                          userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                          level: level,
                          isActive: level > 0,
                          walletAddress: userWalletAddress
                      };
                  } else {
                      throw new Error('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ');
                  }
              } catch (contractError) {
                  console.warn('‚ö†Ô∏è –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:', contractError);
                  // Fallback - –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                  currentUser = {
                      userId: `CG${userWalletAddress.substring(2, 8).toUpperCase()}`,
                      level: 0,
                      isActive: false,
                      walletAddress: userWalletAddress
                  };
              }
              
          } catch (error) {
              console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞:', error);
              currentUser = {
                  userId: 'ERROR',
                  level: 0,
                  isActive: false,
                  walletAddress: userWalletAddress
              };
          }
      }

      // ==================== –ü–û–ö–ê–ó –û–ü–¶–ò–ô –ê–ö–¢–ò–í–ê–¶–ò–ò ====================
      function showActivationOptions() {
          const connectionStatus = document.getElementById('connectionStatus');
          if (connectionStatus) {
              connectionStatus.innerHTML = `
                  <div style="color: #FFA500; font-size: 18px; margin-bottom: 15px;">‚ö° –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CardGift</div>
                  
                  <button onclick="registerNewUser()" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold; margin-bottom: 15px; width: 100%;">
                      üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                  </button>
                  
                  <div style="color: #CCC; margin-bottom: 15px;">–ò–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é:</div>
                  
                  <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                      <button onclick="activateUser(1)" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          üë§ –ë–∞–∑–æ–≤—ã–π<br><small>0.0025 BNB</small>
                      </button>
                      <button onclick="activateUser(2)" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          ‚ö° –ú–∏–Ω–∏-–ê–¥–º–∏–Ω<br><small>0.05 BNB</small>
                      </button>
                      <button onclick="activateUser(3)" style="background: linear-gradient(45deg, #9C27B0, #7B1FA2); color: white; border: none; border-radius: 10px; padding: 12px 20px; cursor: pointer; font-weight: bold;">
                          üöÄ –°—É–ø–µ—Ä-–ê–¥–º–∏–Ω<br><small>0.25 BNB</small>
                      </button>
                  </div>
              `;
          }
      }

      // ==================== –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø ====================
      async function activateUser(level) {
          try {
              showNotification('–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏...', 'info');
              
              if (!web3 || !userWalletAddress) {
                  throw new Error('–ö–æ—à–µ–ª–µ–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω');
              }
              
              let txData;
              let value;
              
              switch(level) {
                  case 1:
                      value = web3.utils.toWei('0.0025', 'ether');
                      txData = contract.methods.activateUser().encodeABI();
                      break;
                  case 2:
                      value = web3.utils.toWei('0.05', 'ether');
                      txData = contract.methods.activateMiniAdmin().encodeABI();
                      break;
                  case 3:
                      value = web3.utils.toWei('0.25', 'ether');
                      txData = contract.methods.activateSuperAdmin().encodeABI();
                      break;
                  default:
                      throw new Error('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å');
              }
              
              // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä
              const provider = window.safepal?.ethereum || window.ethereum;
              
              const txHash = await provider.request({
                  method: 'eth_sendTransaction',
                  params: [{
                      from: userWalletAddress,
                      to: CONTRACT_CONFIG.address,
                      value: web3.utils.toHex(value),
                      data: txData,
                      gas: web3.utils.toHex(300000)
                  }]
              });
              
              console.log('‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞:', txHash);
              showNotification(`–ê–∫—Ç–∏–≤–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è ${level} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! TX: ${txHash.substring(0, 10)}...`, 'success');
              
              // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
              setTimeout(async () => {
                  await checkUserAccess();
                  updateUserInterface();
              }, 3000);
              
          } catch (error) {
              console.error('‚ùå –û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:', error);
              showNotification(`–û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: ${error.message}`, 'error');
          }
      }

      // ==================== –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø ====================
      async function registerNewUser(referrerId = '') {
          try {
              showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...', 'info');
              
              if (!web3 || !userWalletAddress) {
                  throw new Error('–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫');
              }
              
              const txData = contract.methods.registerUser(referrerId).encodeABI();
              const provider = window.safepal?.ethereum || window.ethereum;
              
              const txHash = await provider.request({
                  method: 'eth_sendTransaction',
                  params: [{
                      from: userWalletAddress,
                      to: CONTRACT_CONFIG.address,
                      data: txData,
                      gas: web3.utils.toHex(300000)
                  }]
              });
              
              console.log('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞:', txHash);
              showNotification(`–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! TX: ${txHash.substring(0, 10)}...`, 'success');
              
              setTimeout(async () => {
                  await checkUserAccess();
                  updateUserInterface();
              }, 3000);
              
          } catch (error) {
              console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
              showNotification(`–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${error.message}`, 'error');
          }
      }

      // ==================== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê ====================
      function updateUserInterface() {
          const levelNames = {
              0: '–ù–ï –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–ù',
              1: '–ë–ê–ó–û–í–´–ô –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨', 
              2: '–ú–ò–ù–ò –ê–î–ú–ò–ù',
              3: '–°–£–ü–ï–† –ê–î–ú–ò–ù',
              4: '–û–°–ù–û–í–ê–¢–ï–õ–¨'
          };
          
          document.getElementById('userLevel').textContent = levelNames[currentUser.level] || '–ù–ï–ò–ó–í–ï–°–¢–ù–û';
          document.getElementById('currentUserId').textContent = currentUser.userId || '–ù–µ –ø–æ–¥–∫–ª—é—á–µ–Ω';
          
          if (userWalletAddress) {
              const shortAddress = `${userWalletAddress.substring(0, 6)}...${userWalletAddress.substring(userWalletAddress.length - 4)}`;
              document.getElementById('currentUserId').textContent = `${currentUser.userId} (${shortAddress})`;
              
              // –°–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
              const connectionStatus = document.getElementById('connectionStatus');
              if (connectionStatus && currentUser.level > 0) {
                  connectionStatus.style.display = 'none';
              } else if (connectionStatus && currentUser.level === 0) {
                  showActivationOptions();
              }
              
              document.getElementById('networkStatus').textContent = 'Network Status: –ü–æ–¥–∫–ª—é—á–µ–Ω';
          }
          
          updateMenuAccess();
      }

      function updateMenuAccess() {
          const menuItems = document.querySelectorAll('.menu-item');
          
          menuItems.forEach(item => {
              const section = item.getAttribute('data-section');
              
              // –û—Å–Ω–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É
              if (currentUser.level >= 4) {
                  item.classList.remove('locked');
                  return;
              }
              
              // –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
              if (currentUser.level === 0) {
                  if (section !== 'wallet' && section !== 'dashboard') {
                      item.classList.add('locked');
                  }
              } else if (currentUser.level >= 1) {
                  if (['dashboard', 'contacts', 'wallet'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
              
              if (currentUser.level >= 2) {
                  if (['referrals', 'crm'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
              
              if (currentUser.level >= 3) {
                  if (['mailings', 'analytics', 'coauthors'].includes(section)) {
                      item.classList.remove('locked');
                  }
              }
          });
      }

      function showWalletConnected(address) {
          const connectBtn = document.getElementById('connectWalletBtn');
          const walletStatus = document.getElementById('walletStatus');
          
          if (connectBtn) connectBtn.style.display = 'none';
          if (walletStatus) walletStatus.style.display = 'block';
          
          document.getElementById('walletAddress').textContent = 
              `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
          
          const walletConnectedText = document.getElementById('walletConnectedText');
          if (walletConnectedText) {
              walletConnectedText.textContent = `‚úÖ ${connectedWallet} –ø–æ–¥–∫–ª—é—á–µ–Ω`;
          }
          
          walletConnected = true;
      }

      function showInstallWalletPrompt() {
          const connectBtn = document.getElementById('connectWalletBtn');
          if (connectBtn) {
              connectBtn.innerHTML = 'üì± –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SafePal';
              connectBtn.onclick = () => {
                  window.open('https://safepal.io/download', '_blank');
              };
          }
      }

      // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
      window.onload = async function() {
          console.log('üöÄ CardGift Web3 Dashboard –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
          
          await initWeb3();
          
          if (!referralData || !referralData.levels) {
              referralData = {
                  levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] }
              };
          }
          
          updateUserInterface();
          loadDashboardData();
          updateTime();
          
          console.log('‚úÖ Web3 Dashboard –≥–æ—Ç–æ–≤');
      };

      // ==================== –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô) ====================
      function showSection(sectionId) {
          document.querySelectorAll('.content-section').forEach(section => {
              section.classList.remove('active');
          });
          
          document.getElementById(sectionId).classList.add('active');
          
          document.querySelectorAll('.menu-item').forEach(item => {
              item.classList.remove('active');
          });
          
          document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
          
          currentSection = sectionId;
          
          if (window.innerWidth <= 768) {
              toggleSidebar();
          }
      }

      function toggleSidebar() {
          const sidebar = document.getElementById('sidebar');
          const mainContent = document.getElementById('mainContent');
          
          sidebar.classList.toggle('mobile-visible');
          sidebar.classList.toggle('mobile-hidden');
          
          if (sidebar.classList.contains('mobile-visible')) {
              mainContent.classList.add('full-width');
          } else {
              mainContent.classList.remove('full-width');
          }
      }

      function switchLanguage(lang) {
          currentLanguage = lang;
          localStorage.setItem('adminLanguage', lang);
          
          document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
          document.getElementById(`lang${lang.charAt(0).toUpperCase() + lang.slice(1)}`).classList.add('active');
      }

      function loadDashboardData() {
          const storedContacts = localStorage.getItem('allContacts');
          if (storedContacts) {
              contactsData = JSON.parse(storedContacts);
          } else {
              contactsData = {
                  telegram: [],
                  whatsapp: [],
                  email: [],
                  instagram: [],
                  viber: [],
                  facebook: [],
                  tiktok: [],
                  twitter: []
              };
          }
          
          updateDashboardStats();
      }

      function updateDashboardStats() {
          let totalContacts = 0;
          Object.keys(contactsData).forEach(category => {
              const count = contactsData[category].length;
              totalContacts += count;
              
              const counterElement = document.getElementById(category + 'Count');
              if (counterElement) {
                  counterElement.textContent = count;
              }
          });
          
          document.getElementById('totalContacts').textContent = totalContacts;
          
          const cardsData = localStorage.getItem('userCards');
          let totalCards = 0;
          if (cardsData) {
              const cardsObject = JSON.parse(cardsData);
              Object.keys(cardsObject).forEach(userId => {
                  totalCards += cardsObject[userId].length;
              });
          }
          document.getElementById('totalCards').textContent = totalCards;
          
          let totalReferrals = 0;
          if (referralData && referralData.levels) {
              Object.values(referralData.levels).forEach(level => {
                  totalReferrals += level.length;
              });
          }
          document.getElementById('totalReferrals').textContent = totalReferrals;
          
          updateTime();
      }

      function updateTime() {
          const now = new Date();
          const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
          const updateTimeElement = document.getElementById('updateTime');
          if (updateTimeElement) {
              updateTimeElement.textContent = timeString;
          }
      }

      function filterContacts(category) {
          showSection('contacts');
      }

      function exportContacts() {
          if (currentUser.level === 0) {
              showNotification('–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'error');
              return;
          }
          
          const dataStr = JSON.stringify(contactsData, null, 2);
          const dataBlob = new Blob([dataStr], {type: 'application/json'});
          const url = URL.createObjectURL(dataBlob);
          
          const link = document.createElement('a');
          link.href = url;
          link.download = `cardgift-contacts-${new Date().toISOString().split('T')[0]}.json`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          showNotification('–ö–æ–Ω—Ç–∞–∫—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã!', 'success');
      }

      function closeCRMModal() {
          document.getElementById('crmModal').classList.remove('show');
          currentCRMUser = null;
      }

      function switchCRMTab(tabName) {
          document.querySelectorAll('.crm-tab').forEach(tab => {
              tab.classList.remove('active');
          });
          document.getElementById(`${tabName}Tab`).classList.add('active');
          
          document.querySelectorAll('.crm-content').forEach(content => {
              content.classList.remove('active');
          });
          document.getElementById(`${tabName}Content`).classList.add('active');
      }

      function saveUserNotes() {
          if (!currentCRMUser) return;
          
          const notes = document.getElementById('userNotes').value;
          localStorage.setItem(`crm_notes_${currentCRMUser}`, notes);
          
          showNotification('–ó–∞–º–µ—Ç–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!', 'success');
      }

      function sendMessage() {
          showNotification('–ß–∞—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞', 'info');
      }

      function openSocialContact() {
          showNotification('–°–æ—Ü. –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–∞', 'info');
      }

      function showNotification(message, type = 'info', duration = 3000) {
          const existingNotification = document.querySelector('.notification');
          if (existingNotification) {
              existingNotification.remove();
          }
          
          const notification = document.createElement('div');
          notification.className = 'notification';
          notification.textContent = message;
          
          notification.style.cssText = `
              position: fixed;
              bottom: 20px;
              right: 20px;
              background: rgba(0, 0, 0, 0.95);
              color: white;
              padding: 15px 25px;
              border-radius: 10px;
              z-index: 10000;
              opacity: 0;
              transform: translateY(100%);
              transition: all 0.3s ease;
              border: 1px solid #333;
              max-width: 400px;
              word-wrap: break-word;
              font-weight: 500;
              backdrop-filter: blur(10px);
          `;
          
          if (type === 'success') {
              notification.style.borderColor = '#4CAF50';
              notification.style.background = 'rgba(76, 175, 80, 0.2)';
              notification.style.color = '#4CAF50';
          } else if (type === 'error') {
              notification.style.borderColor = '#f44336';
              notification.style.background = 'rgba(244, 67, 54, 0.2)';
              notification.style.color = '#f44336';
          } else if (type === 'info') {
              notification.style.borderColor = '#2196F3';
              notification.style.background = 'rgba(33, 150, 243, 0.2)';
              notification.style.color = '#2196F3';
          }
          
          document.body.appendChild(notification);
          
          setTimeout(() => {
              notification.style.opacity = '1';
              notification.style.transform = 'translateY(0)';
          }, 100);
          
          setTimeout(() => {
              notification.style.opacity = '0';
              notification.style.transform = 'translateY(100%)';
              setTimeout(() => {
                  if (notification.parentNode) {
                      notification.parentNode.removeChild(notification);
                  }
              }, 300);
          }, duration);
      }

      // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
      setInterval(() => {
          updateTime();
          
          if (currentSection === 'dashboard') {
              updateDashboardStats();
          }
      }, 30000);

      // –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
     window.addEventListener('resize', () => {
         if (window.innerWidth > 768) {
             const sidebar = document.getElementById('sidebar');
             const mainContent = document.getElementById('mainContent');
             
             sidebar.classList.remove('mobile-visible', 'mobile-hidden');
             mainContent.classList.remove('full-width');
         }
     });

     // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
     window.addEventListener('click', function(event) {
         const crmModal = document.getElementById('crmModal');
         if (event.target === crmModal) {
             closeCRMModal();
         }
     });

     document.addEventListener('keydown', function(event) {
         if (event.key === 'Escape') {
             closeCRMModal();
         }
     });

     // ==================== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô –ö–û–®–ï–õ–¨–ö–ê ====================
     // –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
     document.addEventListener('DOMContentLoaded', async () => {
         try {
             const provider = window.safepal?.ethereum || window.ethereum;
             
             if (provider) {
                 const accounts = await provider.request({
                     method: 'eth_accounts'
                 });
                 
                 if (accounts.length > 0) {
                     console.log('üîÑ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:', accounts[0]);
                     userWalletAddress = accounts[0].toLowerCase();
                     localStorage.setItem('connectedWallet', userWalletAddress);
                     isWeb3Connected = true;
                     await checkUserAccess();
                     updateUserInterface();
                     console.log('‚úÖ –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ');
                 }
             }
         } catch (error) {
             console.log('‚ÑπÔ∏è –ê–≤—Ç–æ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ:', error);
         }
     });

     // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ—à–µ–ª—å–∫–∞
     if (window.safepal && window.safepal.ethereum) {
         window.safepal.ethereum.on('accountsChanged', (accounts) => {
             console.log('üîÑ SafePal –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
             if (accounts.length === 0) {
                 userWalletAddress = null;
                 isWeb3Connected = false;
                 currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                 localStorage.removeItem('connectedWallet');
                 updateUserInterface();
                 showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
             } else {
                 userWalletAddress = accounts[0].toLowerCase();
                 localStorage.setItem('connectedWallet', userWalletAddress);
                 checkUserAccess().then(() => updateUserInterface());
             }
         });
         
         window.safepal.ethereum.on('chainChanged', (chainId) => {
             console.log('üîÑ SafePal —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
             if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                 showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
             }
             setTimeout(() => window.location.reload(), 1000);
         });
     } else if (window.ethereum) {
         window.ethereum.on('accountsChanged', (accounts) => {
             console.log('üîÑ Ethereum –∞–∫–∫–∞—É–Ω—Ç—ã –∏–∑–º–µ–Ω–µ–Ω—ã:', accounts);
             if (accounts.length === 0) {
                 userWalletAddress = null;
                 isWeb3Connected = false;
                 currentUser = { userId: 'NOT_CONNECTED', level: 0, isActive: false, walletAddress: null };
                 localStorage.removeItem('connectedWallet');
                 updateUserInterface();
                 showNotification('–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω', 'info');
             } else {
                 userWalletAddress = accounts[0].toLowerCase();
                 localStorage.setItem('connectedWallet', userWalletAddress);
                 checkUserAccess().then(() => updateUserInterface());
             }
         });
         
         window.ethereum.on('chainChanged', (chainId) => {
             console.log('üîÑ Ethereum —Å–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∞:', chainId);
             if (parseInt(chainId, 16) !== CONTRACT_CONFIG.chainId) {
                 showNotification('–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ opBNB —Å–µ—Ç—å', 'warning');
             }
             setTimeout(() => window.location.reload(), 1000);
         });
     }

     // ==================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–¢–ò–õ–ò–¢–´ ====================
     
     // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏ opBNB
     async function ensureOpBNBNetwork() {
         try {
             const provider = window.safepal?.ethereum || window.ethereum;
             if (!provider) return false;
             
             const chainId = await provider.request({ method: 'eth_chainId' });
             const currentChainId = parseInt(chainId, 16);
             
             if (currentChainId !== CONTRACT_CONFIG.chainId) {
                 console.log('üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ opBNB...');
                 
                 try {
                     await provider.request({
                         method: 'wallet_switchEthereumChain',
                         params: [{ chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId) }]
                     });
                     console.log('‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–æ –Ω–∞ opBNB');
                     return true;
                 } catch (switchError) {
                     if (switchError.code === 4902) {
                         // –°–µ—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –¥–æ–±–∞–≤–ª—è–µ–º
                         await provider.request({
                             method: 'wallet_addEthereumChain',
                             params: [{
                                 chainId: web3.utils.toHex(CONTRACT_CONFIG.chainId),
                                 chainName: 'opBNB Mainnet',
                                 nativeCurrency: {
                                     name: 'BNB',
                                     symbol: 'BNB',
                                     decimals: 18
                                 },
                                 rpcUrls: [CONTRACT_CONFIG.rpcUrl],
                                 blockExplorerUrls: ['https://opbnbscan.com/']
                             }]
                         });
                         console.log('‚úÖ opBNB —Å–µ—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞');
                         return true;
                     }
                     throw switchError;
                 }
             }
             
             return true;
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é:', error);
             showNotification('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ opBNB', 'error');
             return false;
         }
     }

     // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
     async function getWalletBalance() {
         try {
             if (!web3 || !userWalletAddress) return '0';
             
             const balance = await web3.eth.getBalance(userWalletAddress);
             return web3.utils.fromWei(balance, 'ether');
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
             return '0';
         }
     }

     // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
     async function updateWalletBalance() {
         try {
             const balance = await getWalletBalance();
             const balanceElement = document.getElementById('walletBalance');
             if (balanceElement) {
                 balanceElement.textContent = `Balance: ${parseFloat(balance).toFixed(4)} BNB`;
             }
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
         }
     }

     // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
     async function checkTransactionStatus(txHash) {
         try {
             if (!web3) return null;
             
             const receipt = await web3.eth.getTransactionReceipt(txHash);
             return receipt;
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:', error);
             return null;
         }
     }

     // –í–∞–ª–∏–¥–∞—Ü–∏—è –∞–¥—Ä–µ—Å–∞
     function isValidAddress(address) {
         try {
             return web3.utils.isAddress(address);
         } catch (error) {
             return false;
         }
     }

     // –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
     function shortenAddress(address, chars = 4) {
         if (!address) return '';
         return `${address.substring(0, chars + 2)}...${address.substring(address.length - chars)}`;
     }

     // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
     async function copyToClipboard(text) {
         try {
             await navigator.clipboard.writeText(text);
             showNotification('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞', 'success', 1500);
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è:', error);
             showNotification('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
         }
     }

     // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞
     function formatNumber(num, decimals = 4) {
         if (isNaN(num)) return '0';
         return parseFloat(num).toFixed(decimals);
     }

     // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
     function isMobile() {
         return window.innerWidth <= 768;
     }

     // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
     function logEvent(eventName, data = {}) {
         const timestamp = new Date().toISOString();
         console.log(`üìä [${timestamp}] ${eventName}:`, data);
         
         // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
         const logs = JSON.parse(localStorage.getItem('dashboardLogs') || '[]');
         logs.push({
             timestamp,
             event: eventName,
             data,
             userAgent: navigator.userAgent,
             wallet: connectedWallet,
             userLevel: currentUser.level
         });
         
         // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 –∑–∞–ø–∏—Å–µ–π
         if (logs.length > 100) {
             logs.splice(0, logs.length - 100);
         }
         
         localStorage.setItem('dashboardLogs', JSON.stringify(logs));
     }

     // –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
     function clearAllData() {
         if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ dashboard? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')) {
             localStorage.clear();
             sessionStorage.clear();
             showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
             setTimeout(() => window.location.reload(), 1000);
         }
     }

     // –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
     function exportLogs() {
         try {
             const logs = localStorage.getItem('dashboardLogs') || '[]';
             const blob = new Blob([logs], { type: 'application/json' });
             const url = URL.createObjectURL(blob);
             
             const link = document.createElement('a');
             link.href = url;
             link.download = `cardgift-dashboard-logs-${new Date().toISOString().split('T')[0]}.json`;
             document.body.appendChild(link);
             link.click();
             document.body.removeChild(link);
             
             URL.revokeObjectURL(url);
             showNotification('–õ–æ–≥–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
         } catch (error) {
             console.error('‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤:', error);
             showNotification('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤', 'error');
         }
     }

     // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
     window.cardGiftDebug = {
         clearData: clearAllData,
         exportLogs: exportLogs,
         checkUser: checkUserAccess,
         updateUI: updateUserInterface,
         getBalance: getWalletBalance,
         ensureNetwork: ensureOpBNBNetwork,
         currentUser: () => currentUser,
         contractConfig: CONTRACT_CONFIG
     };

     console.log('üéâ CardGift Web3 Dashboard –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
     console.log('üí° –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: window.cardGiftDebug');
     
     // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
     logEvent('dashboard_initialized', {
         userAgent: navigator.userAgent,
         screenSize: `${window.innerWidth}x${window.innerHeight}`,
         timestamp: new Date().toISOString()
     });

</script>
</body>
</html>
