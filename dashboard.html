<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   <title id="pageTitle">CardGift - Admin Dashboard</title>
   
   <!-- PWA Meta tags -->
   <meta name="description" content="CardGift Admin Dashboard - Manage your network">
   <meta name="theme-color" content="#FFD700">
   
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }

       body {
           font-family: 'Arial', sans-serif;
           background: linear-gradient(135deg, #000000 0%, #1a1a1a 50%, #000000 100%);
           color: #FFFFFF;
           overflow-x: hidden;
           min-height: 100vh;
       }

       /* Золотые частицы фона */
       body::before {
           content: '';
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                       radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%);
           pointer-events: none;
           z-index: -1;
       }

       /* ЯЗЫКОВОЙ ПЕРЕКЛЮЧАТЕЛЬ */
       .language-switcher {
           position: fixed;
           top: 15px;
           right: 15px;
           z-index: 1000;
           display: flex;
           background: rgba(0, 0, 0, 0.9);
           border-radius: 15px;
           padding: 4px;
           backdrop-filter: blur(10px);
           border: 1px solid rgba(255, 215, 0, 0.3);
       }

       .lang-btn {
           background: transparent;
           border: none;
           color: #FFD700;
           padding: 6px 12px;
           border-radius: 10px;
           cursor: pointer;
           font-size: 12px;
           font-weight: bold;
           transition: all 0.3s ease;
           min-width: 35px;
       }

       .lang-btn.active {
           background: rgba(255, 215, 0, 0.3);
           color: #FFF;
       }

       /* SIDEBAR */
       .sidebar {
           position: fixed;
           left: 0;
           top: 0;
           width: 280px;
           height: 100vh;
           background: rgba(0, 0, 0, 0.95);
           backdrop-filter: blur(20px);
           border-right: 2px solid #FFD700;
           z-index: 100;
           overflow-y: auto;
           transition: transform 0.3s ease;
       }

       .sidebar.mobile-hidden {
           transform: translateX(-100%);
       }

       .sidebar-header {
           padding: 25px 20px;
           text-align: center;
           border-bottom: 1px solid rgba(255, 215, 0, 0.3);
       }

       .logo {
           font-size: 28px;
           background: linear-gradient(45deg, #FFD700, #FFA500);
           -webkit-background-clip: text;
           -webkit-text-fill-color: transparent;
           background-clip: text;
           font-weight: bold;
           margin-bottom: 8px;
       }

       .user-info {
           background: rgba(255, 215, 0, 0.1);
           border-radius: 10px;
           padding: 15px;
           margin-top: 15px;
       }

       .user-level {
           background: #FFD700;
           color: #000;
           padding: 4px 10px;
           border-radius: 15px;
           font-size: 11px;
           font-weight: bold;
           display: inline-block;
           margin-bottom: 8px;
       }

       .user-id {
           color: #CCC;
           font-size: 12px;
       }

       /* NOTIFICATION BADGE */
       .notification-badge {
           position: absolute;
           top: -8px;
           right: -8px;
           background: #FF4444;
           color: white;
           border-radius: 50%;
           width: 20px;
           height: 20px;
           font-size: 10px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           animation: pulse 2s infinite;
       }

       .notification-badge.read {
           background: #4CAF50;
           animation: none;
       }

       .notification-badge.hidden {
           display: none;
       }

       @keyframes pulse {
           0% { transform: scale(1); }
           50% { transform: scale(1.1); }
           100% { transform: scale(1); }
       }

       /* MENU */
       .sidebar-menu {
           padding: 20px 0;
       }

       .menu-item {
           display: flex;
           align-items: center;
           padding: 15px 25px;
           color: #CCC;
           text-decoration: none;
           transition: all 0.3s ease;
           border-left: 3px solid transparent;
           cursor: pointer;
           position: relative;
       }

       .menu-item:hover {
           background: rgba(255, 215, 0, 0.1);
           color: #FFF;
       }

       .menu-item.active {
           background: rgba(255, 215, 0, 0.2);
           border-left-color: #FFD700;
           color: #FFD700;
       }

       .menu-item.locked {
           opacity: 0.4;
           cursor: not-allowed;
           position: relative;
       }

       .menu-item.locked::after {
           content: "🔒";
           position: absolute;
           right: 25px;
           font-size: 16px;
       }

       .menu-icon {
           width: 24px;
           margin-right: 15px;
           text-align: center;
           font-size: 18px;
       }

       /* MAIN CONTENT */
       .main-content {
           margin-left: 280px;
           padding: 30px;
           min-height: 100vh;
           transition: margin-left 0.3s ease;
       }

       .main-content.full-width {
           margin-left: 0;
       }

       /* MOBILE TOGGLE */
       .mobile-toggle {
           display: none;
           position: fixed;
           top: 15px;
           left: 15px;
           z-index: 1001;
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 10px;
           padding: 10px;
           cursor: pointer;
           color: #FFD700;
       }

       /* SECTION */
       .content-section {
           display: none;
           animation: fadeInUp 0.5s ease;
       }

       .content-section.active {
           display: block;
       }

       .section-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 30px;
           flex-wrap: wrap;
       }

       .section-title {
           font-size: 28px;
           color: #FFD700;
           font-weight: bold;
       }

       /* STATS CARDS */
       .stats-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin-bottom: 30px;
       }

       .stat-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid #FFD700;
           border-radius: 15px;
           padding: 20px;
           text-align: center;
           transition: transform 0.3s ease;
       }

       .stat-card:hover {
           transform: translateY(-5px);
       }

       .stat-icon {
           font-size: 32px;
           margin-bottom: 10px;
       }

       .stat-number {
           font-size: 24px;
           font-weight: bold;
           color: #FFD700;
           margin-bottom: 5px;
       }

       .stat-label {
           color: #CCC;
           font-size: 14px;
       }

       /* CONTACT CATEGORIES */
       .contact-categories {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 15px;
           margin-bottom: 30px;
       }

       .category-card {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 12px;
           padding: 15px;
           text-align: center;
           transition: all 0.3s ease;
           cursor: pointer;
       }

       .category-card:hover {
           border-color: #FFD700;
           background: rgba(255, 215, 0, 0.05);
       }

       .category-icon {
           font-size: 24px;
           margin-bottom: 8px;
       }

       .category-name {
           font-weight: bold;
           margin-bottom: 5px;
       }

       .category-count {
           color: #FFD700;
           font-size: 18px;
           font-weight: bold;
       }

       /* REFERRAL SYSTEM */
       .referral-section {
           background: rgba(0, 0, 0, 0.9);
           border: 1px solid rgba(255, 215, 0, 0.3);
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       /* LEVEL BUTTONS */
       .level-buttons {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
           flex-wrap: wrap;
           justify-content: center;
       }

       .level-btn {
           background: rgba(255, 215, 0, 0.1);
           border: 2px solid #FFD700;
           color: #FFD700;
           border-radius: 50%;
           width: 50px;
           height: 50px;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: bold;
           cursor: pointer;
           transition: all 0.3s ease;
           position: relative;
       }

       .level-btn:hover {
           background: rgba(255, 215, 0, 0.2);
           transform: scale(1.1);
       }

       .level-btn.active {
           background: #FFD700;
           color: #000;
       }

       .level-btn.locked {
           opacity: 0.3;
           cursor: not-allowed;
       }

       .level-btn.locked::after {
           content: "🔒";
           position: absolute;
           top: -5px;
           right: -5px;
           font-size: 12px;
       }

       /* LEVEL CONTENT */
       .level-content {
           background: rgba(255, 255, 255, 0.05);
           border-radius: 10px;
           padding: 20px;
           margin-top: 20px;
           display: none;
       }

       .level-content.active {
           display: block;
       }

       .level-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 15px;
           flex-wrap: wrap;
       }

       .level-title {
           color: #FFD700;
           font-weight: bold;
           font-size: 18px;
       }

       .level-count {
           background: rgba(255, 215, 0, 0.2);
           color: #FFD700;
           padding: 4px 12px;
           border-radius: 15px;
           font-size: 12px;
           font-weight: bold;
       }

       /* TEAM TABLE */
       .team-table {
           overflow-x: auto;
       }

       .team-table table {
           width: 100%;
           border-collapse: collapse;
       }

       .team-table th {
           background: rgba(255, 215, 0, 0.1);
           color: #FFD700;
           padding: 12px 8px;
           text-align: left;
           border-bottom: 2px solid #FFD700;
           font-size: 14px;
       }

       .team-table td {
           padding: 10px 8px;
           border-bottom: 1px solid rgba(255, 215, 0, 0.2);
           color: #FFF;
           font-size: 13px;
       }

       .team-table tr:hover {
           background: rgba(255, 215, 0, 0.05);
       }

       .user-id-cell {
           color: #4CAF50;
           font-weight: bold;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .user-id-cell:hover {
           color: #FFD700;
       }

       .wallet-status {
           padding: 2px 6px;
           border-radius: 10px;
           font-size: 10px;
           font-weight: bold;
       }

       .wallet-active {
           background: rgba(76, 175, 80, 0.3);
           color: #4CAF50;
       }

       .wallet-inactive {
           background: rgba(128, 128, 128, 0.3);
           color: #888;
       }

       .status-badge {
           padding: 3px 8px;
           border-radius: 12px;
           font-size: 10px;
           font-weight: bold;
       }

       .status-coauthor {
           background: rgba(139, 69, 19, 0.3);
           color: #D2691E;
       }

       .status-super {
           background: rgba(255, 215, 0, 0.3);
           color: #FFD700;
       }

       .status-mini {
           background: rgba(255, 193, 7, 0.3);
           color: #FFC107;
       }

       .status-basic {
           background: rgba(128, 128, 128, 0.3);
           color: #CCC;
       }

       /* CRM MODAL */
       .crm-modal {
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.9);
           z-index: 2000;
           display: none;
           align-items: center;
           justify-content: center;
           padding: 20px;
       }

       .crm-modal.show {
           display: flex;
       }

       .crm-modal-content {
           background: rgba(0, 0, 0, 0.95);
           border: 2px solid #FFD700;
           border-radius: 15px;
           padding: 30px;
           max-width: 600px;
           width: 100%;
           max-height: 80vh;
           overflow-y: auto;
       }

       .crm-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 20px;
       }

       .crm-title {
           color: #FFD700;
           font-size: 20px;
           font-weight: bold;
       }

       .close-btn {
           background: none;
           border: none;
           color: #CCC;
           font-size: 24px;
           cursor: pointer;
           transition: color 0.3s ease;
       }

       .close-btn:hover {
           color: #FFD700;
       }

       .crm-tabs {
           display: flex;
           gap: 10px;
           margin-bottom: 20px;
       }

       .crm-tab {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           padding: 8px 16px;
           border-radius: 8px;
           cursor: pointer;
           transition: all 0.3s ease;
       }

       .crm-tab.active {
           background: #FFD700;
           color: #000;
       }

       .crm-content {
           display: none;
       }

       .crm-content.active {
           display: block;
       }

       .notes-textarea {
           width: 100%;
           min-height: 150px;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 15px;
           color: #FFF;
           resize: vertical;
       }

       .notes-textarea:focus {
           outline: none;
           border-color: #FFA500;
       }

       .save-btn {
           background: linear-gradient(45deg, #4CAF50, #45a049);
           color: white;
           border: none;
           border-radius: 8px;
           padding: 10px 20px;
           cursor: pointer;
           margin-top: 10px;
           transition: all 0.3s ease;
       }

       .save-btn:hover {
           transform: translateY(-2px);
       }

       /* CHAT SECTION */
       .chat-container {
           border: 1px solid #FFD700;
           border-radius: 8px;
           height: 300px;
           display: flex;
           flex-direction: column;
       }

       .chat-messages {
           flex: 1;
           padding: 15px;
           overflow-y: auto;
           background: rgba(255, 255, 255, 0.05);
       }

       .chat-input-area {
           padding: 10px;
           border-top: 1px solid #FFD700;
           display: flex;
           gap: 10px;
       }

       .chat-input {
           flex: 1;
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           border-radius: 8px;
           padding: 8px 12px;
           color: #FFF;
       }

       .send-btn {
           background: #FFD700;
           color: #000;
           border: none;
           border-radius: 8px;
           padding: 8px 16px;
           cursor: pointer;
           font-weight: bold;
       }

       /* CO-AUTHORS MANAGEMENT */
       .coauthors-section {
           background: rgba(139, 69, 19, 0.1);
           border: 2px solid #D2691E;
           border-radius: 15px;
           padding: 25px;
           margin-bottom: 30px;
       }

       .add-coauthor-btn {
           background: linear-gradient(45deg, #D2691E, #A0522D);
           color: white;
           border: none;
           border-radius: 10px;
           padding: 12px 25px;
           cursor: pointer;
           font-weight: bold;
           transition: all 0.3s ease;
       }

       .add-coauthor-btn:hover {
           transform: translateY(-2px);
           box-shadow: 0 4px 8px rgba(210, 105, 30, 0.3);
       }

       .coauthor-item {
           display: flex;
           justify-content: space-between;
           align-items: center;
           padding: 15px;
           background: rgba(139, 69, 19, 0.1);
           border-radius: 10px;
           margin-bottom: 10px;
       }

       .coauthor-info {
           color: #D2691E;
           font-weight: bold;
       }

       .coauthor-actions {
           display: flex;
           gap: 10px;
       }

       .action-btn {
           background: rgba(255, 255, 255, 0.1);
           border: 1px solid #FFD700;
           color: #FFD700;
           border-radius: 5px;
           padding: 5px 10px;
           cursor: pointer;
           transition: all 0.3s ease;
       }

       .action-btn:hover {
           background: rgba(255, 215, 0, 0.2);
       }

       .action-btn.danger {
           border-color: #FF4444;
           color: #FF4444;
       }

       .action-btn.danger:hover {
           background: rgba(255, 68, 68, 0.2);
       }

       /* DEVELOPMENT PLACEHOLDER */
       .development-placeholder {
           background: rgba(255, 165, 0, 0.1);
           border: 2px dashed #FFA500;
           border-radius: 15px;
           padding: 50px;
           text-align: center;
           margin: 30px 0;
       }

       .development-icon {
           font-size: 64px;
           margin-bottom: 20px;
       }

       .development-title {
           color: #FFA500;
           font-size: 24px;
           font-weight: bold;
           margin-bottom: 15px;
       }

       .development-text {
           color: #CCC;
           line-height: 1.6;
       }

       /* RESPONSIVE */
       @media (max-width: 768px) {
           .sidebar {
               transform: translateX(-100%);
           }

           .sidebar.mobile-visible {
               transform: translateX(0);
           }

           .main-content {
               margin-left: 0;
               padding: 20px;
               padding-top: 70px;
           }

           .mobile-toggle {
               display: block;
           }

           .stats-grid {
               grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
               gap: 15px;
           }

           .contact-categories {
               grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
           }

           .section-header {
               flex-direction: column;
               align-items: flex-start;
               gap: 15px;
           }

           .language-switcher {
               top: 75px;
               right: 10px;
           }

           .level-buttons {
               gap: 5px;
           }

           .level-btn {
               width: 40px;
               height: 40px;
               font-size: 14px;
           }

           .crm-modal-content {
               padding: 20px;
               margin: 10px;
           }

           .team-table {
               font-size: 12px;
           }

           .team-table th,
           .team-table td {
               padding: 8px 4px;
           }
       }

       @keyframes fadeInUp {
           from {
               opacity: 0;
               transform: translateY(30px);
           }
           to {
               opacity: 1;
               transform: translateY(0);
           }
       }
   </style>
</head>
<body>
   <!-- ЯЗЫКОВОЙ ПЕРЕКЛЮЧАТЕЛЬ -->
   <div class="language-switcher">
       <button class="lang-btn active" onclick="switchLanguage('en')" id="langEn">EN</button>
       <button class="lang-btn" onclick="switchLanguage('ru')" id="langRu">RU</button>
       <button class="lang-btn" onclick="switchLanguage('ua')" id="langUa">UA</button>
   </div>

   <!-- MOBILE TOGGLE -->
   <div class="mobile-toggle" onclick="toggleSidebar()">
       <span style="font-size: 20px;">☰</span>
   </div>

   <!-- SIDEBAR -->
   <div class="sidebar" id="sidebar">
       <div class="sidebar-header">
           <div class="logo">🎁 CardGift</div>
           <div class="user-info">
               <div class="user-level" id="userLevel">MASTER ADMIN</div>
               <div class="user-id" id="userIdDisplay">ID: <span id="currentUserId">CG000001</span></div>
           </div>
       </div>
       
       <nav class="sidebar-menu">
           <div class="menu-item active" onclick="showSection('dashboard')" data-section="dashboard">
               <div class="menu-icon">📊</div>
               <span id="menuDashboard">Dashboard</span>
           </div>
           <div class="menu-item" onclick="showSection('contacts')" data-section="contacts">
               <div class="menu-icon">👥</div>
               <span id="menuContacts">Contacts</span>
           </div>
           <div class="menu-item" onclick="showSection('referrals')" data-section="referrals">
               <div class="menu-icon">🔗</div>
               <span id="menuReferrals">Referral System</span>
               <div class="notification-badge hidden" id="referralNotifications">0</div>
           </div>
           <div class="menu-item" onclick="showSection('crm')" data-section="crm">
               <div class="menu-icon">💬</div>
               <span id="menuCRM">CRM & Chat</span>
               <div class="notification-badge hidden" id="crmNotifications">0</div>
           </div>
           <div class="menu-item" onclick="showSection('coauthors')" data-section="coauthors" id="coauthorsMenuItem">
               <div class="menu-icon">👑</div>
               <span id="menuCoauthors">Co-Authors</span>
           </div>
           <div class="menu-item" onclick="showSection('mailings')" data-section="mailings">
               <div class="menu-icon">📢</div>
               <span id="menuMailings">Mass Mailings</span>
           </div>
           <div class="menu-item" onclick="showSection('analytics')" data-section="analytics">
               <div class="menu-icon">📈</div>
               <span id="menuAnalytics">Advanced Analytics</span>
           </div>
           <div class="menu-item" onclick="showSection('wallet')" data-section="wallet">
               <div class="menu-icon">💎</div>
               <span id="menuWallet">Web3 Wallet</span>
           </div>
           <div class="menu-item" onclick="showSection('settings')" data-section="settings">
               <div class="menu-icon">⚙️</div>
               <span id="menuSettings">Settings</span>
           </div>
       </nav>
   </div>

   <!-- CRM MODAL -->
   <div class="crm-modal" id="crmModal">
       <div class="crm-modal-content">
           <div class="crm-header">
               <div class="crm-title" id="crmModalTitle">User CRM</div>
               <button class="close-btn" onclick="closeCRMModal()">×</button>
           </div>
           
           <div class="crm-tabs">
               <button class="crm-tab active" onclick="switchCRMTab('notes')" id="notesTab">📝 Notes</button>
               <button class="crm-tab" onclick="switchCRMTab('chat')" id="chatTab">💬 Chat</button>
               <button class="crm-tab" onclick="switchCRMTab('social')" id="socialTab">📱 Social</button>
           </div>
           
           <div class="crm-content active" id="notesContent">
               <textarea class="notes-textarea" id="userNotes" placeholder="Write your notes about this user..."></textarea>
               <button class="save-btn" onclick="saveUserNotes()">💾 Save Notes</button>
           </div>
           
           <div class="crm-content" id="chatContent">
               <div class="chat-container">
                   <div class="chat-messages" id="chatMessages">
                       <div style="text-align: center; color: #CCC; padding: 20px;">
                           No messages yet. Start a conversation!
                       </div>
                   </div>
                   <div class="chat-input-area">
                       <input type="text" class="chat-input" id="chatInput" placeholder="Type your message...">
                       <button class="send-btn" onclick="sendMessage()">Send</button>
                   </div>
               </div>
           </div>
           
           <div class="crm-content" id="socialContent">
               <div style="color: #CCC; line-height: 1.6;">
                   <h4 style="color: #FFD700; margin-bottom: 10px;">Contact Information:</h4>
                   <div id="userSocialInfo">
                       <p><strong>Platform:</strong> <span id="userPlatform">-</span></p>
                       <p><strong>Contact:</strong> <span id="userContact">-</span></p>
                       <p><strong>Registration Date:</strong> <span id="userRegDate">-</span></p>
                   </div>
                   <button style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer; margin-top: 15px;" onclick="openSocialContact()">
                       📱 Open in Social Media
                   </button>
               </div>
           </div>
       </div>
   </div>

   <!-- MAIN CONTENT -->
   <div class="main-content" id="mainContent">
       
       <!-- DASHBOARD SECTION -->
      <div id="dashboard" class="content-section active">
          <div class="section-header">
              <h1 class="section-title" id="dashboardTitle">📊 Master Dashboard</h1>
              <div style="color: #CCC; font-size: 14px;" id="lastUpdate">Last update: <span id="updateTime">--:--</span></div>
          </div>

          <!-- MAIN STATS -->
          <div class="stats-grid">
              <div class="stat-card">
                  <div class="stat-icon">👥</div>
                  <div class="stat-number" id="totalContacts">0</div>
                  <div class="stat-label" id="totalContactsLabel">Total Contacts</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">🔗</div>
                  <div class="stat-number" id="totalReferrals">9</div>
                  <div class="stat-label" id="totalReferralsLabel">Active Referrals</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">💎</div>
                  <div class="stat-number" id="totalEarnings">0.000</div>
                  <div class="stat-label" id="totalEarningsLabel">Earnings (opBNB)</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">🎁</div>
                  <div class="stat-number" id="totalCards">0</div>
                  <div class="stat-label" id="totalCardsLabel">Cards Generated</div>
              </div>
          </div>

          <!-- CONTACT CATEGORIES -->
          <h3 style="color: #FFD700; margin-bottom: 20px;" id="contactCategoriesTitle">📱 Contact Categories</h3>
          <div class="contact-categories">
              <div class="category-card" onclick="filterContacts('telegram')">
                  <div class="category-icon">📱</div>
                  <div class="category-name">Telegram</div>
                  <div class="category-count" id="telegramCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('whatsapp')">
                  <div class="category-icon">💬</div>
                  <div class="category-name">WhatsApp</div>
                  <div class="category-count" id="whatsappCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('email')">
                  <div class="category-icon">📧</div>
                  <div class="category-name">Email</div>
                  <div class="category-count" id="emailCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('instagram')">
                  <div class="category-icon">📷</div>
                  <div class="category-name">Instagram</div>
                  <div class="category-count" id="instagramCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('viber')">
                  <div class="category-icon">💜</div>
                  <div class="category-name">Viber</div>
                  <div class="category-count" id="viberCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('facebook')">
                  <div class="category-icon">👤</div>
                  <div class="category-name">Facebook</div>
                  <div class="category-count" id="facebookCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('tiktok')">
                  <div class="category-icon">🎵</div>
                  <div class="category-name">TikTok</div>
                  <div class="category-count" id="tiktokCount">0</div>
              </div>
              <div class="category-card" onclick="filterContacts('twitter')">
                  <div class="category-icon">🐦</div>
                  <div class="category-name">Twitter/X</div>
                  <div class="category-count" id="twitterCount">0</div>
              </div>
          </div>

          <!-- RECENT ACTIVITY -->
          <div class="referral-section">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="recentActivityTitle">📈 Recent Activity</h3>
              <div id="recentActivityList">
                  <div style="text-align: center; color: #CCC; padding: 20px;" id="noActivityText">
                      No recent activity. Start collecting contacts!
                  </div>
              </div>
          </div>
      </div>

      <!-- CONTACTS SECTION -->
      <div id="contacts" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="contactsTitle">👥 Contact Management</h1>
              <button style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="exportContacts()">
                  📥 <span id="exportBtn">Export All</span>
              </button>
          </div>

          <!-- CONTACT FILTERS -->
          <div style="margin-bottom: 20px;">
              <select id="contactFilter" style="background: #333; color: #FFF; border: 1px solid #FFD700; border-radius: 8px; padding: 10px; margin-right: 15px;">
                  <option value="all" id="filterAll">All Categories</option>
                  <option value="telegram">📱 Telegram</option>
                  <option value="whatsapp">💬 WhatsApp</option>
                  <option value="email">📧 Email</option>
                  <option value="instagram">📷 Instagram</option>
                  <option value="viber">💜 Viber</option>
                  <option value="facebook">👤 Facebook</option>
                  <option value="tiktok">🎵 TikTok</option>
                  <option value="twitter">🐦 Twitter/X</option>
              </select>
              <input type="text" id="contactSearch" placeholder="Search contacts..." style="background: #333; color: #FFF; border: 1px solid #FFD700; border-radius: 8px; padding: 10px; width: 250px;">
          </div>

          <!-- CONTACTS TABLE -->
          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 20px;">
              <div id="contactsTable">
                  <div style="text-align: center; color: #CCC; padding: 40px;" id="noContactsText">
                      No contacts found. Start collecting contacts through your generator!
                  </div>
              </div>
          </div>
      </div>

      <!-- REFERRALS SECTION -->
      <div id="referrals" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="referralsTitle">🔗 Referral Network</h1>
              <div style="color: #CCC;" id="networkStatus">Network Status: Active</div>
          </div>

          <!-- LEVEL BUTTONS -->
          <div class="referral-section">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="selectLevelTitle">Select Level to View</h3>
              <div class="level-buttons" id="levelButtons">
                  <button class="level-btn" onclick="showLevel(1)" data-level="1">1</button>
                  <button class="level-btn" onclick="showLevel(2)" data-level="2">2</button>
                  <button class="level-btn" onclick="showLevel(3)" data-level="3">3</button>
                  <button class="level-btn" onclick="showLevel(4)" data-level="4">4</button>
                  <button class="level-btn" onclick="showLevel(5)" data-level="5">5</button>
                  <button class="level-btn" onclick="showLevel(6)" data-level="6">6</button>
                  <button class="level-btn" onclick="showLevel(7)" data-level="7">7</button>
                  <button class="level-btn" onclick="showLevel(8)" data-level="8">8</button>
                  <button class="level-btn" onclick="showLevel(9)" data-level="9">9</button>
              </div>
              
              <!-- LEVEL CONTENT -->
              <div class="level-content" id="levelContent">
                  <div class="level-header">
                      <div class="level-title" id="currentLevelTitle">Select a level to view team members</div>
                      <div class="level-count" id="currentLevelCount">0</div>
                  </div>
                  
                  <div class="team-table" id="teamTable">
                      <div style="text-align: center; color: #CCC; padding: 40px;">
                          Click on a level button above to view team members
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- CRM SECTION -->
      <div id="crm" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="crmTitle">💬 CRM & Internal Chat</h1>
              <button style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 10px; padding: 10px 20px; cursor: pointer;" onclick="startNewChat()">
                  ➕ <span id="newChatBtn">New Chat</span>
              </button>
          </div>

          <div class="referral-section">
              <input type="text" style="width: 100%; background: rgba(255, 255, 255, 0.1); border: 1px solid #FFD700; border-radius: 10px; padding: 12px; color: #FFF; margin-bottom: 20px;" id="userSearch" placeholder="Search user by ID or name...">
              
              <div id="userList">
                  <div style="text-align: center; color: #CCC; padding: 30px;" id="noChatUsersText">
                      No users available for chat. Users will appear here after registration.
                  </div>
              </div>
          </div>
      </div>

      <!-- CO-AUTHORS SECTION -->
      <div id="coauthors" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="coauthorsTitle">👑 Co-Authors Management</h1>
              <button class="add-coauthor-btn" onclick="addCoauthor()">
                  ➕ <span id="addCoauthorBtn">Add Co-Author</span>
              </button>
          </div>

          <div class="coauthors-section">
              <h3 style="color: #D2691E; margin-bottom: 15px;" id="coauthorsListTitle">Current Co-Authors</h3>
              <div id="coauthorsList">
                  <div style="text-align: center; color: #CCC; padding: 30px;" id="noCoauthorsText">
                      No co-authors added yet. You can add up to 8+ co-authors.
                  </div>
              </div>
          </div>
      </div>

      <!-- MAILINGS SECTION -->
      <div id="mailings" class="content-section">
          <div class="development-placeholder">
              <div class="development-icon">🚧</div>
              <div class="development-title" id="mailingsDevTitle">Mass Mailings System</div>
              <div class="development-text" id="mailingsDevText">
                  Advanced mailing system is currently in development.<br>
                  This section will include:<br><br>
                  • Multi-platform messaging (Telegram, WhatsApp, Email)<br>
                  • Template management<br>
                  • Scheduling and automation<br>
                  • Delivery analytics<br>
                  • Anti-spam protection
              </div>
          </div>
      </div>

      <!-- ANALYTICS SECTION -->
      <div id="analytics" class="content-section">
          <div class="development-placeholder">
              <div class="development-icon">📊</div>
              <div class="development-title" id="analyticsDevTitle">Advanced Analytics</div>
              <div class="development-text" id="analyticsDevText">
                  Comprehensive analytics dashboard is in development.<br>
                  Features coming soon:<br><br>
                  • Real-time statistics<br>
                  • Contact growth charts<br>
                  • Conversion tracking<br>
                  • Revenue analytics<br>
                  • Performance reports
              </div>
          </div>
      </div>

      <!-- WALLET SECTION -->
      <div id="wallet" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="walletTitle">💎 Web3 Wallet</h1>
              <div style="color: #CCC;" id="walletNetwork">Network: opBNB Testnet</div>
          </div>

          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 30px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="walletConnectionTitle">🔗 Blockchain Connection</h3>
              
              <button id="connectWalletBtn" style="background: linear-gradient(45deg, #1E88E5, #1565C0); color: white; border: none; border-radius: 12px; padding: 15px 30px; font-weight: bold; cursor: pointer; width: 100%; transition: all 0.3s ease; margin-bottom: 15px;" onclick="connectWallet()">
                  <span id="connectWalletText">🔗 Connect SafePal Wallet</span>
              </button>
              
              <div id="walletStatus" style="background: rgba(76, 175, 80, 0.1); border: 1px solid #4CAF50; border-radius: 10px; padding: 15px; text-align: center; display: none;">
                  <div style="font-weight: bold; margin-bottom: 10px;" id="walletConnectedText">✅ Wallet Connected</div>
                  <div id="walletAddress" style="color: #4CAF50; margin-bottom: 5px;"></div>
                  <div id="walletBalance" style="color: #CCC; font-size: 14px;"></div>
              </div>

              <!-- SMART CONTRACT INFO -->
              <div style="background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px; margin-top: 20px;">
                  <h4 style="color: #FFD700; margin-bottom: 10px;" id="contractInfoTitle">📄 Smart Contract Info</h4>
                  <div style="color: #CCC; font-size: 14px;">
                      <div><strong id="contractStatusLabel">Status:</strong> <span style="color: #4CAF50;" id="contractStatus">Active</span></div>
                      <div><strong id="contractNetworkLabel">Network:</strong> opBNB Testnet</div>
                      <div><strong id="contractAddressLabel">Address:</strong> <span style="word-break: break-all;" id="contractAddress">Loading...</span></div>
                  </div>
              </div>

              <!-- TRANSACTION HISTORY -->
              <div style="margin-top: 30px;">
                  <h3 style="color: #FFD700; margin-bottom: 15px;" id="transactionHistoryTitle">📋 Recent Transactions</h3>
                  <div id="transactionList" style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 10px; padding: 20px;">
                      <div style="text-align: center; color: #CCC; padding: 20px;" id="noTransactionsText">
                          No transactions yet. Connect your wallet to see transaction history.
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- SETTINGS SECTION -->
      <div id="settings" class="content-section">
          <div class="section-header">
              <h1 class="section-title" id="settingsTitle">⚙️ Settings</h1>
          </div>

          <!-- LANGUAGE SETTINGS -->
          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 20px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="languageSettingsTitle">🌍 Language Settings</h3>
              <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                  <button class="lang-btn active" onclick="switchLanguage('en')" style="padding: 10px 20px; border-radius: 8px;">
                      🇺🇸 English
                  </button>
                  <button class="lang-btn" onclick="switchLanguage('ru')" style="padding: 10px 20px; border-radius: 8px;">
                      🇷🇺 Русский
                  </button>
                  <button class="lang-btn" onclick="switchLanguage('ua')" style="padding: 10px 20px; border-radius: 8px;">
                      🇺🇦 Українська
                  </button>
              </div>
          </div>

          <!-- ADMIN SETTINGS -->
          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 20px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="adminSettingsTitle">👑 Master Admin Settings</h3>
              
              <div style="margin-bottom: 15px;">
                  <label style="color: #CCC; margin-bottom: 5px; display: block;" id="autoBackupLabel">Auto Backup:</label>
                  <input type="checkbox" id="autoBackup" checked style="margin-right: 10px;">
                  <span style="color: #CCC;" id="autoBackupDesc">Automatically backup contact database</span>
              </div>
              
              <div style="margin-bottom: 15px;">
                  <label style="color: #CCC; margin-bottom: 5px; display: block;" id="notificationsLabel">System Notifications:</label>
                  <input type="checkbox" id="systemNotifications" checked style="margin-right: 10px;">
                  <span style="color: #CCC;" id="notificationsDesc">Receive notifications about new registrations</span>
              </div>
              
              <div style="margin-bottom: 15px;">
                  <label style="color: #CCC; margin-bottom: 5px; display: block;" id="darkModeLabel">Interface Mode:</label>
                  <select style="background: #333; color: #FFF; border: 1px solid #FFD700; border-radius: 8px; padding: 8px;">
                      <option value="dark" selected>🌙 Dark Mode</option>
                      <option value="light">☀️ Light Mode</option>
                  </select>
              </div>
          </div>

          <!-- DATA MANAGEMENT -->
          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px; margin-bottom: 20px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="dataManagementTitle">💾 Data Management</h3>
              
              <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                  <button style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer;" onclick="exportAllData()">
                      📥 <span id="exportAllBtn">Export All Data</span>
                  </button>
                  <button style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer;" onclick="importData()">
                      📤 <span id="importDataBtn">Import Data</span>
                  </button>
                  <button style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; border-radius: 8px; padding: 10px 20px; cursor: pointer;" onclick="clearCache()">
                      🧹 <span id="clearCacheBtn">Clear Cache</span>
                  </button>
              </div>
          </div>

          <!-- ABOUT SECTION -->
          <div style="background: rgba(0, 0, 0, 0.9); border: 1px solid rgba(255, 215, 0, 0.3); border-radius: 15px; padding: 25px;">
              <h3 style="color: #FFD700; margin-bottom: 15px;" id="aboutTitle">ℹ️ About CardGift</h3>
              <div style="color: #CCC; line-height: 1.6;">
                  <p style="margin-bottom: 10px;"><strong style="color: #FFD700;">Version:</strong> 1.0.0 Beta</p>
                  <p style="margin-bottom: 10px;"><strong style="color: #FFD700;">Build:</strong> <span id="buildNumber">20241201</span></p>
                  <p style="margin-bottom: 10px;"><strong style="color: #FFD700;">Network:</strong> opBNB Testnet</p>
                  <p style="margin-bottom: 15px;"><strong style="color: #FFD700;">License:</strong> Master Admin</p>
                  <p id="aboutDescription">CardGift - Advanced Web3 contact collection and management system with referral network integration.</p>
              </div>
          </div>
      </div>
  </div>

  <script>
      // ==================== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ====================
      let currentLanguage = 'en';
      let currentSection = 'dashboard';
      let currentUser = {
          userId: 'CG000001',
          level: 4, // MASTER ADMIN - ВСЕ ФУНКЦИИ АКТИВНЫ
          isActive: true
      };
      let walletConnected = false;
      let contactsData = {};
      let referralData = {};
      let currentLevel = 0;
      let currentCRMUser = null;
      let notifications = {
          referral: 0,
          crm: 0
      };

      // ==================== ПЕРЕВОДЫ ====================
const translations = {
    en: {
        pageTitle: "CardGift - Admin Dashboard",
        dashboardTitle: "📊 Master Dashboard",
        lastUpdate: "Last update:",
        totalContactsLabel: "Total Contacts",
        totalReferralsLabel: "Active Referrals", 
        totalEarningsLabel: "Earnings (opBNB)",
        totalCardsLabel: "Cards Generated",
        contactCategoriesTitle: "📱 Contact Categories",
        recentActivityTitle: "📈 Recent Activity",
        noActivityText: "No recent activity. Start collecting contacts!",
        contactsTitle: "👥 Contact Management",
        exportBtn: "Export All",
        filterAll: "All Categories",
        noContactsText: "No contacts found. Start collecting contacts through your generator!",
        referralsTitle: "🔗 Referral Network",
        networkStatus: "Network Status: Active",
        selectLevelTitle: "Select Level to View",
        crmTitle: "💬 CRM & Internal Chat",
        newChatBtn: "New Chat",
        noChatUsersText: "No users available for chat. Users will appear here after registration.",
        coauthorsTitle: "👑 Co-Authors Management",
        addCoauthorBtn: "Add Co-Author",
        coauthorsListTitle: "Current Co-Authors",
        noCoauthorsText: "No co-authors added yet. You can add up to 8+ co-authors.",
        mailingsDevTitle: "Mass Mailings System",
        mailingsDevText: "Advanced mailing system is currently in development.<br>This section will include:<br><br>• Multi-platform messaging (Telegram, WhatsApp, Email)<br>• Template management<br>• Scheduling and automation<br>• Delivery analytics<br>• Anti-spam protection",
        analyticsDevTitle: "Advanced Analytics",
        analyticsDevText: "Comprehensive analytics dashboard is in development.<br>Features coming soon:<br><br>• Real-time statistics<br>• Contact growth charts<br>• Conversion tracking<br>• Revenue analytics<br>• Performance reports",
        walletTitle: "💎 Web3 Wallet",
        walletNetwork: "Network: opBNB Testnet",
        walletConnectionTitle: "🔗 Blockchain Connection",
        connectWalletText: "🔗 Connect SafePal Wallet",
        walletConnectedText: "✅ Wallet Connected",
        contractInfoTitle: "📄 Smart Contract Info",
        contractStatusLabel: "Status:",
        contractStatus: "Active",
        contractNetworkLabel: "Network:",
        contractAddressLabel: "Address:",
        transactionHistoryTitle: "📋 Recent Transactions",
        noTransactionsText: "No transactions yet. Connect your wallet to see transaction history.",
        settingsTitle: "⚙️ Settings",
        languageSettingsTitle: "🌍 Language Settings",
        adminSettingsTitle: "👑 Master Admin Settings",
        autoBackupLabel: "Auto Backup:",
        autoBackupDesc: "Automatically backup contact database",
        notificationsLabel: "System Notifications:",
        notificationsDesc: "Receive notifications about new registrations",
        darkModeLabel: "Interface Mode:",
        dataManagementTitle: "💾 Data Management",
        exportAllBtn: "Export All Data",
        importDataBtn: "Import Data",
        clearCacheBtn: "Clear Cache",
        aboutTitle: "ℹ️ About CardGift",
        aboutDescription: "CardGift - Advanced Web3 contact collection and management system with referral network integration.",
        menuDashboard: "Dashboard",
        menuContacts: "Contacts",
        menuReferrals: "Referral System",
        menuCRM: "CRM & Chat",
        menuCoauthors: "Co-Authors",
        menuMailings: "Mass Mailings",
        menuAnalytics: "Advanced Analytics",
        menuWallet: "Web3 Wallet",
        menuSettings: "Settings"
    },
    ru: {
        pageTitle: "CardGift - Админ панель",
        dashboardTitle: "📊 Главная панель",
        lastUpdate: "Последнее обновление:",
        totalContactsLabel: "Всего контактов",
        totalReferralsLabel: "Активных рефералов",
        totalEarningsLabel: "Доходы (opBNB)",
        totalCardsLabel: "Создано открыток",
        contactCategoriesTitle: "📱 Категории контактов",
        recentActivityTitle: "📈 Последняя активность",
        noActivityText: "Нет недавней активности. Начните собирать контакты!",
        contactsTitle: "👥 Управление контактами",
        exportBtn: "Экспорт всех",
        filterAll: "Все категории",
        noContactsText: "Контакты не найдены. Начните собирать контакты через ваш генератор!",
        referralsTitle: "🔗 Реферальная сеть",
        networkStatus: "Статус сети: Активна",
        selectLevelTitle: "Выберите уровень для просмотра",
        crmTitle: "💬 CRM и внутренний чат",
        newChatBtn: "Новый чат",
        noChatUsersText: "Нет пользователей для чата. Пользователи появятся здесь после регистрации.",
        coauthorsTitle: "👑 Управление соавторами",
        addCoauthorBtn: "Добавить соавтора",
        coauthorsListTitle: "Текущие соавторы",
        noCoauthorsText: "Соавторы еще не добавлены. Вы можете добавить до 8+ соавторов.",
        mailingsDevTitle: "Система массовых рассылок",
        mailingsDevText: "Расширенная система рассылок находится в разработке.<br>Этот раздел будет включать:<br><br>• Многоплатформенные сообщения (Telegram, WhatsApp, Email)<br>• Управление шаблонами<br>• Планирование и автоматизация<br>• Аналитика доставки<br>• Защита от спама",
        analyticsDevTitle: "Расширенная аналитика",
        analyticsDevText: "Комплексная панель аналитики находится в разработке.<br>Функции скоро:<br><br>• Статистика в реальном времени<br>• Графики роста контактов<br>• Отслеживание конверсий<br>• Аналитика доходов<br>• Отчеты о производительности",
        walletTitle: "💎 Web3 кошелек",
        walletNetwork: "Сеть: opBNB Testnet",
        walletConnectionTitle: "🔗 Подключение к блокчейну",
        connectWalletText: "🔗 Подключить SafePal кошелек",
        walletConnectedText: "✅ Кошелек подключен",
        contractInfoTitle: "📄 Информация о смарт-контракте",
        contractStatusLabel: "Статус:",
        contractStatus: "Активен",
        contractNetworkLabel: "Сеть:",
        contractAddressLabel: "Адрес:",
        transactionHistoryTitle: "📋 Последние транзакции",
        noTransactionsText: "Пока нет транзакций. Подключите кошелек для просмотра истории транзакций.",
        settingsTitle: "⚙️ Настройки",
        languageSettingsTitle: "🌍 Языковые настройки",
        adminSettingsTitle: "👑 Настройки главного админа",
        autoBackupLabel: "Автоматическое резервное копирование:",
        autoBackupDesc: "Автоматически создавать резервные копии базы контактов",
        notificationsLabel: "Системные уведомления:",
        notificationsDesc: "Получать уведомления о новых регистрациях",
        darkModeLabel: "Режим интерфейса:",
        dataManagementTitle: "💾 Управление данными",
        exportAllBtn: "Экспорт всех данных",
        importDataBtn: "Импорт данных",
        clearCacheBtn: "Очистить кэш",
        aboutTitle: "ℹ️ О CardGift",
        aboutDescription: "CardGift - Продвинутая Web3 система сбора и управления контактами с интеграцией реферальной сети.",
        menuDashboard: "Дашборд",
        menuContacts: "Контакты",
        menuReferrals: "Реферальная система",
        menuCRM: "CRM и чат",
        menuCoauthors: "Соавторы",
        menuMailings: "Массовые рассылки",
        menuAnalytics: "Расширенная аналитика",
        menuWallet: "Web3 кошелек",
        menuSettings: "Настройки"
    },
    ua: {
        pageTitle: "CardGift - Адмін панель",
        dashboardTitle: "📊 Головна панель",
        lastUpdate: "Останнє оновлення:",
        totalContactsLabel: "Всього контактів",
        totalReferralsLabel: "Активних рефералів",
        totalEarningsLabel: "Доходи (opBNB)",
        totalCardsLabel: "Створено листівок",
        contactCategoriesTitle: "📱 Категорії контактів",
        recentActivityTitle: "📈 Остання активність",
        noActivityText: "Немає недавньої активності. Почніть збирати контакти!",
        contactsTitle: "👥 Управління контактами",
        exportBtn: "Експорт всіх",
        filterAll: "Всі категорії",
        noContactsText: "Контакти не знайдені. Почніть збирати контакти через ваш генератор!",
        referralsTitle: "🔗 Реферальна мережа",
        networkStatus: "Статус мережі: Активна",
        selectLevelTitle: "Виберіть рівень для перегляду",
        crmTitle: "💬 CRM та внутрішній чат",
        newChatBtn: "Новий чат",
        noChatUsersText: "Немає користувачів для чату. Користувачі з'являться тут після реєстрації.",
        coauthorsTitle: "👑 Управління співавторами",
        addCoauthorBtn: "Додати співавтора",
        coauthorsListTitle: "Поточні співавтори",
        noCoauthorsText: "Співавтори ще не додані. Ви можете додати до 8+ співавторів.",
        mailingsDevTitle: "Система масових розсилок",
        mailingsDevText: "Розширена система розсилок знаходиться в розробці.<br>Цей розділ включатиме:<br><br>• Багатоплатформені повідомлення (Telegram, WhatsApp, Email)<br>• Управління шаблонами<br>• Планування та автоматизація<br>• Аналітика доставки<br>• Захист від спаму",
        analyticsDevTitle: "Розширена аналітика",
        analyticsDevText: "Комплексна панель аналітики знаходиться в розробці.<br>Функції незабаром:<br><br>• Статистика в реальному часі<br>• Графіки зростання контактів<br>• Відстеження конверсій<br>• Аналітика доходів<br>• Звіти про продуктивність",
        walletTitle: "💎 Web3 гаманець",
        walletNetwork: "Мережа: opBNB Testnet",
        walletConnectionTitle: "🔗 Підключення до блокчейну",
        connectWalletText: "🔗 Підключити SafePal гаманець",
        walletConnectedText: "✅ Гаманець підключено",
        contractInfoTitle: "📄 Інформація про смарт-контракт",
        contractStatusLabel: "Статус:",
        contractStatus: "Активний",
        contractNetworkLabel: "Мережа:",
        contractAddressLabel: "Адреса:",
        transactionHistoryTitle: "📋 Останні транзакції",
        noTransactionsText: "Поки немає транзакцій. Підключіть гаманець для перегляду історії транзакцій.",
        settingsTitle: "⚙️ Налаштування",
        languageSettingsTitle: "🌍 Мовні налаштування",
        adminSettingsTitle: "👑 Налаштування головного адміна",
        autoBackupLabel: "Автоматичне резервне копіювання:",
        autoBackupDesc: "Автоматично створювати резервні копії бази контактів",
        notificationsLabel: "Системні сповіщення:",
        notificationsDesc: "Отримувати сповіщення про нові реєстрації",
        darkModeLabel: "Режим інтерфейсу:",
        dataManagementTitle: "💾 Управління даними",
        exportAllBtn: "Експорт всіх даних",
        importDataBtn: "Імпорт даних",
        clearCacheBtn: "Очистити кеш",
        aboutTitle: "ℹ️ Про CardGift",
        aboutDescription: "CardGift - Прогресивна Web3 система збору та управління контактами з інтеграцією реферальної мережі.",
        menuDashboard: "Дашборд",
        menuContacts: "Контакти",
        menuReferrals: "Реферальна система",
        menuCRM: "CRM та чат",
        menuCoauthors: "Співавтори",
        menuMailings: "Масові розсилки",
        menuAnalytics: "Розширена аналітика",
        menuWallet: "Web3 гаманець",
        menuSettings: "Налаштування"
    }
};

      // ==================== ИНИЦИАЛИЗАЦИЯ ====================
      window.onload = function() {
    console.log('🚀 CardGift Admin Dashboard initializing...');
    
    // ИСПРАВЛЕНИЕ - инициализируем данные
    if (!referralData || !referralData.levels) {
        referralData = {
            levels: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [], 8: [], 9: [] }
        };
    }
          
          // ПРИНУДИТЕЛЬНО УСТАНАВЛИВАЕМ МАСТЕР АДМИНА
          currentUser = {
              userId: 'CG000001',
              level: 4, // MASTER ADMIN
              isActive: true
          };
          localStorage.setItem('currentUser', JSON.stringify(currentUser));
          
          // Обновляем интерфейс
          document.getElementById('userLevel').textContent = 'MASTER ADMIN';
          document.getElementById('currentUserId').textContent = 'CG000001';
          
          loadDashboardData();
          loadReferralData();
          updateTime();
          updateNotifications();
          
          // РАЗБЛОКИРУЕМ ВСЕ КНОПКИ УРОВНЕЙ
          document.querySelectorAll('.level-btn').forEach(btn => {
              btn.classList.remove('locked');
              btn.style.opacity = '1';
              btn.style.cursor = 'pointer';
          });
          
          // РАЗБЛОКИРУЕМ ВСЕ ПУНКТЫ МЕНЮ
          document.querySelectorAll('.menu-item').forEach(item => {
              item.classList.remove('locked');
              item.style.opacity = '1';
              item.style.cursor = 'pointer';
          });
          
          console.log('✅ Admin Dashboard initialized as MASTER ADMIN');
          console.log('🔓 ALL FUNCTIONS UNLOCKED');
      };

      // ==================== НАВИГАЦИЯ ====================
      function showSection(sectionId) {
          // Скрываем все секции
          document.querySelectorAll('.content-section').forEach(section => {
              section.classList.remove('active');
          });
          
          // Показываем выбранную секцию
          document.getElementById(sectionId).classList.add('active');
          
          // Обновляем активное меню
          document.querySelectorAll('.menu-item').forEach(item => {
              item.classList.remove('active');
          });
          
          document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
          
          currentSection = sectionId;
          
          // Загружаем данные для секции
          loadSectionData(sectionId);
          
          // На мобильных закрываем сайдбар
          if (window.innerWidth <= 768) {
              toggleSidebar();
          }
      }

      function toggleSidebar() {
          const sidebar = document.getElementById('sidebar');
          const mainContent = document.getElementById('mainContent');
          
          sidebar.classList.toggle('mobile-visible');
          sidebar.classList.toggle('mobile-hidden');
          
          if (sidebar.classList.contains('mobile-visible')) {
              mainContent.classList.add('full-width');
          } else {
              mainContent.classList.remove('full-width');
          }
      }

      // ==================== ЯЗЫКОВЫЕ ФУНКЦИИ ====================
      function switchLanguage(lang) {
          currentLanguage = lang;
          localStorage.setItem('adminLanguage', lang);
          
          // Обновляем кнопки языков
          document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
          document.getElementById(`lang${lang.charAt(0).toUpperCase() + lang.slice(1)}`).classList.add('active');
          
          // Обновляем все тексты
          updateAllTexts();
      }

      function updateAllTexts() {
          const t = translations[currentLanguage] || translations.en;
          
          // Обновляем заголовок страницы
          document.getElementById('pageTitle').textContent = t.pageTitle;
          document.title = t.pageTitle;
          
          // Обновляем все элементы по ID
      Object.keys(t).forEach(key => {
          const element = document.getElementById(key);
          if (element) {
              if (element.tagName === 'INPUT') {
                  element.placeholder = t[key];
              } else {
                  element.textContent = t[key];
              }
          }
      });
      
      // Обновляем текст с HTML
      const mailingsDevText = document.getElementById('mailingsDevText');
      const analyticsDevText = document.getElementById('analyticsDevText');
      
      if (mailingsDevText) {
          mailingsDevText.innerHTML = t.mailingsDevText.replace(/\n/g, '<br>');
      }
      if (analyticsDevText) {
          analyticsDevText.innerHTML = t.analyticsDevText.replace(/\n/g, '<br>');
      }
  }

  // ==================== ЗАГРУЗКА ДАННЫХ ====================
  function loadDashboardData() {
      // Загружаем контакты из localStorage
      const storedContacts = localStorage.getItem('allContacts');
      if (storedContacts) {
          contactsData = JSON.parse(storedContacts);
      } else {
          contactsData = {
              telegram: [],
              whatsapp: [],
              email: [],
              instagram: [],
              viber: [],
              facebook: [],
              tiktok: [],
              twitter: []
          };
      }
      
      updateDashboardStats();
  }

  function loadReferralData() {
      // Создаем структуру для реферальных данных
      referralData = {
          levels: {
              1: [],
              2: [],
              3: [],
              4: [],
              5: [],
              6: [],
              7: [],
              8: [],
              9: []
          }
      };
      
      // Загружаем из localStorage если есть
      const storedReferrals = localStorage.getItem('referralData');
      if (storedReferrals) {
          referralData = {...referralData, ...JSON.parse(storedReferrals)};
      }
      
      // Добавляем тестовые данные для демонстрации (только если нет данных)
      if (!storedReferrals) {
          const testMembers = [
              {
                  userId: 'CG000002',
                  walletAddress: '0x1234567890abcdef1234567890abcdef12345678',
                  sponsorId: 'CG000001',
                  registrationDate: Date.now() - 86400000,
                  status: 'coauthor',
                  name: 'John Smith',
                  platform: 'telegram',
                  contact: '@johnsmith',
                  isActive: true
              },
              {
                  userId: 'CG000003',
                  walletAddress: null,
                  sponsorId: 'CG000001',
                  registrationDate: Date.now() - 172800000,
                  status: 'super',
                  name: 'Maria Garcia',
                  platform: 'whatsapp',
                  contact: '+1234567890',
                  isActive: false
              },
              {
                  userId: 'CG000004',
                  walletAddress: '0xabcdef1234567890abcdef1234567890abcdef12',
                  sponsorId: 'CG000002',
                  registrationDate: Date.now() - 259200000,
                  status: 'mini',
                  name: 'Alex Johnson',
                  platform: 'telegram',
                  contact: '@alexj',
                  isActive: true
              }
          ];
          
          referralData.levels[1] = [testMembers[0], testMembers[1]];
          referralData.levels[2] = [testMembers[2]];
          localStorage.setItem('referralData', JSON.stringify(referralData));
      }
  }

  function updateDashboardStats() {
      // Подсчитываем общее количество контактов
      let totalContacts = 0;
      Object.keys(contactsData).forEach(category => {
          const count = contactsData[category].length;
          totalContacts += count;
          
          // Обновляем счетчики категорий
          const counterElement = document.getElementById(category + 'Count');
          if (counterElement) {
              counterElement.textContent = count;
          }
      });
      
      // Обновляем общую статистику
      document.getElementById('totalContacts').textContent = totalContacts;
      
      // Загружаем статистику открыток
      const cardsData = localStorage.getItem('userCards');
      let totalCards = 0;
      if (cardsData) {
          const cardsObject = JSON.parse(cardsData);
          Object.keys(cardsObject).forEach(userId => {
              totalCards += cardsObject[userId].length;
          });
      }
      document.getElementById('totalCards').textContent = totalCards;
      
      // Подсчитываем общее количество рефералов
      // Подсчитываем общее количество рефералов
      let totalReferrals = 0;
      if (referralData && referralData.levels) {
           Object.values(referralData.levels).forEach(level => {
         totalReferrals += level.length;
      });
}
      document.getElementById('totalReferrals').textContent = totalReferrals;
      
      // Обновляем время последнего обновления
      updateTime();
  }

  function loadSectionData(sectionId) {
      switch(sectionId) {
          case 'contacts':
              loadContactsSection();
              break;
          case 'referrals':
              loadReferralsSection();
              break;
          case 'crm':
              loadCRMSection();
              break;
          case 'coauthors':
              loadCoauthorsSection();
              break;
          case 'wallet':
              loadWalletSection();
              break;
      }
  }

  // ==================== РЕФЕРАЛЬНАЯ СИСТЕМА ====================
  function showLevel(level) {
      currentLevel = level;
      
      // Обновляем активную кнопку
      document.querySelectorAll('.level-btn').forEach(btn => {
          btn.classList.remove('active');
      });
      
      document.querySelector(`[data-level="${level}"]`).classList.add('active');
      
      // Показываем контент уровня
      const levelContent = document.getElementById('levelContent');
      const levelTitle = document.getElementById('currentLevelTitle');
      const levelCount = document.getElementById('currentLevelCount');
      const teamTable = document.getElementById('teamTable');
      
      levelContent.classList.add('active');
      
      // Загружаем данные уровня
      const levelData = referralData.levels[level] || [];
      
      levelTitle.textContent = `Level ${level} Team Members`;
      levelCount.textContent = levelData.length;
      
      // Создаем таблицу
      if (levelData.length === 0) {
          teamTable.innerHTML = `
              <div style="text-align: center; color: #CCC; padding: 40px;">
                  No team members at this level yet
              </div>
          `;
          return;
      }
      
      let tableHTML = `
          <table style="width: 100%; border-collapse: collapse;">
              <thead>
                  <tr style="border-bottom: 2px solid #FFD700;">
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">№</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">📋 ID</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">💎 Wallet</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">👑 Sponsor</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">📅 Date</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">🏷️ Status</th>
                      <th style="padding: 12px 8px; text-align: left; color: #FFD700; font-size: 14px;">👤 Name</th>
                      <th style="padding: 12px 8px; text-align: center; color: #FFD700; font-size: 14px;">⚡ Actions</th>
                  </tr>
              </thead>
              <tbody>
      `;
      
      levelData.forEach((member, index) => {
          const statusClass = `status-${member.status || 'basic'}`;
          const statusText = getStatusDisplayName(member.status || 'basic');
          const date = new Date(member.registrationDate || Date.now()).toLocaleDateString();
          const walletStatus = member.walletAddress ? 'wallet-active' : 'wallet-inactive';
          const walletText = member.walletAddress ? 'Active' : 'Inactive';
          
          tableHTML += `
              <tr style="border-bottom: 1px solid rgba(255, 215, 0, 0.2);">
                  <td style="padding: 10px 8px; color: #FFF; font-size: 13px;">${index + 1}</td>
                  <td style="padding: 10px 8px; color: #4CAF50; font-weight: bold; cursor: pointer; font-size: 13px;" 
                      class="user-id-cell" onclick="openCRM('${member.userId}')">${member.userId}</td>
                  <td style="padding: 10px 8px; font-size: 13px;">
                      <span class="wallet-status ${walletStatus}">${walletText}</span><br>
                      <small style="color: #888; font-family: monospace;">
                          ${member.walletAddress ? 
                            `${member.walletAddress.substring(0, 6)}...${member.walletAddress.substring(member.walletAddress.length - 4)}` : 
                            'Not connected'}
                      </small>
                  </td>
                  <td style="padding: 10px 8px; color: #FFD700; font-size: 13px; cursor: pointer;" onclick="openCRM('${member.sponsorId}')">${member.sponsorId || '-'}</td>
                  <td style="padding: 10px 8px; color: #CCC; font-size: 13px;">${date}</td>
                  <td style="padding: 10px 8px; font-size: 13px;">
                      <span class="status-badge ${statusClass}">${statusText}</span>
                  </td>
                  <td style="padding: 10px 8px; color: #FFF; font-size: 13px;">
                      ${member.name || '-'}<br>
                      <small style="color: #888;">${member.platform || ''}: ${member.contact || ''}</small>
                  </td>
                  <td style="padding: 10px 8px; text-align: center; font-size: 13px;">
                      <button onclick="openCRM('${member.userId}')" 
                          style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer; margin: 2px; font-size: 11px;">💬</button>
                      <button onclick="manageMember('${member.userId}')" 
                          style="background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer; margin: 2px; font-size: 11px;">⚙️</button>
                  </td>
              </tr>
          `;
      });
      
      tableHTML += `
              </tbody>
          </table>
      `;
      
      teamTable.innerHTML = tableHTML;
  }

  function getStatusDisplayName(status) {
      const statusNames = {
          'coauthor': 'Co-Author',
          'super': 'Super Admin',
          'mini': 'Mini Admin',
          'basic': 'Basic'
      };
      return statusNames[status] || status.toUpperCase();
  }

  function loadReferralsSection() {
      // ВСЕ КНОПКИ АКТИВНЫ ДЛЯ МАСТЕР АДМИНА
      document.querySelectorAll('.level-btn').forEach(btn => {
          btn.classList.remove('locked');
          btn.style.opacity = '1';
          btn.style.cursor = 'pointer';
      });
  }

  function manageMember(userId) {
      const actions = [
          { text: 'Change Status', action: () => changeUserStatus(userId) },
          { text: 'Block User', action: () => blockUser(userId) },
          { text: 'View Details', action: () => openCRM(userId) }
      ];
      
      showActionMenu(actions);
  }

  // ==================== CRM СИСТЕМА ====================
  function openCRM(userId) {
      currentCRMUser = userId;
      
      let userData = null;
      Object.values(referralData.levels).forEach(level => {
          const found = level.find(member => member.userId === userId);
          if (found) {
              userData = found;
          }
      });
      
      // Если не найден в реферальных данных, ищем в контактах
      if (!userData) {
          Object.keys(contactsData).forEach(category => {
              const found = contactsData[category].find(contact => contact.userId === userId);
              if (found) {
                  userData = {...found, category};
              }
          });
      }
      
      if (!userData) {
          showNotification('User data not found', 'error');
          return;
      }
      
      // Заполняем модальное окно
      document.getElementById('crmModalTitle').textContent = `CRM: ${userData.name || userId} (${userId})`;
      
      // Заполняем социальную информацию
      document.getElementById('userPlatform').textContent = userData.platform || userData.category || '-';
      document.getElementById('userContact').textContent = userData.contact || '-';
      document.getElementById('userRegDate').textContent = new Date(userData.registrationDate || Date.now()).toLocaleDateString();
      
      // Загружаем заметки
      const savedNotes = localStorage.getItem(`crm_notes_${userId}`);
      document.getElementById('userNotes').value = savedNotes || '';
      
      // Загружаем чат
      loadChatMessages(userId);
      
      // Показываем модальное окно
      document.getElementById('crmModal').classList.add('show');
  }

  function closeCRMModal() {
      document.getElementById('crmModal').classList.remove('show');
      currentCRMUser = null;
  }

  function switchCRMTab(tabName) {
      // Обновляем кнопки табов
      document.querySelectorAll('.crm-tab').forEach(tab => {
          tab.classList.remove('active');
      });
      document.getElementById(`${tabName}Tab`).classList.add('active');
      
      // Показываем контент
      document.querySelectorAll('.crm-content').forEach(content => {
          content.classList.remove('active');
      });
      document.getElementById(`${tabName}Content`).classList.add('active');
  }

  function saveUserNotes() {
      if (!currentCRMUser) return;
      
      const notes = document.getElementById('userNotes').value;
      localStorage.setItem(`crm_notes_${currentCRMUser}`, notes);
      
      showNotification('Notes saved successfully!', 'success');
  }

  function loadChatMessages(userId) {
      const chatMessages = document.getElementById('chatMessages');
      const savedMessages = localStorage.getItem(`chat_${userId}`);
      
      if (savedMessages) {
          const messages = JSON.parse(savedMessages);
          let chatHTML = '';
          
          messages.forEach(msg => {
              const isOwn = msg.from === currentUser.userId;
              chatHTML += `
                  <div style="margin: 10px 0; text-align: ${isOwn ? 'right' : 'left'};">
                      <div style="display: inline-block; max-width: 70%; padding: 8px 12px; border-radius: 10px; 
                                 background: ${isOwn ? '#FFD700' : 'rgba(255, 255, 255, 0.1)'}; 
                                 color: ${isOwn ? '#000' : '#FFF'};">
                          ${msg.message}
                          <div style="font-size: 10px; opacity: 0.7; margin-top: 4px;">
                              ${new Date(msg.timestamp).toLocaleTimeString()}
                          </div>
                      </div>
                  </div>
              `;
          });
          
          chatMessages.innerHTML = chatHTML;
      } else {
          chatMessages.innerHTML = `
              <div style="text-align: center; color: #CCC; padding: 20px;">
                  No messages yet. Start a conversation!
              </div>
          `;
      }
      
      // Прокручиваем вниз
      chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function sendMessage() {
      if (!currentCRMUser) return;
      
      const chatInput = document.getElementById('chatInput');
      const message = chatInput.value.trim();
      
      if (!message) return;
      
      // Сохраняем сообщение
      const messages = JSON.parse(localStorage.getItem(`chat_${currentCRMUser}`) || '[]');
      messages.push({
          from: currentUser.userId,
          to: currentCRMUser,
          message: message,
          timestamp: Date.now(),
          read: false
      });
      
      localStorage.setItem(`chat_${currentCRMUser}`, JSON.stringify(messages));
      
      // Обновляем уведомления
      updateNotifications();
      
      // Очищаем поле ввода
      chatInput.value = '';
      
      // Перезагружаем чат
      loadChatMessages(currentCRMUser);
      
      showNotification('Message sent!', 'success');
  }

  function openSocialContact() {
      if (!currentCRMUser) return;
      
      // Ищем контакт пользователя
      let userData = null;
      Object.values(referralData.levels).forEach(level => {
          const found = level.find(member => member.userId === currentCRMUser);
          if (found) {
              userData = found;
          }
      });
      
      if (!userData) {
          Object.keys(contactsData).forEach(category => {
              const found = contactsData[category].find(contact => contact.userId === currentCRMUser);
              if (found) {
                  userData = {...found, category: category};
              }
          });
      }
      
      if (!userData || !userData.contact) {
          showNotification('Contact information not available', 'error');
          return;
      }
      
      // Формируем ссылку в зависимости от платформы
      let url = '';
      const platform = userData.platform || userData.category;
      const contact = userData.contact;
      
      switch(platform) {
          case 'telegram':
              url = contact.startsWith('@') ? `https://t.me/${contact.substring(1)}` : `https://t.me/${contact}`;
              break;
          case 'whatsapp':
              url = `https://wa.me/${contact.replace(/[^0-9]/g, '')}`;
              break;
          case 'instagram':
              url = contact.startsWith('@') ? `https://instagram.com/${contact.substring(1)}` : `https://instagram.com/${contact}`;
              break;
          case 'facebook':
              url = `https://facebook.com/${contact}`;
              break;
          case 'twitter':
              url = contact.startsWith('@') ? `https://twitter.com/${contact.substring(1)}` : `https://twitter.com/${contact}`;
              break;
          case 'tiktok':
              url = contact.startsWith('@') ? `https://tiktok.com/${contact}` : `https://tiktok.com/@${contact}`;
              break;
          case 'viber':
              url = `viber://chat?number=${contact.replace(/[^0-9]/g, '')}`;
              break;
          default:
              showNotification('Platform not supported for direct link', 'error');
              return;
      }
      
      window.open(url, '_blank');
  }

  // ==================== СИСТЕМА СОАВТОРОВ ====================
  function loadCoauthorsSection() {
      const coauthorsList = document.getElementById('coauthorsList');
      const coauthors = JSON.parse(localStorage.getItem('coauthors') || '[]');
      
      if (coauthors.length === 0) {
          coauthorsList.innerHTML = `
              <div style="text-align: center; color: #CCC; padding: 30px;">
                  No co-authors added yet. You can add up to 8+ co-authors.
              </div>
          `;
          return;
      }
      
      let coauthorsHTML = '';
      coauthors.forEach((coauthor, index) => {
          coauthorsHTML += `
              <div class="coauthor-item">
                  <div class="coauthor-info">
                      <div style="font-size: 16px;">${coauthor.name} (${coauthor.userId})</div>
                      <div style="font-size: 12px; opacity: 0.7;">${coauthor.email || coauthor.contact}</div>
                      <div style="font-size: 11px; opacity: 0.5;">Added: ${new Date(coauthor.addedDate).toLocaleDateString()}</div>
                  </div>
                  <div class="coauthor-actions">
                      <button class="action-btn" onclick="openCRM('${coauthor.userId}')">💬 Chat</button>
                      <button class="action-btn" onclick="editCoauthor(${index})">✏️ Edit</button>
                      <button class="action-btn danger" onclick="removeCoauthor(${index})">🗑️ Remove</button>
                  </div>
              </div>
          `;
      });
      
      coauthorsList.innerHTML = coauthorsHTML;
  }

  function addCoauthor() {
      const name = prompt('Enter co-author name:');
      if (!name || name.trim() === '') return;
      
      const contact = prompt('Enter contact (email/telegram/etc):');
      if (!contact || contact.trim() === '') return;
      
      // Генерируем ID для соавтора
      const coauthors = JSON.parse(localStorage.getItem('coauthors') || '[]');
      const newUserId = `CG${String(coauthors.length + 2).padStart(6, '0')}`;
      
      const newCoauthor = {
          userId: newUserId,
          name: name.trim(),
          contact: contact.trim(),
          level: 3, // Co-author level
          addedDate: Date.now(),
          addedBy: currentUser.userId,
          isActive: true
      };
      
      coauthors.push(newCoauthor);
      localStorage.setItem('coauthors', JSON.stringify(coauthors));
      
      // Добавляем в реферальную структуру на 1 уровень
      if (!referralData.levels[1]) {
          referralData.levels[1] = [];
      }
      
      referralData.levels[1].push({
          userId: newUserId,
          name: name.trim(),
          sponsorId: currentUser.userId,
          registrationDate: Date.now(),
          status: 'coauthor',
          platform: 'system',
          contact: contact.trim(),
          walletAddress: null,
          isActive: true
      });
      
      localStorage.setItem('referralData', JSON.stringify(referralData));
      
      showNotification(`Co-author ${name} added successfully!`, 'success');
      
      loadCoauthorsSection();
      updateDashboardStats();
  }

  function editCoauthor(index) {
      const coauthors = JSON.parse(localStorage.getItem('coauthors') || '[]');
      if (index >= coauthors.length) return;
      
      const coauthor = coauthors[index];
      const newName = prompt('Edit name:', coauthor.name);
      
      if (newName && newName.trim() !== '') {
          coauthor.name = newName.trim();
          coauthors[index] = coauthor;
          localStorage.setItem('coauthors', JSON.stringify(coauthors));
          
          showNotification('Co-author updated successfully!', 'success');
          loadCoauthorsSection();
      }
  }

  function removeCoauthor(index) {
      if (!confirm('Are you sure you want to remove this co-author?')) return;
      
      const coauthors = JSON.parse(localStorage.getItem('coauthors') || '[]');
      if (index >= coauthors.length) return;
      
      const removedCoauthor = coauthors[index];
      coauthors.splice(index, 1);
      localStorage.setItem('coauthors', JSON.stringify(coauthors));
      
      // Удаляем из реферальной структуры
      Object.keys(referralData.levels).forEach(level => {
          referralData.levels[level] = referralData.levels[level].filter(
              member => member.userId !== removedCoauthor.userId
          );
      });
      localStorage.setItem('referralData', JSON.stringify(referralData));
      
      showNotification('Co-author removed successfully!', 'success');
      
      loadCoauthorsSection();
      updateDashboardStats();
  }

  // ==================== КОНТАКТЫ ====================
  function loadContactsSection() {
      const contactsTable = document.getElementById('contactsTable');
      const filter = document.getElementById('contactFilter')?.value || 'all';
      const searchTerm = document.getElementById('contactSearch')?.value?.toLowerCase() || '';
      
      let filteredContacts = [];
      
      if (filter === 'all') {
          Object.keys(contactsData).forEach(category => {
              contactsData[category].forEach(contact => {
                  filteredContacts.push({...contact, category: category});
              });
          });
      } else {
          if (contactsData[filter]) {
              contactsData[filter].forEach(contact => {
                  filteredContacts.push({...contact, category: filter});
              });
          }
      }
      
      // Фильтрация по поисковому запросу
      if (searchTerm) {
          filteredContacts = filteredContacts.filter(contact => 
              (contact.name && contact.name.toLowerCase().includes(searchTerm)) ||
              (contact.contact && contact.contact.toLowerCase().includes(searchTerm)) ||
              (contact.userId && contact.userId.toLowerCase().includes(searchTerm))
          );
      }
      
      if (filteredContacts.length === 0) {
          contactsTable.innerHTML = `
              <div style="text-align: center; color: #CCC; padding: 40px;">
                  No contacts found. Start collecting contacts through your generator!
              </div>
          `;
          return;
      }
      
      // Создаем таблицу контактов
      let tableHTML = `
          <table style="width: 100%; border-collapse: collapse;">
              <thead>
                  <tr style="border-bottom: 2px solid #FFD700;">
                      <th style="padding: 12px; text-align: left; color: #FFD700;">👤 Name</th>
                      <th style="padding: 12px; text-align: left; color: #FFD700;">📱 Platform</th>
                      <th style="padding: 12px; text-align: left; color: #FFD700;">📞 Contact</th>
                      <th style="padding: 12px; text-align: left; color: #FFD700;">🆔 User ID</th>
                      <th style="padding: 12px; text-align: left; color: #FFD700;">📅 Date</th>
                      <th style="padding: 12px; text-align: center; color: #FFD700;">⚡ Actions</th>
                  </tr>
              </thead>
              <tbody>
      `;
      
      filteredContacts.forEach(contact => {
          const platformIcons = {
              telegram: '📱',
              whatsapp: '💬',
              email: '📧',
              instagram: '📷',
              viber: '💜',
              facebook: '👤',
              tiktok: '🎵',
              twitter: '🐦'
          };
          
          const date = new Date(contact.registrationDate || Date.now()).toLocaleDateString();
          
          tableHTML += `
              <tr style="border-bottom: 1px solid rgba(255, 215, 0, 0.2);">
                  <td style="padding: 12px; color: #FFF;">${contact.name || 'N/A'}</td>
                  <td style="padding: 12px; color: #FFD700;">${platformIcons[contact.category] || '📱'} ${contact.category.charAt(0).toUpperCase() + contact.category.slice(1)}</td>
                  <td style="padding: 12px; color: #CCC;">${contact.contact || 'N/A'}</td>
                  <td style="padding: 12px; color: #4CAF50; cursor: pointer;" onclick="openCRM('${contact.userId}')">${contact.userId || 'N/A'}</td>
                  <td style="padding: 12px; color: #CCC;">${date}</td>
                  <td style="padding: 12px; text-align: center;">
                      <button onclick="openCRM('${contact.userId}')" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer; margin-right: 5px;">💬</button>
                      <button onclick="exportContact('${contact.userId}')" style="background: linear-gradient(45deg, #2196F3, #1976D2); color: white; border: none; border-radius: 5px; padding: 5px 10px; cursor: pointer;">📥</button>
                  </td>
              </tr>
          `;
      });
      
      tableHTML += `
              </tbody>
          </table>
      `;
      
      contactsTable.innerHTML = tableHTML;
  }

  function loadCRMSection() {
      const userList = document.getElementById('userList');
      
      // Собираем всех пользователей из реферальных данных и контактов
      let allUsers = [];
      
      // Добавляем пользователей из реферальной структуры
     if (referralData && referralData.levels) {
    Object.values(referralData.levels).forEach(level => {
          level.forEach(member => {
              if (!allUsers.find(user => user.userId === member.userId)) {
                  allUsers.push(member);
              }
          });
      });
  }
      
      // Добавляем пользователей из контактов
      Object.keys(contactsData).forEach(category => {
          contactsData[category].forEach(contact => {
              if (!allUsers.find(user => user.userId === contact.userId)) {
                  allUsers.push({...contact, category});
              }
          });
      });
      
      if (allUsers.length === 0) {
          userList.innerHTML = `
              <div style="text-align: center; color: #CCC; padding: 30px;">
                  No users available for chat. Users will appear here after registration.
              </div>
          `;
          return;
      }
      
      let userListHTML = '';
      allUsers.forEach(user => {
          const initials = (user.name || user.userId || 'U').split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
          const hasUnreadMessages = hasUnreadMessagesFrom(user.userId);
          
          userListHTML += `
              <div style="display: flex; align-items: center; padding: 10px; border-bottom: 1px solid rgba(255, 215, 0, 0.1); cursor: pointer; transition: background 0.3s ease; position: relative;" onclick="openCRM('${user.userId}')" onmouseover="this.style.background='rgba(255, 215, 0, 0.05)'" onmouseout="this.style.background='transparent'">
                  <div style="width: 40px; height: 40px; border-radius: 50%; background: ${hasUnreadMessages ? '#FF4444' : '#FFD700'}; color: ${hasUnreadMessages ? '#FFF' : '#000'}; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px;">${initials}</div>
                  <div style="flex: 1;">
                      <h4 style="color: #FFF; margin-bottom: 2px;">${user.name || user.userId}</h4>
                      <p style="color: #CCC; font-size: 12px; margin-bottom: 2px;">ID: ${user.userId} • Last seen: ${new Date(user.registrationDate || Date.now()).toLocaleDateString()}</p>
                      <p style="font-size: 11px; opacity: 0.7; color: #FFD700;">${getStatusDisplayName(user.status || 'basic')}</p>
                  </div>
                  ${hasUnreadMessages ? '<div style="position: absolute; top: 10px; right: 10px; background: #FF4444; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: flex; align-items: center; justify-content: center;">●</div>' : ''}
              </div>
          `;
      });
      
      userList.innerHTML = userListHTML;
  }

  function hasUnreadMessagesFrom(userId) {
      const messages = JSON.parse(localStorage.getItem(`chat_${userId}`) || '[]');
      return messages.some(msg => !msg.read && msg.to === currentUser.userId);
  }

  // ==================== КОШЕЛЕК ====================
  function loadWalletSection() {
      // Обновляем адрес контракта
      document.getElementById('contractAddress').textContent = '0x742d35Cc6635C0532925a3b8D5C0532925a3b8D5C05329';
  }

  function connectWallet() {
      const connectBtn = document.getElementById('connectWalletBtn');
      const walletStatus = document.getElementById('walletStatus');
      
      try {
          connectBtn.textContent = '🔄 Connecting...';
          connectBtn.disabled = true;
          
          // Симуляция подключения кошелька
          setTimeout(() => {
              const mockAddress = '0x742d35Cc6635C0532925a3b8D5C05329';
              showWalletConnected(mockAddress);
              walletConnected = true;
              
              // Устанавливаем баланс
              document.getElementById('walletBalance').textContent = 'Balance: 0.0234 opBNB';
              
              showNotification('Wallet connected successfully!', 'success');
          }, 2000);
          
      } catch (error) {
          console.error('Wallet connection error:', error);
          showNotification('Wallet connection failed', 'error');
          
          connectBtn.textContent = '🔗 Connect SafePal Wallet';
          connectBtn.disabled = false;
      }
  }

  function showWalletConnected(address) {
      const connectBtn = document.getElementById('connectWalletBtn');
      const walletStatus = document.getElementById('walletStatus');
      
      connectBtn.style.display = 'none';
      walletStatus.style.display = 'block';
      
      document.getElementById('walletAddress').textContent = 
          `${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
      
      walletConnected = true;
  }

  // ==================== УВЕДОМЛЕНИЯ ====================
  function updateNotifications() {
      let crmCount = 0;
      let referralCount = 0;
      
      // Подсчитываем непрочитанные сообщения
      Object.values(referralData.levels).forEach(level => {
          level.forEach(member => {
              const messages = JSON.parse(localStorage.getItem(`chat_${member.userId}`) || '[]');
              crmCount += messages.filter(msg => !msg.read && msg.to === currentUser.userId).length;
          });
      });
      
      // Подсчитываем новые рефералы (за последние 24 часа)
      const yesterday = Date.now() - 86400000;
      Object.values(referralData.levels).forEach(level => {
          level.forEach(member => {
              if (member.registrationDate > yesterday) {
                  referralCount++;
              }
          });
      });
      
      const crmBadge = document.getElementById('crmNotifications');
      const referralBadge = document.getElementById('referralNotifications');
      
      if (crmCount > 0) {
          crmBadge.textContent = crmCount;
          crmBadge.classList.remove('hidden', 'read');
      } else {
          crmBadge.classList.add('hidden');
      }
      
      if (referralCount > 0) {
          referralBadge.textContent = referralCount;
          referralBadge.classList.remove('hidden', 'read');
      } else {
          referralBadge.classList.add('hidden');
      }
      
      notifications.crm = crmCount;
      notifications.referral = referralCount;
  }

  // ==================== УТИЛИТЫ ====================
  function updateTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    const updateTimeElement = document.getElementById('updateTime');
    if (updateTimeElement) {
        updateTimeElement.textContent = timeString;
    }
}

  function filterContacts(category) {
      const contactFilter = document.getElementById('contactFilter');
      if (contactFilter) {
          contactFilter.value = category;
      }
      showSection('contacts');
  }

  function exportContact(userId) {
      let userData = null;
      
      // Ищем в реферальных данных
      Object.values(referralData.levels).forEach(level => {
          const found = level.find(member => member.userId === userId);
          if (found) {
              userData = found;
          }
      });
      
      // Ищем в контактах
      if (!userData) {
          Object.keys(contactsData).forEach(category => {
              const found = contactsData[category].find(contact => contact.userId === userId);
              if (found) {
                  userData = {...found, category};
              }
          });
      }
      
      if (userData) {
          const dataStr = JSON.stringify(userData, null, 2);
          const dataBlob = new Blob([dataStr], {type: 'application/json'});
          const url = URL.createObjectURL(dataBlob);
          
          const link = document.createElement('a');
          link.href = url;
          link.download = `contact-${userId}-${new Date().toISOString().split('T')[0]}.json`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          showNotification(`Contact ${userId} exported successfully!`, 'success');
      }
  }

  function exportContacts() {
      const dataStr = JSON.stringify(contactsData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = `cardgift-contacts-${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showNotification('Contacts exported successfully!', 'success');
  }

  function exportAllData() {
      const allData = {
          contacts: contactsData,
          referrals: referralData,
          coauthors: JSON.parse(localStorage.getItem('coauthors') || '[]'),
          cards: JSON.parse(localStorage.getItem('userCards') || '{}'),
          user: currentUser,
          exportDate: new Date().toISOString()
      };
      
      const dataStr = JSON.stringify(allData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      
      const link = document.createElement('a');
      link.href = url;
      link.download = `cardgift-full-backup-${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      showNotification('Full backup exported successfully!', 'success');
  }

  function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = function(event) {
          const file = event.target.files[0];
          if (!file) return;
          
          const reader = new FileReader();
          reader.onload = function(e) {
              try {
                  const data = JSON.parse(e.target.result);
                  
                  if (data.contacts) {
                      localStorage.setItem('allContacts', JSON.stringify(data.contacts));
                      contactsData = data.contacts;
                  }
                  
                  if (data.referrals) {
                      localStorage.setItem('referralData', JSON.stringify(data.referrals));
                      referralData = data.referrals;
                  }
                  
                  if (data.coauthors) {
                      localStorage.setItem('coauthors', JSON.stringify(data.coauthors));
                  }
                  
                  loadDashboardData();
                  
                  showNotification('Data imported successfully!', 'success');
                  
              } catch (error) {
                  showNotification('Import failed: Invalid file format', 'error');
              }
          };
          reader.readAsText(file);
      };
      
      input.click();
  }

  function clearCache() {
      if (confirm('Are you sure you want to clear all cache? This action cannot be undone.')) {
          // Очищаем только кэш, но не основные данные
          localStorage.removeItem('dashboardCache');
          localStorage.removeItem('tempData');
          
          showNotification('Cache cleared successfully!', 'success');
      }
  }

  function startNewChat() {
      showNotification('New chat feature will be available soon!', 'info');
  }

  function changeUserStatus(userId) {
      const statuses = ['basic', 'mini', 'super', 'coauthor'];
      const statusNames = {
          'basic': 'Basic User',
          'mini': 'Mini Admin',
          'super': 'Super Admin',
          'coauthor': 'Co-Author'
      };
      
      let options = '';
      statuses.forEach(status => {
          options += `${status}: ${statusNames[status]}\n`;
      });
      
      const newStatus = prompt(`Select new status for user ${userId}:\n\n${options}\n\nEnter status:`);
      
      if (newStatus && statuses.includes(newStatus.toLowerCase())) {
          // Обновляем статус в реферальных данных
          Object.keys(referralData.levels).forEach(level => {
              const memberIndex = referralData.levels[level].findIndex(member => member.userId === userId);
              if (memberIndex !== -1) {
                  referralData.levels[level][memberIndex].status = newStatus.toLowerCase();
              }
          });
          
          localStorage.setItem('referralData', JSON.stringify(referralData));
          
          showNotification(`User ${userId} status updated to ${statusNames[newStatus.toLowerCase()]}`, 'success');
          
          // Перезагружаем текущий уровень если открыт
          if (currentLevel > 0) {
              showLevel(currentLevel);
          }
      }
  }

  function blockUser(userId) {
      if (confirm(`Are you sure you want to block user ${userId}?`)) {
          // Помечаем пользователя как заблокированного
          Object.keys(referralData.levels).forEach(level => {
              const memberIndex = referralData.levels[level].findIndex(member => member.userId === userId);
              if (memberIndex !== -1) {
                  referralData.levels[level][memberIndex].isActive = false;
                  referralData.levels[level][memberIndex].blockedBy = currentUser.userId;
                  referralData.levels[level][memberIndex].blockedDate = Date.now();
              }
          });
          
          localStorage.setItem('referralData', JSON.stringify(referralData));
          
          showNotification(`User ${userId} has been blocked`, 'success');
      }
  }

  function showActionMenu(actions) {
      let menuHTML = '<div style="background: rgba(0,0,0,0.9); border: 1px solid #FFD700; border-radius: 10px; padding: 15px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 3000;">';
      
      actions.forEach((action, index) => {
          menuHTML += `<button onclick="closeActionMenu(); (${action.action.toString()})()" style="display: block; width: 100%; margin: 5px 0; padding: 10px; background: linear-gradient(45deg, #FFD700, #FFA500); color: #000; border: none; border-radius: 5px; cursor: pointer;">${action.text}</button>`;
      });
      
      menuHTML += '<button onclick="closeActionMenu()" style="display: block; width: 100%; margin: 10px 0 0 0; padding: 10px; background: #666; color: #FFF; border: none; border-radius: 5px; cursor: pointer;">Cancel</button></div>';
      menuHTML += '<div onclick="closeActionMenu()" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2999;"></div>';
      
      const menuContainer = document.createElement('div');
      menuContainer.id = 'actionMenu';
      menuContainer.innerHTML = menuHTML;
      document.body.appendChild(menuContainer);
  }

  function closeActionMenu() {
      const menu = document.getElementById('actionMenu');
      if (menu) {
          menu.remove();
      }
  }

  // ==================== СИСТЕМА УВЕДОМЛЕНИЙ ====================
  function showNotification(message, type = 'info', duration = 3000) {
      // Удаляем предыдущие уведомления
      const existingNotification = document.querySelector('.notification');
      if (existingNotification) {
          existingNotification.remove();
      }
      
      // Создаем новое уведомление
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      
      notification.style.cssText = `
          position: fixed;
          bottom: 20px;
          right: 20px;
          background: rgba(0, 0, 0, 0.95);
          color: white;
          padding: 15px 25px;
          border-radius: 10px;
          z-index: 10000;
          opacity: 0;
          transform: translateY(100%);
          transition: all 0.3s ease;
          border: 1px solid #333;
          max-width: 400px;
          word-wrap: break-word;
          font-weight: 500;
          backdrop-filter: blur(10px);
      `;
      
      if (type === 'success') {
          notification.style.borderColor = '#4CAF50';
          notification.style.background = 'rgba(76, 175, 80, 0.2)';
          notification.style.color = '#4CAF50';
      } else if (type === 'error') {
          notification.style.borderColor = '#f44336';
          notification.style.background = 'rgba(244, 67, 54, 0.2)';
          notification.style.color = '#f44336';
      } else if (type === 'info') {
          notification.style.borderColor = '#2196F3';
          notification.style.background = 'rgba(33, 150, 243, 0.2)';
          notification.style.color = '#2196F3';
      }
      
      // Добавляем в DOM
      document.body.appendChild(notification);
      
      // Показываем с анимацией
      setTimeout(() => {
          notification.style.opacity = '1';
          notification.style.transform = 'translateY(0)';
      }, 100);
      
      // Автоматически скрываем
      setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateY(100%)';
          setTimeout(() => {
              if (notification.parentNode) {
                  notification.parentNode.removeChild(notification);
              }
          }, 300);
      }, duration);
  }

  // ==================== ОБРАБОТЧИКИ СОБЫТИЙ ====================
  document.addEventListener('DOMContentLoaded', function() {
      // Добавляем обработчики для фильтров контактов
      const contactFilter = document.getElementById('contactFilter');
      const contactSearch = document.getElementById('contactSearch');
      
      if (contactFilter) {
          contactFilter.addEventListener('change', () => {
              if (currentSection === 'contacts') {
                  loadContactsSection();
              }
          });
      }
      
      if (contactSearch) {
          contactSearch.addEventListener('input', () => {
              if (currentSection === 'contacts') {
                  loadContactsSection();
              }
          });
      }
      
      // Добавляем обработчик для поиска пользователей в CRM
      const userSearch = document.getElementById('userSearch');
      if (userSearch) {
          userSearch.addEventListener('input', function() {
              const searchTerm = this.value.toLowerCase();
              const userItems = document.querySelectorAll('#userList > div');
              
              userItems.forEach(item => {
                  const text = item.textContent.toLowerCase();
                  if (text.includes(searchTerm)) {
                      item.style.display = 'flex';
                  } else {
                      item.style.display = 'none';
                  }
              });
          });
      }

      // Обработчик для Enter в чате
      const chatInput = document.getElementById('chatInput');
      if (chatInput) {
          chatInput.addEventListener('keypress', function(e) {
              if (e.key === 'Enter') {
                  sendMessage();
              }
          });
      }
  });

  // ==================== ПЕРИОДИЧЕСКИЕ ОБНОВЛЕНИЯ ====================
  setInterval(() => {
      updateTime();
      updateNotifications();
      
      // Периодически обновляем данные дашборда
      if (currentSection === 'dashboard') {
          updateDashboardStats();
      }
  }, 30000); // Каждые 30 секунд

  // ==================== АДАПТИВНОСТЬ ====================
  window.addEventListener('resize', () => {
      if (window.innerWidth > 768) {
          const sidebar = document.getElementById('sidebar');
          const mainContent = document.getElementById('mainContent');
          
          sidebar.classList.remove('mobile-visible', 'mobile-hidden');
          mainContent.classList.remove('full-width');
      }
  });

  // ==================== ЗАКРЫТИЕ МОДАЛЬНЫХ ОКОН ====================
  window.addEventListener('click', function(event) {
      const crmModal = document.getElementById('crmModal');
      if (event.target === crmModal) {
          closeCRMModal();
      }
  });

  // Обработчик для клавиши Escape
  document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
          closeCRMModal();
          closeActionMenu();
      }
  });

  console.log('🎉 CardGift Admin Dashboard fully loaded and ready!');
  console.log('🔓 MASTER ADMIN MODE - ALL FUNCTIONS UNLOCKED');
  </script>
</body>
</html>